var Og=g=>{throw TypeError(g)};var Hu=(g,t,i)=>t.has(g)||Og("Cannot "+i);var de=(g,t,i)=>(Hu(g,t,"read from private field"),i?i.call(g):t.get(g)),Gi=(g,t,i)=>t.has(g)?Og("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(g):t.set(g,i),ai=(g,t,i,s)=>(Hu(g,t,"write to private field"),s?s.call(g,i):t.set(g,i),i),qi=(g,t,i)=>(Hu(g,t,"access private method"),i);var kg=(g,t,i,s)=>({set _(a){ai(g,t,a,i)},get _(){return de(g,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();var Jo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kb(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var ju={exports:{}},dr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ng;function Nb(){if(Ng)return dr;Ng=1;var g=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:g,type:s,key:l,ref:a!==void 0?a:null,props:o}}return dr.Fragment=t,dr.jsx=i,dr.jsxs=i,dr}var Lg;function Lb(){return Lg||(Lg=1,ju.exports=Nb()),ju.exports}var vt=Lb(),Gu={exports:{}},Bt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bg;function Bb(){if(Bg)return Bt;Bg=1;var g=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),v=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=v&&D[v]||D["@@iterator"],typeof D=="function"?D:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function S(D,B,J){this.props=D,this.context=B,this.refs=w,this.updater=J||A}S.prototype.isReactComponent={},S.prototype.setState=function(D,B){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,B,"setState")},S.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function T(){}T.prototype=S.prototype;function M(D,B,J){this.props=D,this.context=B,this.refs=w,this.updater=J||A}var k=M.prototype=new T;k.constructor=M,_(k,S.prototype),k.isPureReactComponent=!0;var O=Array.isArray;function z(){}var L={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function j(D,B,J){var it=J.ref;return{$$typeof:g,type:D,key:B,ref:it!==void 0?it:null,props:J}}function Z(D,B){return j(D.type,B,D.props)}function ot(D){return typeof D=="object"&&D!==null&&D.$$typeof===g}function I(D){var B={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(J){return B[J]})}var X=/\/+/g;function x(D,B){return typeof D=="object"&&D!==null&&D.key!=null?I(""+D.key):B.toString(36)}function tt(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(z,z):(D.status="pending",D.then(function(B){D.status==="pending"&&(D.status="fulfilled",D.value=B)},function(B){D.status==="pending"&&(D.status="rejected",D.reason=B)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function U(D,B,J,it,at){var At=typeof D;(At==="undefined"||At==="boolean")&&(D=null);var St=!1;if(D===null)St=!0;else switch(At){case"bigint":case"string":case"number":St=!0;break;case"object":switch(D.$$typeof){case g:case t:St=!0;break;case p:return St=D._init,U(St(D._payload),B,J,it,at)}}if(St)return at=at(D),St=it===""?"."+x(D,0):it,O(at)?(J="",St!=null&&(J=St.replace(X,"$&/")+"/"),U(at,B,J,"",function(pt){return pt})):at!=null&&(ot(at)&&(at=Z(at,J+(at.key==null||D&&D.key===at.key?"":(""+at.key).replace(X,"$&/")+"/")+St)),B.push(at)),1;St=0;var Mt=it===""?".":it+":";if(O(D))for(var xt=0;xt<D.length;xt++)it=D[xt],At=Mt+x(it,xt),St+=U(it,B,J,At,at);else if(xt=b(D),typeof xt=="function")for(D=xt.call(D),xt=0;!(it=D.next()).done;)it=it.value,At=Mt+x(it,xt++),St+=U(it,B,J,At,at);else if(At==="object"){if(typeof D.then=="function")return U(tt(D),B,J,it,at);throw B=String(D),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.")}return St}function H(D,B,J){if(D==null)return D;var it=[],at=0;return U(D,it,"","",function(At){return B.call(J,At,at++)}),it}function ct(D){if(D._status===-1){var B=D._result;B=B(),B.then(function(J){(D._status===0||D._status===-1)&&(D._status=1,D._result=J)},function(J){(D._status===0||D._status===-1)&&(D._status=2,D._result=J)}),D._status===-1&&(D._status=0,D._result=B)}if(D._status===1)return D._result.default;throw D._result}var st=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var B=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(B))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},mt={map:H,forEach:function(D,B,J){H(D,function(){B.apply(this,arguments)},J)},count:function(D){var B=0;return H(D,function(){B++}),B},toArray:function(D){return H(D,function(B){return B})||[]},only:function(D){if(!ot(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return Bt.Activity=m,Bt.Children=mt,Bt.Component=S,Bt.Fragment=i,Bt.Profiler=a,Bt.PureComponent=M,Bt.StrictMode=s,Bt.Suspense=h,Bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Bt.__COMPILER_RUNTIME={__proto__:null,c:function(D){return L.H.useMemoCache(D)}},Bt.cache=function(D){return function(){return D.apply(null,arguments)}},Bt.cacheSignal=function(){return null},Bt.cloneElement=function(D,B,J){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var it=_({},D.props),at=D.key;if(B!=null)for(At in B.key!==void 0&&(at=""+B.key),B)!G.call(B,At)||At==="key"||At==="__self"||At==="__source"||At==="ref"&&B.ref===void 0||(it[At]=B[At]);var At=arguments.length-2;if(At===1)it.children=J;else if(1<At){for(var St=Array(At),Mt=0;Mt<At;Mt++)St[Mt]=arguments[Mt+2];it.children=St}return j(D.type,at,it)},Bt.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:o,_context:D},D},Bt.createElement=function(D,B,J){var it,at={},At=null;if(B!=null)for(it in B.key!==void 0&&(At=""+B.key),B)G.call(B,it)&&it!=="key"&&it!=="__self"&&it!=="__source"&&(at[it]=B[it]);var St=arguments.length-2;if(St===1)at.children=J;else if(1<St){for(var Mt=Array(St),xt=0;xt<St;xt++)Mt[xt]=arguments[xt+2];at.children=Mt}if(D&&D.defaultProps)for(it in St=D.defaultProps,St)at[it]===void 0&&(at[it]=St[it]);return j(D,At,at)},Bt.createRef=function(){return{current:null}},Bt.forwardRef=function(D){return{$$typeof:u,render:D}},Bt.isValidElement=ot,Bt.lazy=function(D){return{$$typeof:p,_payload:{_status:-1,_result:D},_init:ct}},Bt.memo=function(D,B){return{$$typeof:d,type:D,compare:B===void 0?null:B}},Bt.startTransition=function(D){var B=L.T,J={};L.T=J;try{var it=D(),at=L.S;at!==null&&at(J,it),typeof it=="object"&&it!==null&&typeof it.then=="function"&&it.then(z,st)}catch(At){st(At)}finally{B!==null&&J.types!==null&&(B.types=J.types),L.T=B}},Bt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Bt.use=function(D){return L.H.use(D)},Bt.useActionState=function(D,B,J){return L.H.useActionState(D,B,J)},Bt.useCallback=function(D,B){return L.H.useCallback(D,B)},Bt.useContext=function(D){return L.H.useContext(D)},Bt.useDebugValue=function(){},Bt.useDeferredValue=function(D,B){return L.H.useDeferredValue(D,B)},Bt.useEffect=function(D,B){return L.H.useEffect(D,B)},Bt.useEffectEvent=function(D){return L.H.useEffectEvent(D)},Bt.useId=function(){return L.H.useId()},Bt.useImperativeHandle=function(D,B,J){return L.H.useImperativeHandle(D,B,J)},Bt.useInsertionEffect=function(D,B){return L.H.useInsertionEffect(D,B)},Bt.useLayoutEffect=function(D,B){return L.H.useLayoutEffect(D,B)},Bt.useMemo=function(D,B){return L.H.useMemo(D,B)},Bt.useOptimistic=function(D,B){return L.H.useOptimistic(D,B)},Bt.useReducer=function(D,B,J){return L.H.useReducer(D,B,J)},Bt.useRef=function(D){return L.H.useRef(D)},Bt.useState=function(D){return L.H.useState(D)},Bt.useSyncExternalStore=function(D,B,J){return L.H.useSyncExternalStore(D,B,J)},Bt.useTransition=function(){return L.H.useTransition()},Bt.version="19.2.0",Bt}var zg;function mh(){return zg||(zg=1,Gu.exports=Bb()),Gu.exports}var De=mh(),qu={exports:{}},fr={},Vu={exports:{}},Yu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ig;function zb(){return Ig||(Ig=1,(function(g){function t(U,H){var ct=U.length;U.push(H);t:for(;0<ct;){var st=ct-1>>>1,mt=U[st];if(0<a(mt,H))U[st]=H,U[ct]=mt,ct=st;else break t}}function i(U){return U.length===0?null:U[0]}function s(U){if(U.length===0)return null;var H=U[0],ct=U.pop();if(ct!==H){U[0]=ct;t:for(var st=0,mt=U.length,D=mt>>>1;st<D;){var B=2*(st+1)-1,J=U[B],it=B+1,at=U[it];if(0>a(J,ct))it<mt&&0>a(at,J)?(U[st]=at,U[it]=ct,st=it):(U[st]=J,U[B]=ct,st=B);else if(it<mt&&0>a(at,ct))U[st]=at,U[it]=ct,st=it;else break t}}return H}function a(U,H){var ct=U.sortIndex-H.sortIndex;return ct!==0?ct:U.id-H.id}if(g.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;g.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();g.unstable_now=function(){return l.now()-u}}var h=[],d=[],p=1,m=null,v=3,b=!1,A=!1,_=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function k(U){for(var H=i(d);H!==null;){if(H.callback===null)s(d);else if(H.startTime<=U)s(d),H.sortIndex=H.expirationTime,t(h,H);else break;H=i(d)}}function O(U){if(_=!1,k(U),!A)if(i(h)!==null)A=!0,z||(z=!0,I());else{var H=i(d);H!==null&&tt(O,H.startTime-U)}}var z=!1,L=-1,G=5,j=-1;function Z(){return w?!0:!(g.unstable_now()-j<G)}function ot(){if(w=!1,z){var U=g.unstable_now();j=U;var H=!0;try{t:{A=!1,_&&(_=!1,T(L),L=-1),b=!0;var ct=v;try{e:{for(k(U),m=i(h);m!==null&&!(m.expirationTime>U&&Z());){var st=m.callback;if(typeof st=="function"){m.callback=null,v=m.priorityLevel;var mt=st(m.expirationTime<=U);if(U=g.unstable_now(),typeof mt=="function"){m.callback=mt,k(U),H=!0;break e}m===i(h)&&s(h),k(U)}else s(h);m=i(h)}if(m!==null)H=!0;else{var D=i(d);D!==null&&tt(O,D.startTime-U),H=!1}}break t}finally{m=null,v=ct,b=!1}H=void 0}}finally{H?I():z=!1}}}var I;if(typeof M=="function")I=function(){M(ot)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,x=X.port2;X.port1.onmessage=ot,I=function(){x.postMessage(null)}}else I=function(){S(ot,0)};function tt(U,H){L=S(function(){U(g.unstable_now())},H)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(U){U.callback=null},g.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<U?Math.floor(1e3/U):5},g.unstable_getCurrentPriorityLevel=function(){return v},g.unstable_next=function(U){switch(v){case 1:case 2:case 3:var H=3;break;default:H=v}var ct=v;v=H;try{return U()}finally{v=ct}},g.unstable_requestPaint=function(){w=!0},g.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var ct=v;v=U;try{return H()}finally{v=ct}},g.unstable_scheduleCallback=function(U,H,ct){var st=g.unstable_now();switch(typeof ct=="object"&&ct!==null?(ct=ct.delay,ct=typeof ct=="number"&&0<ct?st+ct:st):ct=st,U){case 1:var mt=-1;break;case 2:mt=250;break;case 5:mt=1073741823;break;case 4:mt=1e4;break;default:mt=5e3}return mt=ct+mt,U={id:p++,callback:H,priorityLevel:U,startTime:ct,expirationTime:mt,sortIndex:-1},ct>st?(U.sortIndex=ct,t(d,U),i(h)===null&&U===i(d)&&(_?(T(L),L=-1):_=!0,tt(O,ct-st))):(U.sortIndex=mt,t(h,U),A||b||(A=!0,z||(z=!0,I()))),U},g.unstable_shouldYield=Z,g.unstable_wrapCallback=function(U){var H=v;return function(){var ct=v;v=H;try{return U.apply(this,arguments)}finally{v=ct}}}})(Yu)),Yu}var Fg;function Ib(){return Fg||(Fg=1,Vu.exports=zb()),Vu.exports}var Xu={exports:{}},qe={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pg;function Fb(){if(Pg)return qe;Pg=1;var g=mh();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:m==null?null:""+m,children:h,containerInfo:d,implementation:p}}var l=g.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return qe.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,qe.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return o(h,d,null,p)},qe.flushSync=function(h){var d=l.T,p=s.p;try{if(l.T=null,s.p=2,h)return h()}finally{l.T=d,s.p=p,s.d.f()}},qe.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,s.d.C(h,d))},qe.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},qe.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,m=u(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?s.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:b}):p==="script"&&s.d.X(h,{crossOrigin:m,integrity:v,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},qe.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);s.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&s.d.M(h)},qe.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,m=u(p,d.crossOrigin);s.d.L(h,p,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},qe.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);s.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else s.d.m(h)},qe.requestFormReset=function(h){s.d.r(h)},qe.unstable_batchedUpdates=function(h,d){return h(d)},qe.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},qe.useFormStatus=function(){return l.H.useHostTransitionStatus()},qe.version="19.2.0",qe}var Ug;function Pb(){if(Ug)return Xu.exports;Ug=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),Xu.exports=Fb(),Xu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hg;function Ub(){if(Hg)return fr;Hg=1;var g=Ib(),t=mh(),i=Pb();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var n=e,r=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(r=n.return),e=n.return;while(e)}return n.tag===3?r:null}function l(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(o(e)!==e)throw Error(s(188))}function d(e){var n=e.alternate;if(!n){if(n=o(e),n===null)throw Error(s(188));return n!==e?null:e}for(var r=e,c=n;;){var f=r.return;if(f===null)break;var y=f.alternate;if(y===null){if(c=f.return,c!==null){r=c;continue}break}if(f.child===y.child){for(y=f.child;y;){if(y===r)return h(f),e;if(y===c)return h(f),n;y=y.sibling}throw Error(s(188))}if(r.return!==c.return)r=f,c=y;else{for(var E=!1,R=f.child;R;){if(R===r){E=!0,r=f,c=y;break}if(R===c){E=!0,c=f,r=y;break}R=R.sibling}if(!E){for(R=y.child;R;){if(R===r){E=!0,r=y,c=f;break}if(R===c){E=!0,c=y,r=f;break}R=R.sibling}if(!E)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?e:n}function p(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=p(e),n!==null)return n;e=e.sibling}return null}var m=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),M=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),ot=Symbol.iterator;function I(e){return e===null||typeof e!="object"?null:(e=ot&&e[ot]||e["@@iterator"],typeof e=="function"?e:null)}var X=Symbol.for("react.client.reference");function x(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===X?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _:return"Fragment";case S:return"Profiler";case w:return"StrictMode";case O:return"Suspense";case z:return"SuspenseList";case j:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case A:return"Portal";case M:return e.displayName||"Context";case T:return(e._context.displayName||"Context")+".Consumer";case k:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case L:return n=e.displayName||null,n!==null?n:x(e.type)||"Memo";case G:n=e._payload,e=e._init;try{return x(e(n))}catch{}}return null}var tt=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ct={pending:!1,data:null,method:null,action:null},st=[],mt=-1;function D(e){return{current:e}}function B(e){0>mt||(e.current=st[mt],st[mt]=null,mt--)}function J(e,n){mt++,st[mt]=e.current,e.current=n}var it=D(null),at=D(null),At=D(null),St=D(null);function Mt(e,n){switch(J(At,n),J(at,e),J(it,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?tg(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=tg(n),e=eg(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(it),J(it,e)}function xt(){B(it),B(at),B(At)}function pt(e){e.memoizedState!==null&&J(St,e);var n=it.current,r=eg(n,e.type);n!==r&&(J(at,e),J(it,r))}function _t(e){at.current===e&&(B(it),B(at)),St.current===e&&(B(St),lr._currentValue=ct)}var Ut,Lt;function C(e){if(Ut===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);Ut=n&&n[1]||"",Lt=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ut+e+Lt}var rt=!1;function et(e,n){if(!e||rt)return"";rt=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var ht=function(){throw Error()};if(Object.defineProperty(ht.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ht,[])}catch(nt){var Q=nt}Reflect.construct(e,[],ht)}else{try{ht.call()}catch(nt){Q=nt}e.call(ht.prototype)}}else{try{throw Error()}catch(nt){Q=nt}(ht=e())&&typeof ht.catch=="function"&&ht.catch(function(){})}}catch(nt){if(nt&&Q&&typeof nt.stack=="string")return[nt.stack,Q.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),E=y[0],R=y[1];if(E&&R){var P=E.split(`
`),K=R.split(`
`);for(f=c=0;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;for(;f<K.length&&!K[f].includes("DetermineComponentFrameRoot");)f++;if(c===P.length||f===K.length)for(c=P.length-1,f=K.length-1;1<=c&&0<=f&&P[c]!==K[f];)f--;for(;1<=c&&0<=f;c--,f--)if(P[c]!==K[f]){if(c!==1||f!==1)do if(c--,f--,0>f||P[c]!==K[f]){var lt=`
`+P[c].replace(" at new "," at ");return e.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",e.displayName)),lt}while(1<=c&&0<=f);break}}}finally{rt=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?C(r):""}function F(e,n){switch(e.tag){case 26:case 27:case 5:return C(e.type);case 16:return C("Lazy");case 13:return e.child!==n&&n!==null?C("Suspense Fallback"):C("Suspense");case 19:return C("SuspenseList");case 0:case 15:return et(e.type,!1);case 11:return et(e.type.render,!1);case 1:return et(e.type,!0);case 31:return C("Activity");default:return""}}function N(e){try{var n="",r=null;do n+=F(e,r),r=e,e=e.return;while(e);return n}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var V=Object.prototype.hasOwnProperty,dt=g.unstable_scheduleCallback,ft=g.unstable_cancelCallback,W=g.unstable_shouldYield,gt=g.unstable_requestPaint,bt=g.unstable_now,yt=g.unstable_getCurrentPriorityLevel,Rt=g.unstable_ImmediatePriority,Jt=g.unstable_UserBlockingPriority,jt=g.unstable_NormalPriority,We=g.unstable_LowPriority,bn=g.unstable_IdlePriority,yi=g.log,Kn=g.unstable_setDisableYieldValue,re=null,Oe=null;function bi(e){if(typeof yi=="function"&&Kn(e),Oe&&typeof Oe.setStrictMode=="function")try{Oe.setStrictMode(re,e)}catch{}}var pe=Math.clz32?Math.clz32:Ml,Fr=Math.log,xl=Math.LN2;function Ml(e){return e>>>=0,e===0?32:31-(Fr(e)/xl|0)|0}var ws=256,Zn=262144,Fi=4194304;function vi(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Pr(e,n,r){var c=e.pendingLanes;if(c===0)return 0;var f=0,y=e.suspendedLanes,E=e.pingedLanes;e=e.warmLanes;var R=c&134217727;return R!==0?(c=R&~y,c!==0?f=vi(c):(E&=R,E!==0?f=vi(E):r||(r=R&~e,r!==0&&(f=vi(r))))):(R=c&~y,R!==0?f=vi(R):E!==0?f=vi(E):r||(r=c&~e,r!==0&&(f=vi(r)))),f===0?0:n!==0&&n!==f&&(n&y)===0&&(y=f&-f,r=n&-n,y>=r||y===32&&(r&4194048)!==0)?n:f}function Aa(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function v0(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lh(){var e=Fi;return Fi<<=1,(Fi&62914560)===0&&(Fi=4194304),e}function Rl(e){for(var n=[],r=0;31>r;r++)n.push(e);return n}function Sa(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function _0(e,n,r,c,f,y){var E=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var R=e.entanglements,P=e.expirationTimes,K=e.hiddenUpdates;for(r=E&~r;0<r;){var lt=31-pe(r),ht=1<<lt;R[lt]=0,P[lt]=-1;var Q=K[lt];if(Q!==null)for(K[lt]=null,lt=0;lt<Q.length;lt++){var nt=Q[lt];nt!==null&&(nt.lane&=-536870913)}r&=~ht}c!==0&&Bh(e,c,0),y!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=y&~(E&~n))}function Bh(e,n,r){e.pendingLanes|=n,e.suspendedLanes&=~n;var c=31-pe(n);e.entangledLanes|=n,e.entanglements[c]=e.entanglements[c]|1073741824|r&261930}function zh(e,n){var r=e.entangledLanes|=n;for(e=e.entanglements;r;){var c=31-pe(r),f=1<<c;f&n|e[c]&n&&(e[c]|=n),r&=~f}}function Ih(e,n){var r=n&-n;return r=(r&42)!==0?1:Dl(r),(r&(e.suspendedLanes|n))!==0?0:r}function Dl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ol(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Fh(){var e=H.p;return e!==0?e:(e=window.event,e===void 0?32:Eg(e.type))}function Ph(e,n){var r=H.p;try{return H.p=e,n()}finally{H.p=r}}var vn=Math.random().toString(36).slice(2),Be="__reactFiber$"+vn,Qe="__reactProps$"+vn,Es="__reactContainer$"+vn,kl="__reactEvents$"+vn,A0="__reactListeners$"+vn,S0="__reactHandles$"+vn,Uh="__reactResources$"+vn,wa="__reactMarker$"+vn;function Nl(e){delete e[Be],delete e[Qe],delete e[kl],delete e[A0],delete e[S0]}function Cs(e){var n=e[Be];if(n)return n;for(var r=e.parentNode;r;){if(n=r[Es]||r[Be]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(e=lg(e);e!==null;){if(r=e[Be])return r;e=lg(e)}return n}e=r,r=e.parentNode}return null}function Ts(e){if(e=e[Be]||e[Es]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Ea(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function xs(e){var n=e[Uh];return n||(n=e[Uh]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ke(e){e[wa]=!0}var Hh=new Set,jh={};function Wn(e,n){Ms(e,n),Ms(e+"Capture",n)}function Ms(e,n){for(jh[e]=n,e=0;e<n.length;e++)Hh.add(n[e])}var w0=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gh={},qh={};function E0(e){return V.call(qh,e)?!0:V.call(Gh,e)?!1:w0.test(e)?qh[e]=!0:(Gh[e]=!0,!1)}function Ur(e,n,r){if(E0(n))if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+r)}}function Hr(e,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+r)}}function Zi(e,n,r,c){if(c===null)e.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(n,r,""+c)}}function _i(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Vh(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function C0(e,n,r){var c=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,y=c.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return f.call(this)},set:function(E){r=""+E,y.call(this,E)}}),Object.defineProperty(e,n,{enumerable:c.enumerable}),{getValue:function(){return r},setValue:function(E){r=""+E},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Ll(e){if(!e._valueTracker){var n=Vh(e)?"checked":"value";e._valueTracker=C0(e,n,""+e[n])}}function Yh(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var r=n.getValue(),c="";return e&&(c=Vh(e)?e.checked?"true":"false":e.value),e=c,e!==r?(n.setValue(e),!0):!1}function jr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var T0=/[\n"\\]/g;function Ai(e){return e.replace(T0,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Bl(e,n,r,c,f,y,E,R){e.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.type=E:e.removeAttribute("type"),n!=null?E==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+_i(n)):e.value!==""+_i(n)&&(e.value=""+_i(n)):E!=="submit"&&E!=="reset"||e.removeAttribute("value"),n!=null?zl(e,E,_i(n)):r!=null?zl(e,E,_i(r)):c!=null&&e.removeAttribute("value"),f==null&&y!=null&&(e.defaultChecked=!!y),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?e.name=""+_i(R):e.removeAttribute("name")}function Xh(e,n,r,c,f,y,E,R){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.type=y),n!=null||r!=null){if(!(y!=="submit"&&y!=="reset"||n!=null)){Ll(e);return}r=r!=null?""+_i(r):"",n=n!=null?""+_i(n):r,R||n===e.value||(e.value=n),e.defaultValue=n}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=R?e.checked:!!c,e.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(e.name=E),Ll(e)}function zl(e,n,r){n==="number"&&jr(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function Rs(e,n,r,c){if(e=e.options,n){n={};for(var f=0;f<r.length;f++)n["$"+r[f]]=!0;for(r=0;r<e.length;r++)f=n.hasOwnProperty("$"+e[r].value),e[r].selected!==f&&(e[r].selected=f),f&&c&&(e[r].defaultSelected=!0)}else{for(r=""+_i(r),n=null,f=0;f<e.length;f++){if(e[f].value===r){e[f].selected=!0,c&&(e[f].defaultSelected=!0);return}n!==null||e[f].disabled||(n=e[f])}n!==null&&(n.selected=!0)}}function $h(e,n,r){if(n!=null&&(n=""+_i(n),n!==e.value&&(e.value=n),r==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=r!=null?""+_i(r):""}function Kh(e,n,r,c){if(n==null){if(c!=null){if(r!=null)throw Error(s(92));if(tt(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),n=r}r=_i(n),e.defaultValue=r,c=e.textContent,c===r&&c!==""&&c!==null&&(e.value=c),Ll(e)}function Ds(e,n){if(n){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=n;return}}e.textContent=n}var x0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zh(e,n,r){var c=n.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":c?e.setProperty(n,r):typeof r!="number"||r===0||x0.has(n)?n==="float"?e.cssFloat=r:e[n]=(""+r).trim():e[n]=r+"px"}function Wh(e,n,r){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var f in n)c=n[f],n.hasOwnProperty(f)&&r[f]!==c&&Zh(e,f,c)}else for(var y in n)n.hasOwnProperty(y)&&Zh(e,y,n[y])}function Il(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var M0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),R0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gr(e){return R0.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Wi(){}var Fl=null;function Pl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Os=null,ks=null;function Qh(e){var n=Ts(e);if(n&&(e=n.stateNode)){var r=e[Qe]||null;t:switch(e=n.stateNode,n.type){case"input":if(Bl(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),n=r.name,r.type==="radio"&&n!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Ai(""+n)+'"][type="radio"]'),n=0;n<r.length;n++){var c=r[n];if(c!==e&&c.form===e.form){var f=c[Qe]||null;if(!f)throw Error(s(90));Bl(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<r.length;n++)c=r[n],c.form===e.form&&Yh(c)}break t;case"textarea":$h(e,r.value,r.defaultValue);break t;case"select":n=r.value,n!=null&&Rs(e,!!r.multiple,n,!1)}}}var Ul=!1;function Jh(e,n,r){if(Ul)return e(n,r);Ul=!0;try{var c=e(n);return c}finally{if(Ul=!1,(Os!==null||ks!==null)&&(Oo(),Os&&(n=Os,e=ks,ks=Os=null,Qh(n),e)))for(n=0;n<e.length;n++)Qh(e[n])}}function Ca(e,n){var r=e.stateNode;if(r===null)return null;var c=r[Qe]||null;if(c===null)return null;r=c[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break t;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(s(231,n,typeof r));return r}var Qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hl=!1;if(Qi)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){Hl=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{Hl=!1}var _n=null,jl=null,qr=null;function td(){if(qr)return qr;var e,n=jl,r=n.length,c,f="value"in _n?_n.value:_n.textContent,y=f.length;for(e=0;e<r&&n[e]===f[e];e++);var E=r-e;for(c=1;c<=E&&n[r-c]===f[y-c];c++);return qr=f.slice(e,1<c?1-c:void 0)}function Vr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Yr(){return!0}function ed(){return!1}function Je(e){function n(r,c,f,y,E){this._reactName=r,this._targetInst=f,this.type=c,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var R in e)e.hasOwnProperty(R)&&(r=e[R],this[R]=r?r(y):y[R]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Yr:ed,this.isPropagationStopped=ed,this}return m(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yr)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yr)},persist:function(){},isPersistent:Yr}),n}var Qn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xr=Je(Qn),xa=m({},Qn,{view:0,detail:0}),D0=Je(xa),Gl,ql,Ma,$r=m({},xa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ma&&(Ma&&e.type==="mousemove"?(Gl=e.screenX-Ma.screenX,ql=e.screenY-Ma.screenY):ql=Gl=0,Ma=e),Gl)},movementY:function(e){return"movementY"in e?e.movementY:ql}}),id=Je($r),O0=m({},$r,{dataTransfer:0}),k0=Je(O0),N0=m({},xa,{relatedTarget:0}),Vl=Je(N0),L0=m({},Qn,{animationName:0,elapsedTime:0,pseudoElement:0}),B0=Je(L0),z0=m({},Qn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),I0=Je(z0),F0=m({},Qn,{data:0}),nd=Je(F0),P0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},U0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=H0[e])?!!n[e]:!1}function Yl(){return j0}var G0=m({},xa,{key:function(e){if(e.key){var n=P0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Vr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?U0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yl,charCode:function(e){return e.type==="keypress"?Vr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Vr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),q0=Je(G0),V0=m({},$r,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sd=Je(V0),Y0=m({},xa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yl}),X0=Je(Y0),$0=m({},Qn,{propertyName:0,elapsedTime:0,pseudoElement:0}),K0=Je($0),Z0=m({},$r,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),W0=Je(Z0),Q0=m({},Qn,{newState:0,oldState:0}),J0=Je(Q0),ty=[9,13,27,32],Xl=Qi&&"CompositionEvent"in window,Ra=null;Qi&&"documentMode"in document&&(Ra=document.documentMode);var ey=Qi&&"TextEvent"in window&&!Ra,ad=Qi&&(!Xl||Ra&&8<Ra&&11>=Ra),rd=" ",od=!1;function ld(e,n){switch(e){case"keyup":return ty.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ns=!1;function iy(e,n){switch(e){case"compositionend":return cd(n);case"keypress":return n.which!==32?null:(od=!0,rd);case"textInput":return e=n.data,e===rd&&od?null:e;default:return null}}function ny(e,n){if(Ns)return e==="compositionend"||!Xl&&ld(e,n)?(e=td(),qr=jl=_n=null,Ns=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return ad&&n.locale!=="ko"?null:n.data;default:return null}}var sy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ud(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!sy[e.type]:n==="textarea"}function hd(e,n,r,c){Os?ks?ks.push(c):ks=[c]:Os=c,n=Fo(n,"onChange"),0<n.length&&(r=new Xr("onChange","change",null,r,c),e.push({event:r,listeners:n}))}var Da=null,Oa=null;function ay(e){$p(e,0)}function Kr(e){var n=Ea(e);if(Yh(n))return e}function dd(e,n){if(e==="change")return n}var fd=!1;if(Qi){var $l;if(Qi){var Kl="oninput"in document;if(!Kl){var pd=document.createElement("div");pd.setAttribute("oninput","return;"),Kl=typeof pd.oninput=="function"}$l=Kl}else $l=!1;fd=$l&&(!document.documentMode||9<document.documentMode)}function gd(){Da&&(Da.detachEvent("onpropertychange",md),Oa=Da=null)}function md(e){if(e.propertyName==="value"&&Kr(Oa)){var n=[];hd(n,Oa,e,Pl(e)),Jh(ay,n)}}function ry(e,n,r){e==="focusin"?(gd(),Da=n,Oa=r,Da.attachEvent("onpropertychange",md)):e==="focusout"&&gd()}function oy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kr(Oa)}function ly(e,n){if(e==="click")return Kr(n)}function cy(e,n){if(e==="input"||e==="change")return Kr(n)}function uy(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var li=typeof Object.is=="function"?Object.is:uy;function ka(e,n){if(li(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var r=Object.keys(e),c=Object.keys(n);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var f=r[c];if(!V.call(n,f)||!li(e[f],n[f]))return!1}return!0}function yd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function bd(e,n){var r=yd(e);e=0;for(var c;r;){if(r.nodeType===3){if(c=e+r.textContent.length,e<=n&&c>=n)return{node:r,offset:n-e};e=c}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=yd(r)}}function vd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?vd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function _d(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=jr(e.document);n instanceof e.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)e=n.contentWindow;else break;n=jr(e.document)}return n}function Zl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var hy=Qi&&"documentMode"in document&&11>=document.documentMode,Ls=null,Wl=null,Na=null,Ql=!1;function Ad(e,n,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ql||Ls==null||Ls!==jr(c)||(c=Ls,"selectionStart"in c&&Zl(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Na&&ka(Na,c)||(Na=c,c=Fo(Wl,"onSelect"),0<c.length&&(n=new Xr("onSelect","select",null,n,r),e.push({event:n,listeners:c}),n.target=Ls)))}function Jn(e,n){var r={};return r[e.toLowerCase()]=n.toLowerCase(),r["Webkit"+e]="webkit"+n,r["Moz"+e]="moz"+n,r}var Bs={animationend:Jn("Animation","AnimationEnd"),animationiteration:Jn("Animation","AnimationIteration"),animationstart:Jn("Animation","AnimationStart"),transitionrun:Jn("Transition","TransitionRun"),transitionstart:Jn("Transition","TransitionStart"),transitioncancel:Jn("Transition","TransitionCancel"),transitionend:Jn("Transition","TransitionEnd")},Jl={},Sd={};Qi&&(Sd=document.createElement("div").style,"AnimationEvent"in window||(delete Bs.animationend.animation,delete Bs.animationiteration.animation,delete Bs.animationstart.animation),"TransitionEvent"in window||delete Bs.transitionend.transition);function ts(e){if(Jl[e])return Jl[e];if(!Bs[e])return e;var n=Bs[e],r;for(r in n)if(n.hasOwnProperty(r)&&r in Sd)return Jl[e]=n[r];return e}var wd=ts("animationend"),Ed=ts("animationiteration"),Cd=ts("animationstart"),dy=ts("transitionrun"),fy=ts("transitionstart"),py=ts("transitioncancel"),Td=ts("transitionend"),xd=new Map,tc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");tc.push("scrollEnd");function Li(e,n){xd.set(e,n),Wn(n,[e])}var Zr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Si=[],zs=0,ec=0;function Wr(){for(var e=zs,n=ec=zs=0;n<e;){var r=Si[n];Si[n++]=null;var c=Si[n];Si[n++]=null;var f=Si[n];Si[n++]=null;var y=Si[n];if(Si[n++]=null,c!==null&&f!==null){var E=c.pending;E===null?f.next=f:(f.next=E.next,E.next=f),c.pending=f}y!==0&&Md(r,f,y)}}function Qr(e,n,r,c){Si[zs++]=e,Si[zs++]=n,Si[zs++]=r,Si[zs++]=c,ec|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function ic(e,n,r,c){return Qr(e,n,r,c),Jr(e)}function es(e,n){return Qr(e,null,null,n),Jr(e)}function Md(e,n,r){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r);for(var f=!1,y=e.return;y!==null;)y.childLanes|=r,c=y.alternate,c!==null&&(c.childLanes|=r),y.tag===22&&(e=y.stateNode,e===null||e._visibility&1||(f=!0)),e=y,y=y.return;return e.tag===3?(y=e.stateNode,f&&n!==null&&(f=31-pe(r),e=y.hiddenUpdates,c=e[f],c===null?e[f]=[n]:c.push(n),n.lane=r|536870912),y):null}function Jr(e){if(50<er)throw er=0,hu=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Is={};function gy(e,n,r,c){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(e,n,r,c){return new gy(e,n,r,c)}function nc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ji(e,n){var r=e.alternate;return r===null?(r=ci(e.tag,n,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=n,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,n=e.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Rd(e,n){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,n=r.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function to(e,n,r,c,f,y){var E=0;if(c=e,typeof e=="function")nc(e)&&(E=1);else if(typeof e=="string")E=_b(e,r,it.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case j:return e=ci(31,r,n,f),e.elementType=j,e.lanes=y,e;case _:return is(r.children,f,y,n);case w:E=8,f|=24;break;case S:return e=ci(12,r,n,f|2),e.elementType=S,e.lanes=y,e;case O:return e=ci(13,r,n,f),e.elementType=O,e.lanes=y,e;case z:return e=ci(19,r,n,f),e.elementType=z,e.lanes=y,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:E=10;break t;case T:E=9;break t;case k:E=11;break t;case L:E=14;break t;case G:E=16,c=null;break t}E=29,r=Error(s(130,e===null?"null":typeof e,"")),c=null}return n=ci(E,r,n,f),n.elementType=e,n.type=c,n.lanes=y,n}function is(e,n,r,c){return e=ci(7,e,c,n),e.lanes=r,e}function sc(e,n,r){return e=ci(6,e,null,n),e.lanes=r,e}function Dd(e){var n=ci(18,null,null,0);return n.stateNode=e,n}function ac(e,n,r){return n=ci(4,e.children!==null?e.children:[],e.key,n),n.lanes=r,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Od=new WeakMap;function wi(e,n){if(typeof e=="object"&&e!==null){var r=Od.get(e);return r!==void 0?r:(n={value:e,source:n,stack:N(n)},Od.set(e,n),n)}return{value:e,source:n,stack:N(n)}}var Fs=[],Ps=0,eo=null,La=0,Ei=[],Ci=0,An=null,Pi=1,Ui="";function tn(e,n){Fs[Ps++]=La,Fs[Ps++]=eo,eo=e,La=n}function kd(e,n,r){Ei[Ci++]=Pi,Ei[Ci++]=Ui,Ei[Ci++]=An,An=e;var c=Pi;e=Ui;var f=32-pe(c)-1;c&=~(1<<f),r+=1;var y=32-pe(n)+f;if(30<y){var E=f-f%5;y=(c&(1<<E)-1).toString(32),c>>=E,f-=E,Pi=1<<32-pe(n)+f|r<<f|c,Ui=y+e}else Pi=1<<y|r<<f|c,Ui=e}function rc(e){e.return!==null&&(tn(e,1),kd(e,1,0))}function oc(e){for(;e===eo;)eo=Fs[--Ps],Fs[Ps]=null,La=Fs[--Ps],Fs[Ps]=null;for(;e===An;)An=Ei[--Ci],Ei[Ci]=null,Ui=Ei[--Ci],Ei[Ci]=null,Pi=Ei[--Ci],Ei[Ci]=null}function Nd(e,n){Ei[Ci++]=Pi,Ei[Ci++]=Ui,Ei[Ci++]=An,Pi=n.id,Ui=n.overflow,An=e}var ze=null,ce=null,Xt=!1,Sn=null,Ti=!1,lc=Error(s(519));function wn(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ba(wi(n,e)),lc}function Ld(e){var n=e.stateNode,r=e.type,c=e.memoizedProps;switch(n[Be]=e,n[Qe]=c,r){case"dialog":qt("cancel",n),qt("close",n);break;case"iframe":case"object":case"embed":qt("load",n);break;case"video":case"audio":for(r=0;r<nr.length;r++)qt(nr[r],n);break;case"source":qt("error",n);break;case"img":case"image":case"link":qt("error",n),qt("load",n);break;case"details":qt("toggle",n);break;case"input":qt("invalid",n),Xh(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":qt("invalid",n);break;case"textarea":qt("invalid",n),Kh(n,c.value,c.defaultValue,c.children)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||n.textContent===""+r||c.suppressHydrationWarning===!0||Qp(n.textContent,r)?(c.popover!=null&&(qt("beforetoggle",n),qt("toggle",n)),c.onScroll!=null&&qt("scroll",n),c.onScrollEnd!=null&&qt("scrollend",n),c.onClick!=null&&(n.onclick=Wi),n=!0):n=!1,n||wn(e,!0)}function Bd(e){for(ze=e.return;ze;)switch(ze.tag){case 5:case 31:case 13:Ti=!1;return;case 27:case 3:Ti=!0;return;default:ze=ze.return}}function Us(e){if(e!==ze)return!1;if(!Xt)return Bd(e),Xt=!0,!1;var n=e.tag,r;if((r=n!==3&&n!==27)&&((r=n===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Tu(e.type,e.memoizedProps)),r=!r),r&&ce&&wn(e),Bd(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));ce=og(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));ce=og(e)}else n===27?(n=ce,In(e.type)?(e=Ou,Ou=null,ce=e):ce=n):ce=ze?Mi(e.stateNode.nextSibling):null;return!0}function ns(){ce=ze=null,Xt=!1}function cc(){var e=Sn;return e!==null&&(ni===null?ni=e:ni.push.apply(ni,e),Sn=null),e}function Ba(e){Sn===null?Sn=[e]:Sn.push(e)}var uc=D(null),ss=null,en=null;function En(e,n,r){J(uc,n._currentValue),n._currentValue=r}function nn(e){e._currentValue=uc.current,B(uc)}function hc(e,n,r){for(;e!==null;){var c=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),e===r)break;e=e.return}}function dc(e,n,r,c){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var y=f.dependencies;if(y!==null){var E=f.child;y=y.firstContext;t:for(;y!==null;){var R=y;y=f;for(var P=0;P<n.length;P++)if(R.context===n[P]){y.lanes|=r,R=y.alternate,R!==null&&(R.lanes|=r),hc(y.return,r,e),c||(E=null);break t}y=R.next}}else if(f.tag===18){if(E=f.return,E===null)throw Error(s(341));E.lanes|=r,y=E.alternate,y!==null&&(y.lanes|=r),hc(E,r,e),E=null}else E=f.child;if(E!==null)E.return=f;else for(E=f;E!==null;){if(E===e){E=null;break}if(f=E.sibling,f!==null){f.return=E.return,E=f;break}E=E.return}f=E}}function Hs(e,n,r,c){e=null;for(var f=n,y=!1;f!==null;){if(!y){if((f.flags&524288)!==0)y=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var E=f.alternate;if(E===null)throw Error(s(387));if(E=E.memoizedProps,E!==null){var R=f.type;li(f.pendingProps.value,E.value)||(e!==null?e.push(R):e=[R])}}else if(f===St.current){if(E=f.alternate,E===null)throw Error(s(387));E.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(lr):e=[lr])}f=f.return}e!==null&&dc(n,e,r,c),n.flags|=262144}function io(e){for(e=e.firstContext;e!==null;){if(!li(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function as(e){ss=e,en=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ie(e){return zd(ss,e)}function no(e,n){return ss===null&&as(e),zd(e,n)}function zd(e,n){var r=n._currentValue;if(n={context:n,memoizedValue:r,next:null},en===null){if(e===null)throw Error(s(308));en=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else en=en.next=n;return r}var my=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(r,c){e.push(c)}};this.abort=function(){n.aborted=!0,e.forEach(function(r){return r()})}},yy=g.unstable_scheduleCallback,by=g.unstable_NormalPriority,we={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fc(){return{controller:new my,data:new Map,refCount:0}}function za(e){e.refCount--,e.refCount===0&&yy(by,function(){e.controller.abort()})}var Ia=null,pc=0,js=0,Gs=null;function vy(e,n){if(Ia===null){var r=Ia=[];pc=0,js=yu(),Gs={status:"pending",value:void 0,then:function(c){r.push(c)}}}return pc++,n.then(Id,Id),n}function Id(){if(--pc===0&&Ia!==null){Gs!==null&&(Gs.status="fulfilled");var e=Ia;Ia=null,js=0,Gs=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function _y(e,n){var r=[],c={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return e.then(function(){c.status="fulfilled",c.value=n;for(var f=0;f<r.length;f++)(0,r[f])(n)},function(f){for(c.status="rejected",c.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),c}var Fd=U.S;U.S=function(e,n){Sp=bt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&vy(e,n),Fd!==null&&Fd(e,n)};var rs=D(null);function gc(){var e=rs.current;return e!==null?e:oe.pooledCache}function so(e,n){n===null?J(rs,rs.current):J(rs,n.pool)}function Pd(){var e=gc();return e===null?null:{parent:we._currentValue,pool:e}}var qs=Error(s(460)),mc=Error(s(474)),ao=Error(s(542)),ro={then:function(){}};function Ud(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Hd(e,n,r){switch(r=e[r],r===void 0?e.push(n):r!==n&&(n.then(Wi,Wi),n=r),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Gd(e),e;default:if(typeof n.status=="string")n.then(Wi,Wi);else{if(e=oe,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(c){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=c}},function(c){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Gd(e),e}throw ls=n,qs}}function os(e){try{var n=e._init;return n(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(ls=r,qs):r}}var ls=null;function jd(){if(ls===null)throw Error(s(459));var e=ls;return ls=null,e}function Gd(e){if(e===qs||e===ao)throw Error(s(483))}var Vs=null,Fa=0;function oo(e){var n=Fa;return Fa+=1,Vs===null&&(Vs=[]),Hd(Vs,e,n)}function Pa(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function lo(e,n){throw n.$$typeof===v?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function qd(e){function n(Y,q){if(e){var $=Y.deletions;$===null?(Y.deletions=[q],Y.flags|=16):$.push(q)}}function r(Y,q){if(!e)return null;for(;q!==null;)n(Y,q),q=q.sibling;return null}function c(Y){for(var q=new Map;Y!==null;)Y.key!==null?q.set(Y.key,Y):q.set(Y.index,Y),Y=Y.sibling;return q}function f(Y,q){return Y=Ji(Y,q),Y.index=0,Y.sibling=null,Y}function y(Y,q,$){return Y.index=$,e?($=Y.alternate,$!==null?($=$.index,$<q?(Y.flags|=67108866,q):$):(Y.flags|=67108866,q)):(Y.flags|=1048576,q)}function E(Y){return e&&Y.alternate===null&&(Y.flags|=67108866),Y}function R(Y,q,$,ut){return q===null||q.tag!==6?(q=sc($,Y.mode,ut),q.return=Y,q):(q=f(q,$),q.return=Y,q)}function P(Y,q,$,ut){var Dt=$.type;return Dt===_?lt(Y,q,$.props.children,ut,$.key):q!==null&&(q.elementType===Dt||typeof Dt=="object"&&Dt!==null&&Dt.$$typeof===G&&os(Dt)===q.type)?(q=f(q,$.props),Pa(q,$),q.return=Y,q):(q=to($.type,$.key,$.props,null,Y.mode,ut),Pa(q,$),q.return=Y,q)}function K(Y,q,$,ut){return q===null||q.tag!==4||q.stateNode.containerInfo!==$.containerInfo||q.stateNode.implementation!==$.implementation?(q=ac($,Y.mode,ut),q.return=Y,q):(q=f(q,$.children||[]),q.return=Y,q)}function lt(Y,q,$,ut,Dt){return q===null||q.tag!==7?(q=is($,Y.mode,ut,Dt),q.return=Y,q):(q=f(q,$),q.return=Y,q)}function ht(Y,q,$){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=sc(""+q,Y.mode,$),q.return=Y,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case b:return $=to(q.type,q.key,q.props,null,Y.mode,$),Pa($,q),$.return=Y,$;case A:return q=ac(q,Y.mode,$),q.return=Y,q;case G:return q=os(q),ht(Y,q,$)}if(tt(q)||I(q))return q=is(q,Y.mode,$,null),q.return=Y,q;if(typeof q.then=="function")return ht(Y,oo(q),$);if(q.$$typeof===M)return ht(Y,no(Y,q),$);lo(Y,q)}return null}function Q(Y,q,$,ut){var Dt=q!==null?q.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return Dt!==null?null:R(Y,q,""+$,ut);if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return $.key===Dt?P(Y,q,$,ut):null;case A:return $.key===Dt?K(Y,q,$,ut):null;case G:return $=os($),Q(Y,q,$,ut)}if(tt($)||I($))return Dt!==null?null:lt(Y,q,$,ut,null);if(typeof $.then=="function")return Q(Y,q,oo($),ut);if($.$$typeof===M)return Q(Y,q,no(Y,$),ut);lo(Y,$)}return null}function nt(Y,q,$,ut,Dt){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Y=Y.get($)||null,R(q,Y,""+ut,Dt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case b:return Y=Y.get(ut.key===null?$:ut.key)||null,P(q,Y,ut,Dt);case A:return Y=Y.get(ut.key===null?$:ut.key)||null,K(q,Y,ut,Dt);case G:return ut=os(ut),nt(Y,q,$,ut,Dt)}if(tt(ut)||I(ut))return Y=Y.get($)||null,lt(q,Y,ut,Dt,null);if(typeof ut.then=="function")return nt(Y,q,$,oo(ut),Dt);if(ut.$$typeof===M)return nt(Y,q,$,no(q,ut),Dt);lo(q,ut)}return null}function Et(Y,q,$,ut){for(var Dt=null,Zt=null,Tt=q,Pt=q=0,Yt=null;Tt!==null&&Pt<$.length;Pt++){Tt.index>Pt?(Yt=Tt,Tt=null):Yt=Tt.sibling;var Wt=Q(Y,Tt,$[Pt],ut);if(Wt===null){Tt===null&&(Tt=Yt);break}e&&Tt&&Wt.alternate===null&&n(Y,Tt),q=y(Wt,q,Pt),Zt===null?Dt=Wt:Zt.sibling=Wt,Zt=Wt,Tt=Yt}if(Pt===$.length)return r(Y,Tt),Xt&&tn(Y,Pt),Dt;if(Tt===null){for(;Pt<$.length;Pt++)Tt=ht(Y,$[Pt],ut),Tt!==null&&(q=y(Tt,q,Pt),Zt===null?Dt=Tt:Zt.sibling=Tt,Zt=Tt);return Xt&&tn(Y,Pt),Dt}for(Tt=c(Tt);Pt<$.length;Pt++)Yt=nt(Tt,Y,Pt,$[Pt],ut),Yt!==null&&(e&&Yt.alternate!==null&&Tt.delete(Yt.key===null?Pt:Yt.key),q=y(Yt,q,Pt),Zt===null?Dt=Yt:Zt.sibling=Yt,Zt=Yt);return e&&Tt.forEach(function(jn){return n(Y,jn)}),Xt&&tn(Y,Pt),Dt}function kt(Y,q,$,ut){if($==null)throw Error(s(151));for(var Dt=null,Zt=null,Tt=q,Pt=q=0,Yt=null,Wt=$.next();Tt!==null&&!Wt.done;Pt++,Wt=$.next()){Tt.index>Pt?(Yt=Tt,Tt=null):Yt=Tt.sibling;var jn=Q(Y,Tt,Wt.value,ut);if(jn===null){Tt===null&&(Tt=Yt);break}e&&Tt&&jn.alternate===null&&n(Y,Tt),q=y(jn,q,Pt),Zt===null?Dt=jn:Zt.sibling=jn,Zt=jn,Tt=Yt}if(Wt.done)return r(Y,Tt),Xt&&tn(Y,Pt),Dt;if(Tt===null){for(;!Wt.done;Pt++,Wt=$.next())Wt=ht(Y,Wt.value,ut),Wt!==null&&(q=y(Wt,q,Pt),Zt===null?Dt=Wt:Zt.sibling=Wt,Zt=Wt);return Xt&&tn(Y,Pt),Dt}for(Tt=c(Tt);!Wt.done;Pt++,Wt=$.next())Wt=nt(Tt,Y,Pt,Wt.value,ut),Wt!==null&&(e&&Wt.alternate!==null&&Tt.delete(Wt.key===null?Pt:Wt.key),q=y(Wt,q,Pt),Zt===null?Dt=Wt:Zt.sibling=Wt,Zt=Wt);return e&&Tt.forEach(function(Ob){return n(Y,Ob)}),Xt&&tn(Y,Pt),Dt}function se(Y,q,$,ut){if(typeof $=="object"&&$!==null&&$.type===_&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case b:t:{for(var Dt=$.key;q!==null;){if(q.key===Dt){if(Dt=$.type,Dt===_){if(q.tag===7){r(Y,q.sibling),ut=f(q,$.props.children),ut.return=Y,Y=ut;break t}}else if(q.elementType===Dt||typeof Dt=="object"&&Dt!==null&&Dt.$$typeof===G&&os(Dt)===q.type){r(Y,q.sibling),ut=f(q,$.props),Pa(ut,$),ut.return=Y,Y=ut;break t}r(Y,q);break}else n(Y,q);q=q.sibling}$.type===_?(ut=is($.props.children,Y.mode,ut,$.key),ut.return=Y,Y=ut):(ut=to($.type,$.key,$.props,null,Y.mode,ut),Pa(ut,$),ut.return=Y,Y=ut)}return E(Y);case A:t:{for(Dt=$.key;q!==null;){if(q.key===Dt)if(q.tag===4&&q.stateNode.containerInfo===$.containerInfo&&q.stateNode.implementation===$.implementation){r(Y,q.sibling),ut=f(q,$.children||[]),ut.return=Y,Y=ut;break t}else{r(Y,q);break}else n(Y,q);q=q.sibling}ut=ac($,Y.mode,ut),ut.return=Y,Y=ut}return E(Y);case G:return $=os($),se(Y,q,$,ut)}if(tt($))return Et(Y,q,$,ut);if(I($)){if(Dt=I($),typeof Dt!="function")throw Error(s(150));return $=Dt.call($),kt(Y,q,$,ut)}if(typeof $.then=="function")return se(Y,q,oo($),ut);if($.$$typeof===M)return se(Y,q,no(Y,$),ut);lo(Y,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,q!==null&&q.tag===6?(r(Y,q.sibling),ut=f(q,$),ut.return=Y,Y=ut):(r(Y,q),ut=sc($,Y.mode,ut),ut.return=Y,Y=ut),E(Y)):r(Y,q)}return function(Y,q,$,ut){try{Fa=0;var Dt=se(Y,q,$,ut);return Vs=null,Dt}catch(Tt){if(Tt===qs||Tt===ao)throw Tt;var Zt=ci(29,Tt,null,Y.mode);return Zt.lanes=ut,Zt.return=Y,Zt}finally{}}}var cs=qd(!0),Vd=qd(!1),Cn=!1;function yc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bc(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Tn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function xn(e,n,r){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(Qt&2)!==0){var f=c.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),c.pending=n,n=Jr(e),Md(e,null,r),n}return Qr(e,c,n,r),Jr(e)}function Ua(e,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194048)!==0)){var c=n.lanes;c&=e.pendingLanes,r|=c,n.lanes=r,zh(e,r)}}function vc(e,n){var r=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var f=null,y=null;if(r=r.firstBaseUpdate,r!==null){do{var E={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};y===null?f=y=E:y=y.next=E,r=r.next}while(r!==null);y===null?f=y=n:y=y.next=n}else f=y=n;r={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=n:e.next=n,r.lastBaseUpdate=n}var _c=!1;function Ha(){if(_c){var e=Gs;if(e!==null)throw e}}function ja(e,n,r,c){_c=!1;var f=e.updateQueue;Cn=!1;var y=f.firstBaseUpdate,E=f.lastBaseUpdate,R=f.shared.pending;if(R!==null){f.shared.pending=null;var P=R,K=P.next;P.next=null,E===null?y=K:E.next=K,E=P;var lt=e.alternate;lt!==null&&(lt=lt.updateQueue,R=lt.lastBaseUpdate,R!==E&&(R===null?lt.firstBaseUpdate=K:R.next=K,lt.lastBaseUpdate=P))}if(y!==null){var ht=f.baseState;E=0,lt=K=P=null,R=y;do{var Q=R.lane&-536870913,nt=Q!==R.lane;if(nt?(Vt&Q)===Q:(c&Q)===Q){Q!==0&&Q===js&&(_c=!0),lt!==null&&(lt=lt.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});t:{var Et=e,kt=R;Q=n;var se=r;switch(kt.tag){case 1:if(Et=kt.payload,typeof Et=="function"){ht=Et.call(se,ht,Q);break t}ht=Et;break t;case 3:Et.flags=Et.flags&-65537|128;case 0:if(Et=kt.payload,Q=typeof Et=="function"?Et.call(se,ht,Q):Et,Q==null)break t;ht=m({},ht,Q);break t;case 2:Cn=!0}}Q=R.callback,Q!==null&&(e.flags|=64,nt&&(e.flags|=8192),nt=f.callbacks,nt===null?f.callbacks=[Q]:nt.push(Q))}else nt={lane:Q,tag:R.tag,payload:R.payload,callback:R.callback,next:null},lt===null?(K=lt=nt,P=ht):lt=lt.next=nt,E|=Q;if(R=R.next,R===null){if(R=f.shared.pending,R===null)break;nt=R,R=nt.next,nt.next=null,f.lastBaseUpdate=nt,f.shared.pending=null}}while(!0);lt===null&&(P=ht),f.baseState=P,f.firstBaseUpdate=K,f.lastBaseUpdate=lt,y===null&&(f.shared.lanes=0),kn|=E,e.lanes=E,e.memoizedState=ht}}function Yd(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function Xd(e,n){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)Yd(r[e],n)}var Ys=D(null),co=D(0);function $d(e,n){e=dn,J(co,e),J(Ys,n),dn=e|n.baseLanes}function Ac(){J(co,dn),J(Ys,Ys.current)}function Sc(){dn=co.current,B(Ys),B(co)}var ui=D(null),xi=null;function Mn(e){var n=e.alternate;J(_e,_e.current&1),J(ui,e),xi===null&&(n===null||Ys.current!==null||n.memoizedState!==null)&&(xi=e)}function wc(e){J(_e,_e.current),J(ui,e),xi===null&&(xi=e)}function Kd(e){e.tag===22?(J(_e,_e.current),J(ui,e),xi===null&&(xi=e)):Rn()}function Rn(){J(_e,_e.current),J(ui,ui.current)}function hi(e){B(ui),xi===e&&(xi=null),B(_e)}var _e=D(0);function uo(e){for(var n=e;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Ru(r)||Du(r)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var sn=0,Ft=null,ie=null,Ee=null,ho=!1,Xs=!1,us=!1,fo=0,Ga=0,$s=null,Ay=0;function ye(){throw Error(s(321))}function Ec(e,n){if(n===null)return!1;for(var r=0;r<n.length&&r<e.length;r++)if(!li(e[r],n[r]))return!1;return!0}function Cc(e,n,r,c,f,y){return sn=y,Ft=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,U.H=e===null||e.memoizedState===null?Nf:Uc,us=!1,y=r(c,f),us=!1,Xs&&(y=Wd(n,r,c,f)),Zd(e),y}function Zd(e){U.H=Ya;var n=ie!==null&&ie.next!==null;if(sn=0,Ee=ie=Ft=null,ho=!1,Ga=0,$s=null,n)throw Error(s(300));e===null||Ce||(e=e.dependencies,e!==null&&io(e)&&(Ce=!0))}function Wd(e,n,r,c){Ft=e;var f=0;do{if(Xs&&($s=null),Ga=0,Xs=!1,25<=f)throw Error(s(301));if(f+=1,Ee=ie=null,e.updateQueue!=null){var y=e.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}U.H=Lf,y=n(r,c)}while(Xs);return y}function Sy(){var e=U.H,n=e.useState()[0];return n=typeof n.then=="function"?qa(n):n,e=e.useState()[0],(ie!==null?ie.memoizedState:null)!==e&&(Ft.flags|=1024),n}function Tc(){var e=fo!==0;return fo=0,e}function xc(e,n,r){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r}function Mc(e){if(ho){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}ho=!1}sn=0,Ee=ie=Ft=null,Xs=!1,Ga=fo=0,$s=null}function Ye(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ee===null?Ft.memoizedState=Ee=e:Ee=Ee.next=e,Ee}function Ae(){if(ie===null){var e=Ft.alternate;e=e!==null?e.memoizedState:null}else e=ie.next;var n=Ee===null?Ft.memoizedState:Ee.next;if(n!==null)Ee=n,ie=e;else{if(e===null)throw Ft.alternate===null?Error(s(467)):Error(s(310));ie=e,e={memoizedState:ie.memoizedState,baseState:ie.baseState,baseQueue:ie.baseQueue,queue:ie.queue,next:null},Ee===null?Ft.memoizedState=Ee=e:Ee=Ee.next=e}return Ee}function po(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function qa(e){var n=Ga;return Ga+=1,$s===null&&($s=[]),e=Hd($s,e,n),n=Ft,(Ee===null?n.memoizedState:Ee.next)===null&&(n=n.alternate,U.H=n===null||n.memoizedState===null?Nf:Uc),e}function go(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return qa(e);if(e.$$typeof===M)return Ie(e)}throw Error(s(438,String(e)))}function Rc(e){var n=null,r=Ft.updateQueue;if(r!==null&&(n=r.memoCache),n==null){var c=Ft.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),r===null&&(r=po(),Ft.updateQueue=r),r.memoCache=n,r=n.data[n.index],r===void 0)for(r=n.data[n.index]=Array(e),c=0;c<e;c++)r[c]=Z;return n.index++,r}function an(e,n){return typeof n=="function"?n(e):n}function mo(e){var n=Ae();return Dc(n,ie,e)}function Dc(e,n,r){var c=e.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var f=e.baseQueue,y=c.pending;if(y!==null){if(f!==null){var E=f.next;f.next=y.next,y.next=E}n.baseQueue=f=y,c.pending=null}if(y=e.baseState,f===null)e.memoizedState=y;else{n=f.next;var R=E=null,P=null,K=n,lt=!1;do{var ht=K.lane&-536870913;if(ht!==K.lane?(Vt&ht)===ht:(sn&ht)===ht){var Q=K.revertLane;if(Q===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),ht===js&&(lt=!0);else if((sn&Q)===Q){K=K.next,Q===js&&(lt=!0);continue}else ht={lane:0,revertLane:K.revertLane,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},P===null?(R=P=ht,E=y):P=P.next=ht,Ft.lanes|=Q,kn|=Q;ht=K.action,us&&r(y,ht),y=K.hasEagerState?K.eagerState:r(y,ht)}else Q={lane:ht,revertLane:K.revertLane,gesture:K.gesture,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},P===null?(R=P=Q,E=y):P=P.next=Q,Ft.lanes|=ht,kn|=ht;K=K.next}while(K!==null&&K!==n);if(P===null?E=y:P.next=R,!li(y,e.memoizedState)&&(Ce=!0,lt&&(r=Gs,r!==null)))throw r;e.memoizedState=y,e.baseState=E,e.baseQueue=P,c.lastRenderedState=y}return f===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function Oc(e){var n=Ae(),r=n.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=e;var c=r.dispatch,f=r.pending,y=n.memoizedState;if(f!==null){r.pending=null;var E=f=f.next;do y=e(y,E.action),E=E.next;while(E!==f);li(y,n.memoizedState)||(Ce=!0),n.memoizedState=y,n.baseQueue===null&&(n.baseState=y),r.lastRenderedState=y}return[y,c]}function Qd(e,n,r){var c=Ft,f=Ae(),y=Xt;if(y){if(r===void 0)throw Error(s(407));r=r()}else r=n();var E=!li((ie||f).memoizedState,r);if(E&&(f.memoizedState=r,Ce=!0),f=f.queue,Lc(ef.bind(null,c,f,e),[e]),f.getSnapshot!==n||E||Ee!==null&&Ee.memoizedState.tag&1){if(c.flags|=2048,Ks(9,{destroy:void 0},tf.bind(null,c,f,r,n),null),oe===null)throw Error(s(349));y||(sn&127)!==0||Jd(c,n,r)}return r}function Jd(e,n,r){e.flags|=16384,e={getSnapshot:n,value:r},n=Ft.updateQueue,n===null?(n=po(),Ft.updateQueue=n,n.stores=[e]):(r=n.stores,r===null?n.stores=[e]:r.push(e))}function tf(e,n,r,c){n.value=r,n.getSnapshot=c,nf(n)&&sf(e)}function ef(e,n,r){return r(function(){nf(n)&&sf(e)})}function nf(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!li(e,r)}catch{return!0}}function sf(e){var n=es(e,2);n!==null&&si(n,e,2)}function kc(e){var n=Ye();if(typeof e=="function"){var r=e;if(e=r(),us){bi(!0);try{r()}finally{bi(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:an,lastRenderedState:e},n}function af(e,n,r,c){return e.baseState=r,Dc(e,ie,typeof c=="function"?c:an)}function wy(e,n,r,c,f){if(vo(e))throw Error(s(485));if(e=n.action,e!==null){var y={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){y.listeners.push(E)}};U.T!==null?r(!0):y.isTransition=!1,c(y),r=n.pending,r===null?(y.next=n.pending=y,rf(n,y)):(y.next=r.next,n.pending=r.next=y)}}function rf(e,n){var r=n.action,c=n.payload,f=e.state;if(n.isTransition){var y=U.T,E={};U.T=E;try{var R=r(f,c),P=U.S;P!==null&&P(E,R),of(e,n,R)}catch(K){Nc(e,n,K)}finally{y!==null&&E.types!==null&&(y.types=E.types),U.T=y}}else try{y=r(f,c),of(e,n,y)}catch(K){Nc(e,n,K)}}function of(e,n,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){lf(e,n,c)},function(c){return Nc(e,n,c)}):lf(e,n,r)}function lf(e,n,r){n.status="fulfilled",n.value=r,cf(n),e.state=r,n=e.pending,n!==null&&(r=n.next,r===n?e.pending=null:(r=r.next,n.next=r,rf(e,r)))}function Nc(e,n,r){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=r,cf(n),n=n.next;while(n!==c)}e.action=null}function cf(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function uf(e,n){return n}function hf(e,n){if(Xt){var r=oe.formState;if(r!==null){t:{var c=Ft;if(Xt){if(ce){e:{for(var f=ce,y=Ti;f.nodeType!==8;){if(!y){f=null;break e}if(f=Mi(f.nextSibling),f===null){f=null;break e}}y=f.data,f=y==="F!"||y==="F"?f:null}if(f){ce=Mi(f.nextSibling),c=f.data==="F!";break t}}wn(c)}c=!1}c&&(n=r[0])}}return r=Ye(),r.memoizedState=r.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uf,lastRenderedState:n},r.queue=c,r=Df.bind(null,Ft,c),c.dispatch=r,c=kc(!1),y=Pc.bind(null,Ft,!1,c.queue),c=Ye(),f={state:n,dispatch:null,action:e,pending:null},c.queue=f,r=wy.bind(null,Ft,f,y,r),f.dispatch=r,c.memoizedState=e,[n,r,!1]}function df(e){var n=Ae();return ff(n,ie,e)}function ff(e,n,r){if(n=Dc(e,n,uf)[0],e=mo(an)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var c=qa(n)}catch(E){throw E===qs?ao:E}else c=n;n=Ae();var f=n.queue,y=f.dispatch;return r!==n.memoizedState&&(Ft.flags|=2048,Ks(9,{destroy:void 0},Ey.bind(null,f,r),null)),[c,y,e]}function Ey(e,n){e.action=n}function pf(e){var n=Ae(),r=ie;if(r!==null)return ff(n,r,e);Ae(),n=n.memoizedState,r=Ae();var c=r.queue.dispatch;return r.memoizedState=e,[n,c,!1]}function Ks(e,n,r,c){return e={tag:e,create:r,deps:c,inst:n,next:null},n=Ft.updateQueue,n===null&&(n=po(),Ft.updateQueue=n),r=n.lastEffect,r===null?n.lastEffect=e.next=e:(c=r.next,r.next=e,e.next=c,n.lastEffect=e),e}function gf(){return Ae().memoizedState}function yo(e,n,r,c){var f=Ye();Ft.flags|=e,f.memoizedState=Ks(1|n,{destroy:void 0},r,c===void 0?null:c)}function bo(e,n,r,c){var f=Ae();c=c===void 0?null:c;var y=f.memoizedState.inst;ie!==null&&c!==null&&Ec(c,ie.memoizedState.deps)?f.memoizedState=Ks(n,y,r,c):(Ft.flags|=e,f.memoizedState=Ks(1|n,y,r,c))}function mf(e,n){yo(8390656,8,e,n)}function Lc(e,n){bo(2048,8,e,n)}function Cy(e){Ft.flags|=4;var n=Ft.updateQueue;if(n===null)n=po(),Ft.updateQueue=n,n.events=[e];else{var r=n.events;r===null?n.events=[e]:r.push(e)}}function yf(e){var n=Ae().memoizedState;return Cy({ref:n,nextImpl:e}),function(){if((Qt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function bf(e,n){return bo(4,2,e,n)}function vf(e,n){return bo(4,4,e,n)}function _f(e,n){if(typeof n=="function"){e=e();var r=n(e);return function(){typeof r=="function"?r():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Af(e,n,r){r=r!=null?r.concat([e]):null,bo(4,4,_f.bind(null,n,e),r)}function Bc(){}function Sf(e,n){var r=Ae();n=n===void 0?null:n;var c=r.memoizedState;return n!==null&&Ec(n,c[1])?c[0]:(r.memoizedState=[e,n],e)}function wf(e,n){var r=Ae();n=n===void 0?null:n;var c=r.memoizedState;if(n!==null&&Ec(n,c[1]))return c[0];if(c=e(),us){bi(!0);try{e()}finally{bi(!1)}}return r.memoizedState=[c,n],c}function zc(e,n,r){return r===void 0||(sn&1073741824)!==0&&(Vt&261930)===0?e.memoizedState=n:(e.memoizedState=r,e=Ep(),Ft.lanes|=e,kn|=e,r)}function Ef(e,n,r,c){return li(r,n)?r:Ys.current!==null?(e=zc(e,r,c),li(e,n)||(Ce=!0),e):(sn&42)===0||(sn&1073741824)!==0&&(Vt&261930)===0?(Ce=!0,e.memoizedState=r):(e=Ep(),Ft.lanes|=e,kn|=e,n)}function Cf(e,n,r,c,f){var y=H.p;H.p=y!==0&&8>y?y:8;var E=U.T,R={};U.T=R,Pc(e,!1,n,r);try{var P=f(),K=U.S;if(K!==null&&K(R,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var lt=_y(P,c);Va(e,n,lt,pi(e))}else Va(e,n,c,pi(e))}catch(ht){Va(e,n,{then:function(){},status:"rejected",reason:ht},pi())}finally{H.p=y,E!==null&&R.types!==null&&(E.types=R.types),U.T=E}}function Ty(){}function Ic(e,n,r,c){if(e.tag!==5)throw Error(s(476));var f=Tf(e).queue;Cf(e,f,n,ct,r===null?Ty:function(){return xf(e),r(c)})}function Tf(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:ct,baseState:ct,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:an,lastRenderedState:ct},next:null};var r={};return n.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:an,lastRenderedState:r},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function xf(e){var n=Tf(e);n.next===null&&(n=e.alternate.memoizedState),Va(e,n.next.queue,{},pi())}function Fc(){return Ie(lr)}function Mf(){return Ae().memoizedState}function Rf(){return Ae().memoizedState}function xy(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var r=pi();e=Tn(r);var c=xn(n,e,r);c!==null&&(si(c,n,r),Ua(c,n,r)),n={cache:fc()},e.payload=n;return}n=n.return}}function My(e,n,r){var c=pi();r={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},vo(e)?Of(n,r):(r=ic(e,n,r,c),r!==null&&(si(r,e,c),kf(r,n,c)))}function Df(e,n,r){var c=pi();Va(e,n,r,c)}function Va(e,n,r,c){var f={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(vo(e))Of(n,f);else{var y=e.alternate;if(e.lanes===0&&(y===null||y.lanes===0)&&(y=n.lastRenderedReducer,y!==null))try{var E=n.lastRenderedState,R=y(E,r);if(f.hasEagerState=!0,f.eagerState=R,li(R,E))return Qr(e,n,f,0),oe===null&&Wr(),!1}catch{}finally{}if(r=ic(e,n,f,c),r!==null)return si(r,e,c),kf(r,n,c),!0}return!1}function Pc(e,n,r,c){if(c={lane:2,revertLane:yu(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},vo(e)){if(n)throw Error(s(479))}else n=ic(e,r,c,2),n!==null&&si(n,e,2)}function vo(e){var n=e.alternate;return e===Ft||n!==null&&n===Ft}function Of(e,n){Xs=ho=!0;var r=e.pending;r===null?n.next=n:(n.next=r.next,r.next=n),e.pending=n}function kf(e,n,r){if((r&4194048)!==0){var c=n.lanes;c&=e.pendingLanes,r|=c,n.lanes=r,zh(e,r)}}var Ya={readContext:Ie,use:go,useCallback:ye,useContext:ye,useEffect:ye,useImperativeHandle:ye,useLayoutEffect:ye,useInsertionEffect:ye,useMemo:ye,useReducer:ye,useRef:ye,useState:ye,useDebugValue:ye,useDeferredValue:ye,useTransition:ye,useSyncExternalStore:ye,useId:ye,useHostTransitionStatus:ye,useFormState:ye,useActionState:ye,useOptimistic:ye,useMemoCache:ye,useCacheRefresh:ye};Ya.useEffectEvent=ye;var Nf={readContext:Ie,use:go,useCallback:function(e,n){return Ye().memoizedState=[e,n===void 0?null:n],e},useContext:Ie,useEffect:mf,useImperativeHandle:function(e,n,r){r=r!=null?r.concat([e]):null,yo(4194308,4,_f.bind(null,n,e),r)},useLayoutEffect:function(e,n){return yo(4194308,4,e,n)},useInsertionEffect:function(e,n){yo(4,2,e,n)},useMemo:function(e,n){var r=Ye();n=n===void 0?null:n;var c=e();if(us){bi(!0);try{e()}finally{bi(!1)}}return r.memoizedState=[c,n],c},useReducer:function(e,n,r){var c=Ye();if(r!==void 0){var f=r(n);if(us){bi(!0);try{r(n)}finally{bi(!1)}}}else f=n;return c.memoizedState=c.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},c.queue=e,e=e.dispatch=My.bind(null,Ft,e),[c.memoizedState,e]},useRef:function(e){var n=Ye();return e={current:e},n.memoizedState=e},useState:function(e){e=kc(e);var n=e.queue,r=Df.bind(null,Ft,n);return n.dispatch=r,[e.memoizedState,r]},useDebugValue:Bc,useDeferredValue:function(e,n){var r=Ye();return zc(r,e,n)},useTransition:function(){var e=kc(!1);return e=Cf.bind(null,Ft,e.queue,!0,!1),Ye().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,r){var c=Ft,f=Ye();if(Xt){if(r===void 0)throw Error(s(407));r=r()}else{if(r=n(),oe===null)throw Error(s(349));(Vt&127)!==0||Jd(c,n,r)}f.memoizedState=r;var y={value:r,getSnapshot:n};return f.queue=y,mf(ef.bind(null,c,y,e),[e]),c.flags|=2048,Ks(9,{destroy:void 0},tf.bind(null,c,y,r,n),null),r},useId:function(){var e=Ye(),n=oe.identifierPrefix;if(Xt){var r=Ui,c=Pi;r=(c&~(1<<32-pe(c)-1)).toString(32)+r,n="_"+n+"R_"+r,r=fo++,0<r&&(n+="H"+r.toString(32)),n+="_"}else r=Ay++,n="_"+n+"r_"+r.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:Fc,useFormState:hf,useActionState:hf,useOptimistic:function(e){var n=Ye();n.memoizedState=n.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=r,n=Pc.bind(null,Ft,!0,r),r.dispatch=n,[e,n]},useMemoCache:Rc,useCacheRefresh:function(){return Ye().memoizedState=xy.bind(null,Ft)},useEffectEvent:function(e){var n=Ye(),r={impl:e};return n.memoizedState=r,function(){if((Qt&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}},Uc={readContext:Ie,use:go,useCallback:Sf,useContext:Ie,useEffect:Lc,useImperativeHandle:Af,useInsertionEffect:bf,useLayoutEffect:vf,useMemo:wf,useReducer:mo,useRef:gf,useState:function(){return mo(an)},useDebugValue:Bc,useDeferredValue:function(e,n){var r=Ae();return Ef(r,ie.memoizedState,e,n)},useTransition:function(){var e=mo(an)[0],n=Ae().memoizedState;return[typeof e=="boolean"?e:qa(e),n]},useSyncExternalStore:Qd,useId:Mf,useHostTransitionStatus:Fc,useFormState:df,useActionState:df,useOptimistic:function(e,n){var r=Ae();return af(r,ie,e,n)},useMemoCache:Rc,useCacheRefresh:Rf};Uc.useEffectEvent=yf;var Lf={readContext:Ie,use:go,useCallback:Sf,useContext:Ie,useEffect:Lc,useImperativeHandle:Af,useInsertionEffect:bf,useLayoutEffect:vf,useMemo:wf,useReducer:Oc,useRef:gf,useState:function(){return Oc(an)},useDebugValue:Bc,useDeferredValue:function(e,n){var r=Ae();return ie===null?zc(r,e,n):Ef(r,ie.memoizedState,e,n)},useTransition:function(){var e=Oc(an)[0],n=Ae().memoizedState;return[typeof e=="boolean"?e:qa(e),n]},useSyncExternalStore:Qd,useId:Mf,useHostTransitionStatus:Fc,useFormState:pf,useActionState:pf,useOptimistic:function(e,n){var r=Ae();return ie!==null?af(r,ie,e,n):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Rc,useCacheRefresh:Rf};Lf.useEffectEvent=yf;function Hc(e,n,r,c){n=e.memoizedState,r=r(c,n),r=r==null?n:m({},n,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var jc={enqueueSetState:function(e,n,r){e=e._reactInternals;var c=pi(),f=Tn(c);f.payload=n,r!=null&&(f.callback=r),n=xn(e,f,c),n!==null&&(si(n,e,c),Ua(n,e,c))},enqueueReplaceState:function(e,n,r){e=e._reactInternals;var c=pi(),f=Tn(c);f.tag=1,f.payload=n,r!=null&&(f.callback=r),n=xn(e,f,c),n!==null&&(si(n,e,c),Ua(n,e,c))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var r=pi(),c=Tn(r);c.tag=2,n!=null&&(c.callback=n),n=xn(e,c,r),n!==null&&(si(n,e,r),Ua(n,e,r))}};function Bf(e,n,r,c,f,y,E){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,y,E):n.prototype&&n.prototype.isPureReactComponent?!ka(r,c)||!ka(f,y):!0}function zf(e,n,r,c){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,c),n.state!==e&&jc.enqueueReplaceState(n,n.state,null)}function hs(e,n){var r=n;if("ref"in n){r={};for(var c in n)c!=="ref"&&(r[c]=n[c])}if(e=e.defaultProps){r===n&&(r=m({},r));for(var f in e)r[f]===void 0&&(r[f]=e[f])}return r}function If(e){Zr(e)}function Ff(e){console.error(e)}function Pf(e){Zr(e)}function _o(e,n){try{var r=e.onUncaughtError;r(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function Uf(e,n,r){try{var c=e.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Gc(e,n,r){return r=Tn(r),r.tag=3,r.payload={element:null},r.callback=function(){_o(e,n)},r}function Hf(e){return e=Tn(e),e.tag=3,e}function jf(e,n,r,c){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var y=c.value;e.payload=function(){return f(y)},e.callback=function(){Uf(n,r,c)}}var E=r.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(e.callback=function(){Uf(n,r,c),typeof f!="function"&&(Nn===null?Nn=new Set([this]):Nn.add(this));var R=c.stack;this.componentDidCatch(c.value,{componentStack:R!==null?R:""})})}function Ry(e,n,r,c,f){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=r.alternate,n!==null&&Hs(n,r,f,!0),r=ui.current,r!==null){switch(r.tag){case 31:case 13:return xi===null?ko():r.alternate===null&&be===0&&(be=3),r.flags&=-257,r.flags|=65536,r.lanes=f,c===ro?r.flags|=16384:(n=r.updateQueue,n===null?r.updateQueue=new Set([c]):n.add(c),pu(e,c,f)),!1;case 22:return r.flags|=65536,c===ro?r.flags|=16384:(n=r.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=n):(r=n.retryQueue,r===null?n.retryQueue=new Set([c]):r.add(c)),pu(e,c,f)),!1}throw Error(s(435,r.tag))}return pu(e,c,f),ko(),!1}if(Xt)return n=ui.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,c!==lc&&(e=Error(s(422),{cause:c}),Ba(wi(e,r)))):(c!==lc&&(n=Error(s(423),{cause:c}),Ba(wi(n,r))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,c=wi(c,r),f=Gc(e.stateNode,c,f),vc(e,f),be!==4&&(be=2)),!1;var y=Error(s(520),{cause:c});if(y=wi(y,r),tr===null?tr=[y]:tr.push(y),be!==4&&(be=2),n===null)return!0;c=wi(c,r),r=n;do{switch(r.tag){case 3:return r.flags|=65536,e=f&-f,r.lanes|=e,e=Gc(r.stateNode,c,e),vc(r,e),!1;case 1:if(n=r.type,y=r.stateNode,(r.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Nn===null||!Nn.has(y))))return r.flags|=65536,f&=-f,r.lanes|=f,f=Hf(f),jf(f,e,r,c),vc(r,f),!1}r=r.return}while(r!==null);return!1}var qc=Error(s(461)),Ce=!1;function Fe(e,n,r,c){n.child=e===null?Vd(n,null,r,c):cs(n,e.child,r,c)}function Gf(e,n,r,c,f){r=r.render;var y=n.ref;if("ref"in c){var E={};for(var R in c)R!=="ref"&&(E[R]=c[R])}else E=c;return as(n),c=Cc(e,n,r,E,y,f),R=Tc(),e!==null&&!Ce?(xc(e,n,f),rn(e,n,f)):(Xt&&R&&rc(n),n.flags|=1,Fe(e,n,c,f),n.child)}function qf(e,n,r,c,f){if(e===null){var y=r.type;return typeof y=="function"&&!nc(y)&&y.defaultProps===void 0&&r.compare===null?(n.tag=15,n.type=y,Vf(e,n,y,c,f)):(e=to(r.type,null,c,n,n.mode,f),e.ref=n.ref,e.return=n,n.child=e)}if(y=e.child,!Qc(e,f)){var E=y.memoizedProps;if(r=r.compare,r=r!==null?r:ka,r(E,c)&&e.ref===n.ref)return rn(e,n,f)}return n.flags|=1,e=Ji(y,c),e.ref=n.ref,e.return=n,n.child=e}function Vf(e,n,r,c,f){if(e!==null){var y=e.memoizedProps;if(ka(y,c)&&e.ref===n.ref)if(Ce=!1,n.pendingProps=c=y,Qc(e,f))(e.flags&131072)!==0&&(Ce=!0);else return n.lanes=e.lanes,rn(e,n,f)}return Vc(e,n,r,c,f)}function Yf(e,n,r,c){var f=c.children,y=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((n.flags&128)!==0){if(y=y!==null?y.baseLanes|r:r,e!==null){for(c=n.child=e.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~y}else c=0,n.child=null;return Xf(e,n,y,r,c)}if((r&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&so(n,y!==null?y.cachePool:null),y!==null?$d(n,y):Ac(),Kd(n);else return c=n.lanes=536870912,Xf(e,n,y!==null?y.baseLanes|r:r,r,c)}else y!==null?(so(n,y.cachePool),$d(n,y),Rn(),n.memoizedState=null):(e!==null&&so(n,null),Ac(),Rn());return Fe(e,n,f,r),n.child}function Xa(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Xf(e,n,r,c,f){var y=gc();return y=y===null?null:{parent:we._currentValue,pool:y},n.memoizedState={baseLanes:r,cachePool:y},e!==null&&so(n,null),Ac(),Kd(n),e!==null&&Hs(e,n,c,!0),n.childLanes=f,null}function Ao(e,n){return n=wo({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function $f(e,n,r){return cs(n,e.child,null,r),e=Ao(n,n.pendingProps),e.flags|=2,hi(n),n.memoizedState=null,e}function Dy(e,n,r){var c=n.pendingProps,f=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Xt){if(c.mode==="hidden")return e=Ao(n,c),n.lanes=536870912,Xa(null,e);if(wc(n),(e=ce)?(e=rg(e,Ti),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:An!==null?{id:Pi,overflow:Ui}:null,retryLane:536870912,hydrationErrors:null},r=Dd(e),r.return=n,n.child=r,ze=n,ce=null)):e=null,e===null)throw wn(n);return n.lanes=536870912,null}return Ao(n,c)}var y=e.memoizedState;if(y!==null){var E=y.dehydrated;if(wc(n),f)if(n.flags&256)n.flags&=-257,n=$f(e,n,r);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(Ce||Hs(e,n,r,!1),f=(r&e.childLanes)!==0,Ce||f){if(c=oe,c!==null&&(E=Ih(c,r),E!==0&&E!==y.retryLane))throw y.retryLane=E,es(e,E),si(c,e,E),qc;ko(),n=$f(e,n,r)}else e=y.treeContext,ce=Mi(E.nextSibling),ze=n,Xt=!0,Sn=null,Ti=!1,e!==null&&Nd(n,e),n=Ao(n,c),n.flags|=4096;return n}return e=Ji(e.child,{mode:c.mode,children:c.children}),e.ref=n.ref,n.child=e,e.return=n,e}function So(e,n){var r=n.ref;if(r===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(e===null||e.ref!==r)&&(n.flags|=4194816)}}function Vc(e,n,r,c,f){return as(n),r=Cc(e,n,r,c,void 0,f),c=Tc(),e!==null&&!Ce?(xc(e,n,f),rn(e,n,f)):(Xt&&c&&rc(n),n.flags|=1,Fe(e,n,r,f),n.child)}function Kf(e,n,r,c,f,y){return as(n),n.updateQueue=null,r=Wd(n,c,r,f),Zd(e),c=Tc(),e!==null&&!Ce?(xc(e,n,y),rn(e,n,y)):(Xt&&c&&rc(n),n.flags|=1,Fe(e,n,r,y),n.child)}function Zf(e,n,r,c,f){if(as(n),n.stateNode===null){var y=Is,E=r.contextType;typeof E=="object"&&E!==null&&(y=Ie(E)),y=new r(c,y),n.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=jc,n.stateNode=y,y._reactInternals=n,y=n.stateNode,y.props=c,y.state=n.memoizedState,y.refs={},yc(n),E=r.contextType,y.context=typeof E=="object"&&E!==null?Ie(E):Is,y.state=n.memoizedState,E=r.getDerivedStateFromProps,typeof E=="function"&&(Hc(n,r,E,c),y.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(E=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),E!==y.state&&jc.enqueueReplaceState(y,y.state,null),ja(n,c,y,f),Ha(),y.state=n.memoizedState),typeof y.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(e===null){y=n.stateNode;var R=n.memoizedProps,P=hs(r,R);y.props=P;var K=y.context,lt=r.contextType;E=Is,typeof lt=="object"&&lt!==null&&(E=Ie(lt));var ht=r.getDerivedStateFromProps;lt=typeof ht=="function"||typeof y.getSnapshotBeforeUpdate=="function",R=n.pendingProps!==R,lt||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(R||K!==E)&&zf(n,y,c,E),Cn=!1;var Q=n.memoizedState;y.state=Q,ja(n,c,y,f),Ha(),K=n.memoizedState,R||Q!==K||Cn?(typeof ht=="function"&&(Hc(n,r,ht,c),K=n.memoizedState),(P=Cn||Bf(n,r,P,c,Q,K,E))?(lt||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(n.flags|=4194308)):(typeof y.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=K),y.props=c,y.state=K,y.context=E,c=P):(typeof y.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{y=n.stateNode,bc(e,n),E=n.memoizedProps,lt=hs(r,E),y.props=lt,ht=n.pendingProps,Q=y.context,K=r.contextType,P=Is,typeof K=="object"&&K!==null&&(P=Ie(K)),R=r.getDerivedStateFromProps,(K=typeof R=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E!==ht||Q!==P)&&zf(n,y,c,P),Cn=!1,Q=n.memoizedState,y.state=Q,ja(n,c,y,f),Ha();var nt=n.memoizedState;E!==ht||Q!==nt||Cn||e!==null&&e.dependencies!==null&&io(e.dependencies)?(typeof R=="function"&&(Hc(n,r,R,c),nt=n.memoizedState),(lt=Cn||Bf(n,r,lt,c,Q,nt,P)||e!==null&&e.dependencies!==null&&io(e.dependencies))?(K||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,nt,P),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,nt,P)),typeof y.componentDidUpdate=="function"&&(n.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof y.componentDidUpdate!="function"||E===e.memoizedProps&&Q===e.memoizedState||(n.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&Q===e.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=nt),y.props=c,y.state=nt,y.context=P,c=lt):(typeof y.componentDidUpdate!="function"||E===e.memoizedProps&&Q===e.memoizedState||(n.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&Q===e.memoizedState||(n.flags|=1024),c=!1)}return y=c,So(e,n),c=(n.flags&128)!==0,y||c?(y=n.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:y.render(),n.flags|=1,e!==null&&c?(n.child=cs(n,e.child,null,f),n.child=cs(n,null,r,f)):Fe(e,n,r,f),n.memoizedState=y.state,e=n.child):e=rn(e,n,f),e}function Wf(e,n,r,c){return ns(),n.flags|=256,Fe(e,n,r,c),n.child}var Yc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xc(e){return{baseLanes:e,cachePool:Pd()}}function $c(e,n,r){return e=e!==null?e.childLanes&~r:0,n&&(e|=fi),e}function Qf(e,n,r){var c=n.pendingProps,f=!1,y=(n.flags&128)!==0,E;if((E=y)||(E=e!==null&&e.memoizedState===null?!1:(_e.current&2)!==0),E&&(f=!0,n.flags&=-129),E=(n.flags&32)!==0,n.flags&=-33,e===null){if(Xt){if(f?Mn(n):Rn(),(e=ce)?(e=rg(e,Ti),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:An!==null?{id:Pi,overflow:Ui}:null,retryLane:536870912,hydrationErrors:null},r=Dd(e),r.return=n,n.child=r,ze=n,ce=null)):e=null,e===null)throw wn(n);return Du(e)?n.lanes=32:n.lanes=536870912,null}var R=c.children;return c=c.fallback,f?(Rn(),f=n.mode,R=wo({mode:"hidden",children:R},f),c=is(c,f,r,null),R.return=n,c.return=n,R.sibling=c,n.child=R,c=n.child,c.memoizedState=Xc(r),c.childLanes=$c(e,E,r),n.memoizedState=Yc,Xa(null,c)):(Mn(n),Kc(n,R))}var P=e.memoizedState;if(P!==null&&(R=P.dehydrated,R!==null)){if(y)n.flags&256?(Mn(n),n.flags&=-257,n=Zc(e,n,r)):n.memoizedState!==null?(Rn(),n.child=e.child,n.flags|=128,n=null):(Rn(),R=c.fallback,f=n.mode,c=wo({mode:"visible",children:c.children},f),R=is(R,f,r,null),R.flags|=2,c.return=n,R.return=n,c.sibling=R,n.child=c,cs(n,e.child,null,r),c=n.child,c.memoizedState=Xc(r),c.childLanes=$c(e,E,r),n.memoizedState=Yc,n=Xa(null,c));else if(Mn(n),Du(R)){if(E=R.nextSibling&&R.nextSibling.dataset,E)var K=E.dgst;E=K,c=Error(s(419)),c.stack="",c.digest=E,Ba({value:c,source:null,stack:null}),n=Zc(e,n,r)}else if(Ce||Hs(e,n,r,!1),E=(r&e.childLanes)!==0,Ce||E){if(E=oe,E!==null&&(c=Ih(E,r),c!==0&&c!==P.retryLane))throw P.retryLane=c,es(e,c),si(E,e,c),qc;Ru(R)||ko(),n=Zc(e,n,r)}else Ru(R)?(n.flags|=192,n.child=e.child,n=null):(e=P.treeContext,ce=Mi(R.nextSibling),ze=n,Xt=!0,Sn=null,Ti=!1,e!==null&&Nd(n,e),n=Kc(n,c.children),n.flags|=4096);return n}return f?(Rn(),R=c.fallback,f=n.mode,P=e.child,K=P.sibling,c=Ji(P,{mode:"hidden",children:c.children}),c.subtreeFlags=P.subtreeFlags&65011712,K!==null?R=Ji(K,R):(R=is(R,f,r,null),R.flags|=2),R.return=n,c.return=n,c.sibling=R,n.child=c,Xa(null,c),c=n.child,R=e.child.memoizedState,R===null?R=Xc(r):(f=R.cachePool,f!==null?(P=we._currentValue,f=f.parent!==P?{parent:P,pool:P}:f):f=Pd(),R={baseLanes:R.baseLanes|r,cachePool:f}),c.memoizedState=R,c.childLanes=$c(e,E,r),n.memoizedState=Yc,Xa(e.child,c)):(Mn(n),r=e.child,e=r.sibling,r=Ji(r,{mode:"visible",children:c.children}),r.return=n,r.sibling=null,e!==null&&(E=n.deletions,E===null?(n.deletions=[e],n.flags|=16):E.push(e)),n.child=r,n.memoizedState=null,r)}function Kc(e,n){return n=wo({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function wo(e,n){return e=ci(22,e,null,n),e.lanes=0,e}function Zc(e,n,r){return cs(n,e.child,null,r),e=Kc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Jf(e,n,r){e.lanes|=n;var c=e.alternate;c!==null&&(c.lanes|=n),hc(e.return,n,r)}function Wc(e,n,r,c,f,y){var E=e.memoizedState;E===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:f,treeForkCount:y}:(E.isBackwards=n,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=r,E.tailMode=f,E.treeForkCount=y)}function tp(e,n,r){var c=n.pendingProps,f=c.revealOrder,y=c.tail;c=c.children;var E=_e.current,R=(E&2)!==0;if(R?(E=E&1|2,n.flags|=128):E&=1,J(_e,E),Fe(e,n,c,r),c=Xt?La:0,!R&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Jf(e,r,n);else if(e.tag===19)Jf(e,r,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(r=n.child,f=null;r!==null;)e=r.alternate,e!==null&&uo(e)===null&&(f=r),r=r.sibling;r=f,r===null?(f=n.child,n.child=null):(f=r.sibling,r.sibling=null),Wc(n,!1,f,r,y,c);break;case"backwards":case"unstable_legacy-backwards":for(r=null,f=n.child,n.child=null;f!==null;){if(e=f.alternate,e!==null&&uo(e)===null){n.child=f;break}e=f.sibling,f.sibling=r,r=f,f=e}Wc(n,!0,r,null,y,c);break;case"together":Wc(n,!1,null,null,void 0,c);break;default:n.memoizedState=null}return n.child}function rn(e,n,r){if(e!==null&&(n.dependencies=e.dependencies),kn|=n.lanes,(r&n.childLanes)===0)if(e!==null){if(Hs(e,n,r,!1),(r&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,r=Ji(e,e.pendingProps),n.child=r,r.return=n;e.sibling!==null;)e=e.sibling,r=r.sibling=Ji(e,e.pendingProps),r.return=n;r.sibling=null}return n.child}function Qc(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&io(e)))}function Oy(e,n,r){switch(n.tag){case 3:Mt(n,n.stateNode.containerInfo),En(n,we,e.memoizedState.cache),ns();break;case 27:case 5:pt(n);break;case 4:Mt(n,n.stateNode.containerInfo);break;case 10:En(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,wc(n),null;break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(Mn(n),n.flags|=128,null):(r&n.child.childLanes)!==0?Qf(e,n,r):(Mn(n),e=rn(e,n,r),e!==null?e.sibling:null);Mn(n);break;case 19:var f=(e.flags&128)!==0;if(c=(r&n.childLanes)!==0,c||(Hs(e,n,r,!1),c=(r&n.childLanes)!==0),f){if(c)return tp(e,n,r);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),J(_e,_e.current),c)break;return null;case 22:return n.lanes=0,Yf(e,n,r,n.pendingProps);case 24:En(n,we,e.memoizedState.cache)}return rn(e,n,r)}function ep(e,n,r){if(e!==null)if(e.memoizedProps!==n.pendingProps)Ce=!0;else{if(!Qc(e,r)&&(n.flags&128)===0)return Ce=!1,Oy(e,n,r);Ce=(e.flags&131072)!==0}else Ce=!1,Xt&&(n.flags&1048576)!==0&&kd(n,La,n.index);switch(n.lanes=0,n.tag){case 16:t:{var c=n.pendingProps;if(e=os(n.elementType),n.type=e,typeof e=="function")nc(e)?(c=hs(e,c),n.tag=1,n=Zf(null,n,e,c,r)):(n.tag=0,n=Vc(null,n,e,c,r));else{if(e!=null){var f=e.$$typeof;if(f===k){n.tag=11,n=Gf(null,n,e,c,r);break t}else if(f===L){n.tag=14,n=qf(null,n,e,c,r);break t}}throw n=x(e)||e,Error(s(306,n,""))}}return n;case 0:return Vc(e,n,n.type,n.pendingProps,r);case 1:return c=n.type,f=hs(c,n.pendingProps),Zf(e,n,c,f,r);case 3:t:{if(Mt(n,n.stateNode.containerInfo),e===null)throw Error(s(387));c=n.pendingProps;var y=n.memoizedState;f=y.element,bc(e,n),ja(n,c,null,r);var E=n.memoizedState;if(c=E.cache,En(n,we,c),c!==y.cache&&dc(n,[we],r,!0),Ha(),c=E.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:E.cache},n.updateQueue.baseState=y,n.memoizedState=y,n.flags&256){n=Wf(e,n,c,r);break t}else if(c!==f){f=wi(Error(s(424)),n),Ba(f),n=Wf(e,n,c,r);break t}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ce=Mi(e.firstChild),ze=n,Xt=!0,Sn=null,Ti=!0,r=Vd(n,null,c,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(ns(),c===f){n=rn(e,n,r);break t}Fe(e,n,c,r)}n=n.child}return n;case 26:return So(e,n),e===null?(r=dg(n.type,null,n.pendingProps,null))?n.memoizedState=r:Xt||(r=n.type,e=n.pendingProps,c=Po(At.current).createElement(r),c[Be]=n,c[Qe]=e,Pe(c,r,e),ke(c),n.stateNode=c):n.memoizedState=dg(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return pt(n),e===null&&Xt&&(c=n.stateNode=cg(n.type,n.pendingProps,At.current),ze=n,Ti=!0,f=ce,In(n.type)?(Ou=f,ce=Mi(c.firstChild)):ce=f),Fe(e,n,n.pendingProps.children,r),So(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Xt&&((f=c=ce)&&(c=ob(c,n.type,n.pendingProps,Ti),c!==null?(n.stateNode=c,ze=n,ce=Mi(c.firstChild),Ti=!1,f=!0):f=!1),f||wn(n)),pt(n),f=n.type,y=n.pendingProps,E=e!==null?e.memoizedProps:null,c=y.children,Tu(f,y)?c=null:E!==null&&Tu(f,E)&&(n.flags|=32),n.memoizedState!==null&&(f=Cc(e,n,Sy,null,null,r),lr._currentValue=f),So(e,n),Fe(e,n,c,r),n.child;case 6:return e===null&&Xt&&((e=r=ce)&&(r=lb(r,n.pendingProps,Ti),r!==null?(n.stateNode=r,ze=n,ce=null,e=!0):e=!1),e||wn(n)),null;case 13:return Qf(e,n,r);case 4:return Mt(n,n.stateNode.containerInfo),c=n.pendingProps,e===null?n.child=cs(n,null,c,r):Fe(e,n,c,r),n.child;case 11:return Gf(e,n,n.type,n.pendingProps,r);case 7:return Fe(e,n,n.pendingProps,r),n.child;case 8:return Fe(e,n,n.pendingProps.children,r),n.child;case 12:return Fe(e,n,n.pendingProps.children,r),n.child;case 10:return c=n.pendingProps,En(n,n.type,c.value),Fe(e,n,c.children,r),n.child;case 9:return f=n.type._context,c=n.pendingProps.children,as(n),f=Ie(f),c=c(f),n.flags|=1,Fe(e,n,c,r),n.child;case 14:return qf(e,n,n.type,n.pendingProps,r);case 15:return Vf(e,n,n.type,n.pendingProps,r);case 19:return tp(e,n,r);case 31:return Dy(e,n,r);case 22:return Yf(e,n,r,n.pendingProps);case 24:return as(n),c=Ie(we),e===null?(f=gc(),f===null&&(f=oe,y=fc(),f.pooledCache=y,y.refCount++,y!==null&&(f.pooledCacheLanes|=r),f=y),n.memoizedState={parent:c,cache:f},yc(n),En(n,we,f)):((e.lanes&r)!==0&&(bc(e,n),ja(n,null,null,r),Ha()),f=e.memoizedState,y=n.memoizedState,f.parent!==c?(f={parent:c,cache:c},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),En(n,we,c)):(c=y.cache,En(n,we,c),c!==f.cache&&dc(n,[we],r,!0))),Fe(e,n,n.pendingProps.children,r),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function on(e){e.flags|=4}function Jc(e,n,r,c,f){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(Mp())e.flags|=8192;else throw ls=ro,mc}else e.flags&=-16777217}function ip(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!yg(n))if(Mp())e.flags|=8192;else throw ls=ro,mc}function Eo(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Lh():536870912,e.lanes|=n,Js|=n)}function $a(e,n){if(!Xt)switch(e.tailMode){case"hidden":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function ue(e){var n=e.alternate!==null&&e.alternate.child===e.child,r=0,c=0;if(n)for(var f=e.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=c,e.childLanes=r,n}function ky(e,n,r){var c=n.pendingProps;switch(oc(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ue(n),null;case 1:return ue(n),null;case 3:return r=n.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),nn(we),xt(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Us(n)?on(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,cc())),ue(n),null;case 26:var f=n.type,y=n.memoizedState;return e===null?(on(n),y!==null?(ue(n),ip(n,y)):(ue(n),Jc(n,f,null,c,r))):y?y!==e.memoizedState?(on(n),ue(n),ip(n,y)):(ue(n),n.flags&=-16777217):(e=e.memoizedProps,e!==c&&on(n),ue(n),Jc(n,f,e,c,r)),null;case 27:if(_t(n),r=At.current,f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&on(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return ue(n),null}e=it.current,Us(n)?Ld(n):(e=cg(f,c,r),n.stateNode=e,on(n))}return ue(n),null;case 5:if(_t(n),f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&on(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return ue(n),null}if(y=it.current,Us(n))Ld(n);else{var E=Po(At.current);switch(y){case 1:y=E.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:y=E.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":y=E.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":y=E.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":y=E.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?E.createElement(f,{is:c.is}):E.createElement(f)}}y[Be]=n,y[Qe]=c;t:for(E=n.child;E!==null;){if(E.tag===5||E.tag===6)y.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===n)break t;for(;E.sibling===null;){if(E.return===null||E.return===n)break t;E=E.return}E.sibling.return=E.return,E=E.sibling}n.stateNode=y;t:switch(Pe(y,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}c&&on(n)}}return ue(n),Jc(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,r),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==c&&on(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(e=At.current,Us(n)){if(e=n.stateNode,r=n.memoizedProps,c=null,f=ze,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}e[Be]=n,e=!!(e.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||Qp(e.nodeValue,r)),e||wn(n,!0)}else e=Po(e).createTextNode(c),e[Be]=n,n.stateNode=e}return ue(n),null;case 31:if(r=n.memoizedState,e===null||e.memoizedState!==null){if(c=Us(n),r!==null){if(e===null){if(!c)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[Be]=n}else ns(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;ue(n),e=!1}else r=cc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return n.flags&256?(hi(n),n):(hi(n),null);if((n.flags&128)!==0)throw Error(s(558))}return ue(n),null;case 13:if(c=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=Us(n),c!==null&&c.dehydrated!==null){if(e===null){if(!f)throw Error(s(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(s(317));f[Be]=n}else ns(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;ue(n),f=!1}else f=cc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return n.flags&256?(hi(n),n):(hi(n),null)}return hi(n),(n.flags&128)!==0?(n.lanes=r,n):(r=c!==null,e=e!==null&&e.memoizedState!==null,r&&(c=n.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==f&&(c.flags|=2048)),r!==e&&r&&(n.child.flags|=8192),Eo(n,n.updateQueue),ue(n),null);case 4:return xt(),e===null&&Au(n.stateNode.containerInfo),ue(n),null;case 10:return nn(n.type),ue(n),null;case 19:if(B(_e),c=n.memoizedState,c===null)return ue(n),null;if(f=(n.flags&128)!==0,y=c.rendering,y===null)if(f)$a(c,!1);else{if(be!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(y=uo(e),y!==null){for(n.flags|=128,$a(c,!1),e=y.updateQueue,n.updateQueue=e,Eo(n,e),n.subtreeFlags=0,e=r,r=n.child;r!==null;)Rd(r,e),r=r.sibling;return J(_e,_e.current&1|2),Xt&&tn(n,c.treeForkCount),n.child}e=e.sibling}c.tail!==null&&bt()>Ro&&(n.flags|=128,f=!0,$a(c,!1),n.lanes=4194304)}else{if(!f)if(e=uo(y),e!==null){if(n.flags|=128,f=!0,e=e.updateQueue,n.updateQueue=e,Eo(n,e),$a(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!Xt)return ue(n),null}else 2*bt()-c.renderingStartTime>Ro&&r!==536870912&&(n.flags|=128,f=!0,$a(c,!1),n.lanes=4194304);c.isBackwards?(y.sibling=n.child,n.child=y):(e=c.last,e!==null?e.sibling=y:n.child=y,c.last=y)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=bt(),e.sibling=null,r=_e.current,J(_e,f?r&1|2:r&1),Xt&&tn(n,c.treeForkCount),e):(ue(n),null);case 22:case 23:return hi(n),Sc(),c=n.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(r&536870912)!==0&&(n.flags&128)===0&&(ue(n),n.subtreeFlags&6&&(n.flags|=8192)):ue(n),r=n.updateQueue,r!==null&&Eo(n,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==r&&(n.flags|=2048),e!==null&&B(rs),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),nn(we),ue(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function Ny(e,n){switch(oc(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return nn(we),xt(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return _t(n),null;case 31:if(n.memoizedState!==null){if(hi(n),n.alternate===null)throw Error(s(340));ns()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(hi(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));ns()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return B(_e),null;case 4:return xt(),null;case 10:return nn(n.type),null;case 22:case 23:return hi(n),Sc(),e!==null&&B(rs),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return nn(we),null;case 25:return null;default:return null}}function np(e,n){switch(oc(n),n.tag){case 3:nn(we),xt();break;case 26:case 27:case 5:_t(n);break;case 4:xt();break;case 31:n.memoizedState!==null&&hi(n);break;case 13:hi(n);break;case 19:B(_e);break;case 10:nn(n.type);break;case 22:case 23:hi(n),Sc(),e!==null&&B(rs);break;case 24:nn(we)}}function Ka(e,n){try{var r=n.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var f=c.next;r=f;do{if((r.tag&e)===e){c=void 0;var y=r.create,E=r.inst;c=y(),E.destroy=c}r=r.next}while(r!==f)}}catch(R){ee(n,n.return,R)}}function Dn(e,n,r){try{var c=n.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var y=f.next;c=y;do{if((c.tag&e)===e){var E=c.inst,R=E.destroy;if(R!==void 0){E.destroy=void 0,f=n;var P=r,K=R;try{K()}catch(lt){ee(f,P,lt)}}}c=c.next}while(c!==y)}}catch(lt){ee(n,n.return,lt)}}function sp(e){var n=e.updateQueue;if(n!==null){var r=e.stateNode;try{Xd(n,r)}catch(c){ee(e,e.return,c)}}}function ap(e,n,r){r.props=hs(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(c){ee(e,n,c)}}function Za(e,n){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof r=="function"?e.refCleanup=r(c):r.current=c}}catch(f){ee(e,n,f)}}function Hi(e,n){var r=e.ref,c=e.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(f){ee(e,n,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){ee(e,n,f)}else r.current=null}function rp(e){var n=e.type,r=e.memoizedProps,c=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break t;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(f){ee(e,e.return,f)}}function tu(e,n,r){try{var c=e.stateNode;eb(c,e.type,r,n),c[Qe]=n}catch(f){ee(e,e.return,f)}}function op(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&In(e.type)||e.tag===4}function eu(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||op(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&In(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function iu(e,n,r){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,n):(n=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,n.appendChild(e),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Wi));else if(c!==4&&(c===27&&In(e.type)&&(r=e.stateNode,n=null),e=e.child,e!==null))for(iu(e,n,r),e=e.sibling;e!==null;)iu(e,n,r),e=e.sibling}function Co(e,n,r){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?r.insertBefore(e,n):r.appendChild(e);else if(c!==4&&(c===27&&In(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(Co(e,n,r),e=e.sibling;e!==null;)Co(e,n,r),e=e.sibling}function lp(e){var n=e.stateNode,r=e.memoizedProps;try{for(var c=e.type,f=n.attributes;f.length;)n.removeAttributeNode(f[0]);Pe(n,c,r),n[Be]=e,n[Qe]=r}catch(y){ee(e,e.return,y)}}var ln=!1,Te=!1,nu=!1,cp=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Ly(e,n){if(e=e.containerInfo,Eu=Yo,e=_d(e),Zl(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else t:{r=(r=e.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var f=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{r.nodeType,y.nodeType}catch{r=null;break t}var E=0,R=-1,P=-1,K=0,lt=0,ht=e,Q=null;e:for(;;){for(var nt;ht!==r||f!==0&&ht.nodeType!==3||(R=E+f),ht!==y||c!==0&&ht.nodeType!==3||(P=E+c),ht.nodeType===3&&(E+=ht.nodeValue.length),(nt=ht.firstChild)!==null;)Q=ht,ht=nt;for(;;){if(ht===e)break e;if(Q===r&&++K===f&&(R=E),Q===y&&++lt===c&&(P=E),(nt=ht.nextSibling)!==null)break;ht=Q,Q=ht.parentNode}ht=nt}r=R===-1||P===-1?null:{start:R,end:P}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cu={focusedElem:e,selectionRange:r},Yo=!1,Ne=n;Ne!==null;)if(n=Ne,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Ne=e;else for(;Ne!==null;){switch(n=Ne,y=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)f=e[r],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&y!==null){e=void 0,r=n,f=y.memoizedProps,y=y.memoizedState,c=r.stateNode;try{var Et=hs(r.type,f);e=c.getSnapshotBeforeUpdate(Et,y),c.__reactInternalSnapshotBeforeUpdate=e}catch(kt){ee(r,r.return,kt)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,r=e.nodeType,r===9)Mu(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Mu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,Ne=e;break}Ne=n.return}}function up(e,n,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:un(e,r),c&4&&Ka(5,r);break;case 1:if(un(e,r),c&4)if(e=r.stateNode,n===null)try{e.componentDidMount()}catch(E){ee(r,r.return,E)}else{var f=hs(r.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(f,n,e.__reactInternalSnapshotBeforeUpdate)}catch(E){ee(r,r.return,E)}}c&64&&sp(r),c&512&&Za(r,r.return);break;case 3:if(un(e,r),c&64&&(e=r.updateQueue,e!==null)){if(n=null,r.child!==null)switch(r.child.tag){case 27:case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}try{Xd(e,n)}catch(E){ee(r,r.return,E)}}break;case 27:n===null&&c&4&&lp(r);case 26:case 5:un(e,r),n===null&&c&4&&rp(r),c&512&&Za(r,r.return);break;case 12:un(e,r);break;case 31:un(e,r),c&4&&fp(e,r);break;case 13:un(e,r),c&4&&pp(e,r),c&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=Gy.bind(null,r),cb(e,r))));break;case 22:if(c=r.memoizedState!==null||ln,!c){n=n!==null&&n.memoizedState!==null||Te,f=ln;var y=Te;ln=c,(Te=n)&&!y?hn(e,r,(r.subtreeFlags&8772)!==0):un(e,r),ln=f,Te=y}break;case 30:break;default:un(e,r)}}function hp(e){var n=e.alternate;n!==null&&(e.alternate=null,hp(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&Nl(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var he=null,ti=!1;function cn(e,n,r){for(r=r.child;r!==null;)dp(e,n,r),r=r.sibling}function dp(e,n,r){if(Oe&&typeof Oe.onCommitFiberUnmount=="function")try{Oe.onCommitFiberUnmount(re,r)}catch{}switch(r.tag){case 26:Te||Hi(r,n),cn(e,n,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Te||Hi(r,n);var c=he,f=ti;In(r.type)&&(he=r.stateNode,ti=!1),cn(e,n,r),ar(r.stateNode),he=c,ti=f;break;case 5:Te||Hi(r,n);case 6:if(c=he,f=ti,he=null,cn(e,n,r),he=c,ti=f,he!==null)if(ti)try{(he.nodeType===9?he.body:he.nodeName==="HTML"?he.ownerDocument.body:he).removeChild(r.stateNode)}catch(y){ee(r,n,y)}else try{he.removeChild(r.stateNode)}catch(y){ee(r,n,y)}break;case 18:he!==null&&(ti?(e=he,sg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),oa(e)):sg(he,r.stateNode));break;case 4:c=he,f=ti,he=r.stateNode.containerInfo,ti=!0,cn(e,n,r),he=c,ti=f;break;case 0:case 11:case 14:case 15:Dn(2,r,n),Te||Dn(4,r,n),cn(e,n,r);break;case 1:Te||(Hi(r,n),c=r.stateNode,typeof c.componentWillUnmount=="function"&&ap(r,n,c)),cn(e,n,r);break;case 21:cn(e,n,r);break;case 22:Te=(c=Te)||r.memoizedState!==null,cn(e,n,r),Te=c;break;default:cn(e,n,r)}}function fp(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{oa(e)}catch(r){ee(n,n.return,r)}}}function pp(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{oa(e)}catch(r){ee(n,n.return,r)}}function By(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new cp),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new cp),n;default:throw Error(s(435,e.tag))}}function To(e,n){var r=By(e);n.forEach(function(c){if(!r.has(c)){r.add(c);var f=qy.bind(null,e,c);c.then(f,f)}})}function ei(e,n){var r=n.deletions;if(r!==null)for(var c=0;c<r.length;c++){var f=r[c],y=e,E=n,R=E;t:for(;R!==null;){switch(R.tag){case 27:if(In(R.type)){he=R.stateNode,ti=!1;break t}break;case 5:he=R.stateNode,ti=!1;break t;case 3:case 4:he=R.stateNode.containerInfo,ti=!0;break t}R=R.return}if(he===null)throw Error(s(160));dp(y,E,f),he=null,ti=!1,y=f.alternate,y!==null&&(y.return=null),f.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)gp(n,e),n=n.sibling}var Bi=null;function gp(e,n){var r=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ei(n,e),ii(e),c&4&&(Dn(3,e,e.return),Ka(3,e),Dn(5,e,e.return));break;case 1:ei(n,e),ii(e),c&512&&(Te||r===null||Hi(r,r.return)),c&64&&ln&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var f=Bi;if(ei(n,e),ii(e),c&512&&(Te||r===null||Hi(r,r.return)),c&4){var y=r!==null?r.memoizedState:null;if(c=e.memoizedState,r===null)if(c===null)if(e.stateNode===null){t:{c=e.type,r=e.memoizedProps,f=f.ownerDocument||f;e:switch(c){case"title":y=f.getElementsByTagName("title")[0],(!y||y[wa]||y[Be]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=f.createElement(c),f.head.insertBefore(y,f.querySelector("head > title"))),Pe(y,c,r),y[Be]=e,ke(y),c=y;break t;case"link":var E=gg("link","href",f).get(c+(r.href||""));if(E){for(var R=0;R<E.length;R++)if(y=E[R],y.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&y.getAttribute("rel")===(r.rel==null?null:r.rel)&&y.getAttribute("title")===(r.title==null?null:r.title)&&y.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){E.splice(R,1);break e}}y=f.createElement(c),Pe(y,c,r),f.head.appendChild(y);break;case"meta":if(E=gg("meta","content",f).get(c+(r.content||""))){for(R=0;R<E.length;R++)if(y=E[R],y.getAttribute("content")===(r.content==null?null:""+r.content)&&y.getAttribute("name")===(r.name==null?null:r.name)&&y.getAttribute("property")===(r.property==null?null:r.property)&&y.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&y.getAttribute("charset")===(r.charSet==null?null:r.charSet)){E.splice(R,1);break e}}y=f.createElement(c),Pe(y,c,r),f.head.appendChild(y);break;default:throw Error(s(468,c))}y[Be]=e,ke(y),c=y}e.stateNode=c}else mg(f,e.type,e.stateNode);else e.stateNode=pg(f,c,e.memoizedProps);else y!==c?(y===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):y.count--,c===null?mg(f,e.type,e.stateNode):pg(f,c,e.memoizedProps)):c===null&&e.stateNode!==null&&tu(e,e.memoizedProps,r.memoizedProps)}break;case 27:ei(n,e),ii(e),c&512&&(Te||r===null||Hi(r,r.return)),r!==null&&c&4&&tu(e,e.memoizedProps,r.memoizedProps);break;case 5:if(ei(n,e),ii(e),c&512&&(Te||r===null||Hi(r,r.return)),e.flags&32){f=e.stateNode;try{Ds(f,"")}catch(Et){ee(e,e.return,Et)}}c&4&&e.stateNode!=null&&(f=e.memoizedProps,tu(e,f,r!==null?r.memoizedProps:f)),c&1024&&(nu=!0);break;case 6:if(ei(n,e),ii(e),c&4){if(e.stateNode===null)throw Error(s(162));c=e.memoizedProps,r=e.stateNode;try{r.nodeValue=c}catch(Et){ee(e,e.return,Et)}}break;case 3:if(jo=null,f=Bi,Bi=Uo(n.containerInfo),ei(n,e),Bi=f,ii(e),c&4&&r!==null&&r.memoizedState.isDehydrated)try{oa(n.containerInfo)}catch(Et){ee(e,e.return,Et)}nu&&(nu=!1,mp(e));break;case 4:c=Bi,Bi=Uo(e.stateNode.containerInfo),ei(n,e),ii(e),Bi=c;break;case 12:ei(n,e),ii(e);break;case 31:ei(n,e),ii(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,To(e,c)));break;case 13:ei(n,e),ii(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Mo=bt()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,To(e,c)));break;case 22:f=e.memoizedState!==null;var P=r!==null&&r.memoizedState!==null,K=ln,lt=Te;if(ln=K||f,Te=lt||P,ei(n,e),Te=lt,ln=K,ii(e),c&8192)t:for(n=e.stateNode,n._visibility=f?n._visibility&-2:n._visibility|1,f&&(r===null||P||ln||Te||ds(e)),r=null,n=e;;){if(n.tag===5||n.tag===26){if(r===null){P=r=n;try{if(y=P.stateNode,f)E=y.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{R=P.stateNode;var ht=P.memoizedProps.style,Q=ht!=null&&ht.hasOwnProperty("display")?ht.display:null;R.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(Et){ee(P,P.return,Et)}}}else if(n.tag===6){if(r===null){P=n;try{P.stateNode.nodeValue=f?"":P.memoizedProps}catch(Et){ee(P,P.return,Et)}}}else if(n.tag===18){if(r===null){P=n;try{var nt=P.stateNode;f?ag(nt,!0):ag(P.stateNode,!1)}catch(Et){ee(P,P.return,Et)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;r===n&&(r=null),n=n.return}r===n&&(r=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=e.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,To(e,r))));break;case 19:ei(n,e),ii(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,To(e,c)));break;case 30:break;case 21:break;default:ei(n,e),ii(e)}}function ii(e){var n=e.flags;if(n&2){try{for(var r,c=e.return;c!==null;){if(op(c)){r=c;break}c=c.return}if(r==null)throw Error(s(160));switch(r.tag){case 27:var f=r.stateNode,y=eu(e);Co(e,y,f);break;case 5:var E=r.stateNode;r.flags&32&&(Ds(E,""),r.flags&=-33);var R=eu(e);Co(e,R,E);break;case 3:case 4:var P=r.stateNode.containerInfo,K=eu(e);iu(e,K,P);break;default:throw Error(s(161))}}catch(lt){ee(e,e.return,lt)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function mp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;mp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function un(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)up(e,n.alternate,n),n=n.sibling}function ds(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Dn(4,n,n.return),ds(n);break;case 1:Hi(n,n.return);var r=n.stateNode;typeof r.componentWillUnmount=="function"&&ap(n,n.return,r),ds(n);break;case 27:ar(n.stateNode);case 26:case 5:Hi(n,n.return),ds(n);break;case 22:n.memoizedState===null&&ds(n);break;case 30:ds(n);break;default:ds(n)}e=e.sibling}}function hn(e,n,r){for(r=r&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,f=e,y=n,E=y.flags;switch(y.tag){case 0:case 11:case 15:hn(f,y,r),Ka(4,y);break;case 1:if(hn(f,y,r),c=y,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(K){ee(c,c.return,K)}if(c=y,f=c.updateQueue,f!==null){var R=c.stateNode;try{var P=f.shared.hiddenCallbacks;if(P!==null)for(f.shared.hiddenCallbacks=null,f=0;f<P.length;f++)Yd(P[f],R)}catch(K){ee(c,c.return,K)}}r&&E&64&&sp(y),Za(y,y.return);break;case 27:lp(y);case 26:case 5:hn(f,y,r),r&&c===null&&E&4&&rp(y),Za(y,y.return);break;case 12:hn(f,y,r);break;case 31:hn(f,y,r),r&&E&4&&fp(f,y);break;case 13:hn(f,y,r),r&&E&4&&pp(f,y);break;case 22:y.memoizedState===null&&hn(f,y,r),Za(y,y.return);break;case 30:break;default:hn(f,y,r)}n=n.sibling}}function su(e,n){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&za(r))}function au(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&za(e))}function zi(e,n,r,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)yp(e,n,r,c),n=n.sibling}function yp(e,n,r,c){var f=n.flags;switch(n.tag){case 0:case 11:case 15:zi(e,n,r,c),f&2048&&Ka(9,n);break;case 1:zi(e,n,r,c);break;case 3:zi(e,n,r,c),f&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&za(e)));break;case 12:if(f&2048){zi(e,n,r,c),e=n.stateNode;try{var y=n.memoizedProps,E=y.id,R=y.onPostCommit;typeof R=="function"&&R(E,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(P){ee(n,n.return,P)}}else zi(e,n,r,c);break;case 31:zi(e,n,r,c);break;case 13:zi(e,n,r,c);break;case 23:break;case 22:y=n.stateNode,E=n.alternate,n.memoizedState!==null?y._visibility&2?zi(e,n,r,c):Wa(e,n):y._visibility&2?zi(e,n,r,c):(y._visibility|=2,Zs(e,n,r,c,(n.subtreeFlags&10256)!==0||!1)),f&2048&&su(E,n);break;case 24:zi(e,n,r,c),f&2048&&au(n.alternate,n);break;default:zi(e,n,r,c)}}function Zs(e,n,r,c,f){for(f=f&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var y=e,E=n,R=r,P=c,K=E.flags;switch(E.tag){case 0:case 11:case 15:Zs(y,E,R,P,f),Ka(8,E);break;case 23:break;case 22:var lt=E.stateNode;E.memoizedState!==null?lt._visibility&2?Zs(y,E,R,P,f):Wa(y,E):(lt._visibility|=2,Zs(y,E,R,P,f)),f&&K&2048&&su(E.alternate,E);break;case 24:Zs(y,E,R,P,f),f&&K&2048&&au(E.alternate,E);break;default:Zs(y,E,R,P,f)}n=n.sibling}}function Wa(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var r=e,c=n,f=c.flags;switch(c.tag){case 22:Wa(r,c),f&2048&&su(c.alternate,c);break;case 24:Wa(r,c),f&2048&&au(c.alternate,c);break;default:Wa(r,c)}n=n.sibling}}var Qa=8192;function Ws(e,n,r){if(e.subtreeFlags&Qa)for(e=e.child;e!==null;)bp(e,n,r),e=e.sibling}function bp(e,n,r){switch(e.tag){case 26:Ws(e,n,r),e.flags&Qa&&e.memoizedState!==null&&Ab(r,Bi,e.memoizedState,e.memoizedProps);break;case 5:Ws(e,n,r);break;case 3:case 4:var c=Bi;Bi=Uo(e.stateNode.containerInfo),Ws(e,n,r),Bi=c;break;case 22:e.memoizedState===null&&(c=e.alternate,c!==null&&c.memoizedState!==null?(c=Qa,Qa=16777216,Ws(e,n,r),Qa=c):Ws(e,n,r));break;default:Ws(e,n,r)}}function vp(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Ja(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];Ne=c,Ap(c,e)}vp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)_p(e),e=e.sibling}function _p(e){switch(e.tag){case 0:case 11:case 15:Ja(e),e.flags&2048&&Dn(9,e,e.return);break;case 3:Ja(e);break;case 12:Ja(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,xo(e)):Ja(e);break;default:Ja(e)}}function xo(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];Ne=c,Ap(c,e)}vp(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Dn(8,n,n.return),xo(n);break;case 22:r=n.stateNode,r._visibility&2&&(r._visibility&=-3,xo(n));break;default:xo(n)}e=e.sibling}}function Ap(e,n){for(;Ne!==null;){var r=Ne;switch(r.tag){case 0:case 11:case 15:Dn(8,r,n);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:za(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,Ne=c;else t:for(r=e;Ne!==null;){c=Ne;var f=c.sibling,y=c.return;if(hp(c),c===r){Ne=null;break t}if(f!==null){f.return=y,Ne=f;break t}Ne=y}}}var zy={getCacheForType:function(e){var n=Ie(we),r=n.data.get(e);return r===void 0&&(r=e(),n.data.set(e,r)),r},cacheSignal:function(){return Ie(we).controller.signal}},Iy=typeof WeakMap=="function"?WeakMap:Map,Qt=0,oe=null,Gt=null,Vt=0,te=0,di=null,On=!1,Qs=!1,ru=!1,dn=0,be=0,kn=0,fs=0,ou=0,fi=0,Js=0,tr=null,ni=null,lu=!1,Mo=0,Sp=0,Ro=1/0,Do=null,Nn=null,Re=0,Ln=null,ta=null,fn=0,cu=0,uu=null,wp=null,er=0,hu=null;function pi(){return(Qt&2)!==0&&Vt!==0?Vt&-Vt:U.T!==null?yu():Fh()}function Ep(){if(fi===0)if((Vt&536870912)===0||Xt){var e=Zn;Zn<<=1,(Zn&3932160)===0&&(Zn=262144),fi=e}else fi=536870912;return e=ui.current,e!==null&&(e.flags|=32),fi}function si(e,n,r){(e===oe&&(te===2||te===9)||e.cancelPendingCommit!==null)&&(ea(e,0),Bn(e,Vt,fi,!1)),Sa(e,r),((Qt&2)===0||e!==oe)&&(e===oe&&((Qt&2)===0&&(fs|=r),be===4&&Bn(e,Vt,fi,!1)),ji(e))}function Cp(e,n,r){if((Qt&6)!==0)throw Error(s(327));var c=!r&&(n&127)===0&&(n&e.expiredLanes)===0||Aa(e,n),f=c?Uy(e,n):fu(e,n,!0),y=c;do{if(f===0){Qs&&!c&&Bn(e,n,0,!1);break}else{if(r=e.current.alternate,y&&!Fy(r)){f=fu(e,n,!1),y=!1;continue}if(f===2){if(y=n,e.errorRecoveryDisabledLanes&y)var E=0;else E=e.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){n=E;t:{var R=e;f=tr;var P=R.current.memoizedState.isDehydrated;if(P&&(ea(R,E).flags|=256),E=fu(R,E,!1),E!==2){if(ru&&!P){R.errorRecoveryDisabledLanes|=y,fs|=y,f=4;break t}y=ni,ni=f,y!==null&&(ni===null?ni=y:ni.push.apply(ni,y))}f=E}if(y=!1,f!==2)continue}}if(f===1){ea(e,0),Bn(e,n,0,!0);break}t:{switch(c=e,y=f,y){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Bn(c,n,fi,!On);break t;case 2:ni=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(f=Mo+300-bt(),10<f)){if(Bn(c,n,fi,!On),Pr(c,0,!0)!==0)break t;fn=n,c.timeoutHandle=ig(Tp.bind(null,c,r,ni,Do,lu,n,fi,fs,Js,On,y,"Throttled",-0,0),f);break t}Tp(c,r,ni,Do,lu,n,fi,fs,Js,On,y,null,-0,0)}}break}while(!0);ji(e)}function Tp(e,n,r,c,f,y,E,R,P,K,lt,ht,Q,nt){if(e.timeoutHandle=-1,ht=n.subtreeFlags,ht&8192||(ht&16785408)===16785408){ht={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Wi},bp(n,y,ht);var Et=(y&62914560)===y?Mo-bt():(y&4194048)===y?Sp-bt():0;if(Et=Sb(ht,Et),Et!==null){fn=y,e.cancelPendingCommit=Et(Lp.bind(null,e,n,y,r,c,f,E,R,P,lt,ht,null,Q,nt)),Bn(e,y,E,!K);return}}Lp(e,n,y,r,c,f,E,R,P)}function Fy(e){for(var n=e;;){var r=n.tag;if((r===0||r===11||r===15)&&n.flags&16384&&(r=n.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var f=r[c],y=f.getSnapshot;f=f.value;try{if(!li(y(),f))return!1}catch{return!1}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Bn(e,n,r,c){n&=~ou,n&=~fs,e.suspendedLanes|=n,e.pingedLanes&=~n,c&&(e.warmLanes|=n),c=e.expirationTimes;for(var f=n;0<f;){var y=31-pe(f),E=1<<y;c[y]=-1,f&=~E}r!==0&&Bh(e,r,n)}function Oo(){return(Qt&6)===0?(ir(0),!1):!0}function du(){if(Gt!==null){if(te===0)var e=Gt.return;else e=Gt,en=ss=null,Mc(e),Vs=null,Fa=0,e=Gt;for(;e!==null;)np(e.alternate,e),e=e.return;Gt=null}}function ea(e,n){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,sb(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),fn=0,du(),oe=e,Gt=r=Ji(e.current,null),Vt=n,te=0,di=null,On=!1,Qs=Aa(e,n),ru=!1,Js=fi=ou=fs=kn=be=0,ni=tr=null,lu=!1,(n&8)!==0&&(n|=n&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=n;0<c;){var f=31-pe(c),y=1<<f;n|=e[f],c&=~y}return dn=n,Wr(),r}function xp(e,n){Ft=null,U.H=Ya,n===qs||n===ao?(n=jd(),te=3):n===mc?(n=jd(),te=4):te=n===qc?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,di=n,Gt===null&&(be=1,_o(e,wi(n,e.current)))}function Mp(){var e=ui.current;return e===null?!0:(Vt&4194048)===Vt?xi===null:(Vt&62914560)===Vt||(Vt&536870912)!==0?e===xi:!1}function Rp(){var e=U.H;return U.H=Ya,e===null?Ya:e}function Dp(){var e=U.A;return U.A=zy,e}function ko(){be=4,On||(Vt&4194048)!==Vt&&ui.current!==null||(Qs=!0),(kn&134217727)===0&&(fs&134217727)===0||oe===null||Bn(oe,Vt,fi,!1)}function fu(e,n,r){var c=Qt;Qt|=2;var f=Rp(),y=Dp();(oe!==e||Vt!==n)&&(Do=null,ea(e,n)),n=!1;var E=be;t:do try{if(te!==0&&Gt!==null){var R=Gt,P=di;switch(te){case 8:du(),E=6;break t;case 3:case 2:case 9:case 6:ui.current===null&&(n=!0);var K=te;if(te=0,di=null,ia(e,R,P,K),r&&Qs){E=0;break t}break;default:K=te,te=0,di=null,ia(e,R,P,K)}}Py(),E=be;break}catch(lt){xp(e,lt)}while(!0);return n&&e.shellSuspendCounter++,en=ss=null,Qt=c,U.H=f,U.A=y,Gt===null&&(oe=null,Vt=0,Wr()),E}function Py(){for(;Gt!==null;)Op(Gt)}function Uy(e,n){var r=Qt;Qt|=2;var c=Rp(),f=Dp();oe!==e||Vt!==n?(Do=null,Ro=bt()+500,ea(e,n)):Qs=Aa(e,n);t:do try{if(te!==0&&Gt!==null){n=Gt;var y=di;e:switch(te){case 1:te=0,di=null,ia(e,n,y,1);break;case 2:case 9:if(Ud(y)){te=0,di=null,kp(n);break}n=function(){te!==2&&te!==9||oe!==e||(te=7),ji(e)},y.then(n,n);break t;case 3:te=7;break t;case 4:te=5;break t;case 7:Ud(y)?(te=0,di=null,kp(n)):(te=0,di=null,ia(e,n,y,7));break;case 5:var E=null;switch(Gt.tag){case 26:E=Gt.memoizedState;case 5:case 27:var R=Gt;if(E?yg(E):R.stateNode.complete){te=0,di=null;var P=R.sibling;if(P!==null)Gt=P;else{var K=R.return;K!==null?(Gt=K,No(K)):Gt=null}break e}}te=0,di=null,ia(e,n,y,5);break;case 6:te=0,di=null,ia(e,n,y,6);break;case 8:du(),be=6;break t;default:throw Error(s(462))}}Hy();break}catch(lt){xp(e,lt)}while(!0);return en=ss=null,U.H=c,U.A=f,Qt=r,Gt!==null?0:(oe=null,Vt=0,Wr(),be)}function Hy(){for(;Gt!==null&&!W();)Op(Gt)}function Op(e){var n=ep(e.alternate,e,dn);e.memoizedProps=e.pendingProps,n===null?No(e):Gt=n}function kp(e){var n=e,r=n.alternate;switch(n.tag){case 15:case 0:n=Kf(r,n,n.pendingProps,n.type,void 0,Vt);break;case 11:n=Kf(r,n,n.pendingProps,n.type.render,n.ref,Vt);break;case 5:Mc(n);default:np(r,n),n=Gt=Rd(n,dn),n=ep(r,n,dn)}e.memoizedProps=e.pendingProps,n===null?No(e):Gt=n}function ia(e,n,r,c){en=ss=null,Mc(n),Vs=null,Fa=0;var f=n.return;try{if(Ry(e,f,n,r,Vt)){be=1,_o(e,wi(r,e.current)),Gt=null;return}}catch(y){if(f!==null)throw Gt=f,y;be=1,_o(e,wi(r,e.current)),Gt=null;return}n.flags&32768?(Xt||c===1?e=!0:Qs||(Vt&536870912)!==0?e=!1:(On=e=!0,(c===2||c===9||c===3||c===6)&&(c=ui.current,c!==null&&c.tag===13&&(c.flags|=16384))),Np(n,e)):No(n)}function No(e){var n=e;do{if((n.flags&32768)!==0){Np(n,On);return}e=n.return;var r=ky(n.alternate,n,dn);if(r!==null){Gt=r;return}if(n=n.sibling,n!==null){Gt=n;return}Gt=n=e}while(n!==null);be===0&&(be=5)}function Np(e,n){do{var r=Ny(e.alternate,e);if(r!==null){r.flags&=32767,Gt=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!n&&(e=e.sibling,e!==null)){Gt=e;return}Gt=e=r}while(e!==null);be=6,Gt=null}function Lp(e,n,r,c,f,y,E,R,P){e.cancelPendingCommit=null;do Lo();while(Re!==0);if((Qt&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(y=n.lanes|n.childLanes,y|=ec,_0(e,r,y,E,R,P),e===oe&&(Gt=oe=null,Vt=0),ta=n,Ln=e,fn=r,cu=y,uu=f,wp=c,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Vy(jt,function(){return Pp(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||c){c=U.T,U.T=null,f=H.p,H.p=2,E=Qt,Qt|=4;try{Ly(e,n,r)}finally{Qt=E,H.p=f,U.T=c}}Re=1,Bp(),zp(),Ip()}}function Bp(){if(Re===1){Re=0;var e=Ln,n=ta,r=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||r){r=U.T,U.T=null;var c=H.p;H.p=2;var f=Qt;Qt|=4;try{gp(n,e);var y=Cu,E=_d(e.containerInfo),R=y.focusedElem,P=y.selectionRange;if(E!==R&&R&&R.ownerDocument&&vd(R.ownerDocument.documentElement,R)){if(P!==null&&Zl(R)){var K=P.start,lt=P.end;if(lt===void 0&&(lt=K),"selectionStart"in R)R.selectionStart=K,R.selectionEnd=Math.min(lt,R.value.length);else{var ht=R.ownerDocument||document,Q=ht&&ht.defaultView||window;if(Q.getSelection){var nt=Q.getSelection(),Et=R.textContent.length,kt=Math.min(P.start,Et),se=P.end===void 0?kt:Math.min(P.end,Et);!nt.extend&&kt>se&&(E=se,se=kt,kt=E);var Y=bd(R,kt),q=bd(R,se);if(Y&&q&&(nt.rangeCount!==1||nt.anchorNode!==Y.node||nt.anchorOffset!==Y.offset||nt.focusNode!==q.node||nt.focusOffset!==q.offset)){var $=ht.createRange();$.setStart(Y.node,Y.offset),nt.removeAllRanges(),kt>se?(nt.addRange($),nt.extend(q.node,q.offset)):($.setEnd(q.node,q.offset),nt.addRange($))}}}}for(ht=[],nt=R;nt=nt.parentNode;)nt.nodeType===1&&ht.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<ht.length;R++){var ut=ht[R];ut.element.scrollLeft=ut.left,ut.element.scrollTop=ut.top}}Yo=!!Eu,Cu=Eu=null}finally{Qt=f,H.p=c,U.T=r}}e.current=n,Re=2}}function zp(){if(Re===2){Re=0;var e=Ln,n=ta,r=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||r){r=U.T,U.T=null;var c=H.p;H.p=2;var f=Qt;Qt|=4;try{up(e,n.alternate,n)}finally{Qt=f,H.p=c,U.T=r}}Re=3}}function Ip(){if(Re===4||Re===3){Re=0,gt();var e=Ln,n=ta,r=fn,c=wp;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?Re=5:(Re=0,ta=Ln=null,Fp(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(Nn=null),Ol(r),n=n.stateNode,Oe&&typeof Oe.onCommitFiberRoot=="function")try{Oe.onCommitFiberRoot(re,n,void 0,(n.current.flags&128)===128)}catch{}if(c!==null){n=U.T,f=H.p,H.p=2,U.T=null;try{for(var y=e.onRecoverableError,E=0;E<c.length;E++){var R=c[E];y(R.value,{componentStack:R.stack})}}finally{U.T=n,H.p=f}}(fn&3)!==0&&Lo(),ji(e),f=e.pendingLanes,(r&261930)!==0&&(f&42)!==0?e===hu?er++:(er=0,hu=e):er=0,ir(0)}}function Fp(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,za(n)))}function Lo(){return Bp(),zp(),Ip(),Pp()}function Pp(){if(Re!==5)return!1;var e=Ln,n=cu;cu=0;var r=Ol(fn),c=U.T,f=H.p;try{H.p=32>r?32:r,U.T=null,r=uu,uu=null;var y=Ln,E=fn;if(Re=0,ta=Ln=null,fn=0,(Qt&6)!==0)throw Error(s(331));var R=Qt;if(Qt|=4,_p(y.current),yp(y,y.current,E,r),Qt=R,ir(0,!1),Oe&&typeof Oe.onPostCommitFiberRoot=="function")try{Oe.onPostCommitFiberRoot(re,y)}catch{}return!0}finally{H.p=f,U.T=c,Fp(e,n)}}function Up(e,n,r){n=wi(r,n),n=Gc(e.stateNode,n,2),e=xn(e,n,2),e!==null&&(Sa(e,2),ji(e))}function ee(e,n,r){if(e.tag===3)Up(e,e,r);else for(;n!==null;){if(n.tag===3){Up(n,e,r);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Nn===null||!Nn.has(c))){e=wi(r,e),r=Hf(2),c=xn(n,r,2),c!==null&&(jf(r,c,n,e),Sa(c,2),ji(c));break}}n=n.return}}function pu(e,n,r){var c=e.pingCache;if(c===null){c=e.pingCache=new Iy;var f=new Set;c.set(n,f)}else f=c.get(n),f===void 0&&(f=new Set,c.set(n,f));f.has(r)||(ru=!0,f.add(r),e=jy.bind(null,e,n,r),n.then(e,e))}function jy(e,n,r){var c=e.pingCache;c!==null&&c.delete(n),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,oe===e&&(Vt&r)===r&&(be===4||be===3&&(Vt&62914560)===Vt&&300>bt()-Mo?(Qt&2)===0&&ea(e,0):ou|=r,Js===Vt&&(Js=0)),ji(e)}function Hp(e,n){n===0&&(n=Lh()),e=es(e,n),e!==null&&(Sa(e,n),ji(e))}function Gy(e){var n=e.memoizedState,r=0;n!==null&&(r=n.retryLane),Hp(e,r)}function qy(e,n){var r=0;switch(e.tag){case 31:case 13:var c=e.stateNode,f=e.memoizedState;f!==null&&(r=f.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),Hp(e,r)}function Vy(e,n){return dt(e,n)}var Bo=null,na=null,gu=!1,zo=!1,mu=!1,zn=0;function ji(e){e!==na&&e.next===null&&(na===null?Bo=na=e:na=na.next=e),zo=!0,gu||(gu=!0,Xy())}function ir(e,n){if(!mu&&zo){mu=!0;do for(var r=!1,c=Bo;c!==null;){if(e!==0){var f=c.pendingLanes;if(f===0)var y=0;else{var E=c.suspendedLanes,R=c.pingedLanes;y=(1<<31-pe(42|e)+1)-1,y&=f&~(E&~R),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(r=!0,Vp(c,y))}else y=Vt,y=Pr(c,c===oe?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||Aa(c,y)||(r=!0,Vp(c,y));c=c.next}while(r);mu=!1}}function Yy(){jp()}function jp(){zo=gu=!1;var e=0;zn!==0&&nb()&&(e=zn);for(var n=bt(),r=null,c=Bo;c!==null;){var f=c.next,y=Gp(c,n);y===0?(c.next=null,r===null?Bo=f:r.next=f,f===null&&(na=r)):(r=c,(e!==0||(y&3)!==0)&&(zo=!0)),c=f}Re!==0&&Re!==5||ir(e),zn!==0&&(zn=0)}function Gp(e,n){for(var r=e.suspendedLanes,c=e.pingedLanes,f=e.expirationTimes,y=e.pendingLanes&-62914561;0<y;){var E=31-pe(y),R=1<<E,P=f[E];P===-1?((R&r)===0||(R&c)!==0)&&(f[E]=v0(R,n)):P<=n&&(e.expiredLanes|=R),y&=~R}if(n=oe,r=Vt,r=Pr(e,e===n?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,r===0||e===n&&(te===2||te===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&ft(c),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||Aa(e,r)){if(n=r&-r,n===e.callbackPriority)return n;switch(c!==null&&ft(c),Ol(r)){case 2:case 8:r=Jt;break;case 32:r=jt;break;case 268435456:r=bn;break;default:r=jt}return c=qp.bind(null,e),r=dt(r,c),e.callbackPriority=n,e.callbackNode=r,n}return c!==null&&c!==null&&ft(c),e.callbackPriority=2,e.callbackNode=null,2}function qp(e,n){if(Re!==0&&Re!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Lo()&&e.callbackNode!==r)return null;var c=Vt;return c=Pr(e,e===oe?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(Cp(e,c,n),Gp(e,bt()),e.callbackNode!=null&&e.callbackNode===r?qp.bind(null,e):null)}function Vp(e,n){if(Lo())return null;Cp(e,n,!0)}function Xy(){ab(function(){(Qt&6)!==0?dt(Rt,Yy):jp()})}function yu(){if(zn===0){var e=js;e===0&&(e=ws,ws<<=1,(ws&261888)===0&&(ws=256)),zn=e}return zn}function Yp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Gr(""+e)}function Xp(e,n){var r=n.ownerDocument.createElement("input");return r.name=n.name,r.value=n.value,e.id&&r.setAttribute("form",e.id),n.parentNode.insertBefore(r,n),e=new FormData(e),r.parentNode.removeChild(r),e}function $y(e,n,r,c,f){if(n==="submit"&&r&&r.stateNode===f){var y=Yp((f[Qe]||null).action),E=c.submitter;E&&(n=(n=E[Qe]||null)?Yp(n.formAction):E.getAttribute("formAction"),n!==null&&(y=n,E=null));var R=new Xr("action","action",null,c,f);e.push({event:R,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(zn!==0){var P=E?Xp(f,E):new FormData(f);Ic(r,{pending:!0,data:P,method:f.method,action:y},null,P)}}else typeof y=="function"&&(R.preventDefault(),P=E?Xp(f,E):new FormData(f),Ic(r,{pending:!0,data:P,method:f.method,action:y},y,P))},currentTarget:f}]})}}for(var bu=0;bu<tc.length;bu++){var vu=tc[bu],Ky=vu.toLowerCase(),Zy=vu[0].toUpperCase()+vu.slice(1);Li(Ky,"on"+Zy)}Li(wd,"onAnimationEnd"),Li(Ed,"onAnimationIteration"),Li(Cd,"onAnimationStart"),Li("dblclick","onDoubleClick"),Li("focusin","onFocus"),Li("focusout","onBlur"),Li(dy,"onTransitionRun"),Li(fy,"onTransitionStart"),Li(py,"onTransitionCancel"),Li(Td,"onTransitionEnd"),Ms("onMouseEnter",["mouseout","mouseover"]),Ms("onMouseLeave",["mouseout","mouseover"]),Ms("onPointerEnter",["pointerout","pointerover"]),Ms("onPointerLeave",["pointerout","pointerover"]),Wn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nr));function $p(e,n){n=(n&4)!==0;for(var r=0;r<e.length;r++){var c=e[r],f=c.event;c=c.listeners;t:{var y=void 0;if(n)for(var E=c.length-1;0<=E;E--){var R=c[E],P=R.instance,K=R.currentTarget;if(R=R.listener,P!==y&&f.isPropagationStopped())break t;y=R,f.currentTarget=K;try{y(f)}catch(lt){Zr(lt)}f.currentTarget=null,y=P}else for(E=0;E<c.length;E++){if(R=c[E],P=R.instance,K=R.currentTarget,R=R.listener,P!==y&&f.isPropagationStopped())break t;y=R,f.currentTarget=K;try{y(f)}catch(lt){Zr(lt)}f.currentTarget=null,y=P}}}}function qt(e,n){var r=n[kl];r===void 0&&(r=n[kl]=new Set);var c=e+"__bubble";r.has(c)||(Kp(n,e,2,!1),r.add(c))}function _u(e,n,r){var c=0;n&&(c|=4),Kp(r,e,c,n)}var Io="_reactListening"+Math.random().toString(36).slice(2);function Au(e){if(!e[Io]){e[Io]=!0,Hh.forEach(function(r){r!=="selectionchange"&&(Wy.has(r)||_u(r,!1,e),_u(r,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Io]||(n[Io]=!0,_u("selectionchange",!1,n))}}function Kp(e,n,r,c){switch(Eg(n)){case 2:var f=Cb;break;case 8:f=Tb;break;default:f=zu}r=f.bind(null,n,r,e),f=void 0,!Hl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),c?f!==void 0?e.addEventListener(n,r,{capture:!0,passive:f}):e.addEventListener(n,r,!0):f!==void 0?e.addEventListener(n,r,{passive:f}):e.addEventListener(n,r,!1)}function Su(e,n,r,c,f){var y=c;if((n&1)===0&&(n&2)===0&&c!==null)t:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var R=c.stateNode.containerInfo;if(R===f)break;if(E===4)for(E=c.return;E!==null;){var P=E.tag;if((P===3||P===4)&&E.stateNode.containerInfo===f)return;E=E.return}for(;R!==null;){if(E=Cs(R),E===null)return;if(P=E.tag,P===5||P===6||P===26||P===27){c=y=E;continue t}R=R.parentNode}}c=c.return}Jh(function(){var K=y,lt=Pl(r),ht=[];t:{var Q=xd.get(e);if(Q!==void 0){var nt=Xr,Et=e;switch(e){case"keypress":if(Vr(r)===0)break t;case"keydown":case"keyup":nt=q0;break;case"focusin":Et="focus",nt=Vl;break;case"focusout":Et="blur",nt=Vl;break;case"beforeblur":case"afterblur":nt=Vl;break;case"click":if(r.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=id;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=k0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=X0;break;case wd:case Ed:case Cd:nt=B0;break;case Td:nt=K0;break;case"scroll":case"scrollend":nt=D0;break;case"wheel":nt=W0;break;case"copy":case"cut":case"paste":nt=I0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=sd;break;case"toggle":case"beforetoggle":nt=J0}var kt=(n&4)!==0,se=!kt&&(e==="scroll"||e==="scrollend"),Y=kt?Q!==null?Q+"Capture":null:Q;kt=[];for(var q=K,$;q!==null;){var ut=q;if($=ut.stateNode,ut=ut.tag,ut!==5&&ut!==26&&ut!==27||$===null||Y===null||(ut=Ca(q,Y),ut!=null&&kt.push(sr(q,ut,$))),se)break;q=q.return}0<kt.length&&(Q=new nt(Q,Et,null,r,lt),ht.push({event:Q,listeners:kt}))}}if((n&7)===0){t:{if(Q=e==="mouseover"||e==="pointerover",nt=e==="mouseout"||e==="pointerout",Q&&r!==Fl&&(Et=r.relatedTarget||r.fromElement)&&(Cs(Et)||Et[Es]))break t;if((nt||Q)&&(Q=lt.window===lt?lt:(Q=lt.ownerDocument)?Q.defaultView||Q.parentWindow:window,nt?(Et=r.relatedTarget||r.toElement,nt=K,Et=Et?Cs(Et):null,Et!==null&&(se=o(Et),kt=Et.tag,Et!==se||kt!==5&&kt!==27&&kt!==6)&&(Et=null)):(nt=null,Et=K),nt!==Et)){if(kt=id,ut="onMouseLeave",Y="onMouseEnter",q="mouse",(e==="pointerout"||e==="pointerover")&&(kt=sd,ut="onPointerLeave",Y="onPointerEnter",q="pointer"),se=nt==null?Q:Ea(nt),$=Et==null?Q:Ea(Et),Q=new kt(ut,q+"leave",nt,r,lt),Q.target=se,Q.relatedTarget=$,ut=null,Cs(lt)===K&&(kt=new kt(Y,q+"enter",Et,r,lt),kt.target=$,kt.relatedTarget=se,ut=kt),se=ut,nt&&Et)e:{for(kt=Qy,Y=nt,q=Et,$=0,ut=Y;ut;ut=kt(ut))$++;ut=0;for(var Dt=q;Dt;Dt=kt(Dt))ut++;for(;0<$-ut;)Y=kt(Y),$--;for(;0<ut-$;)q=kt(q),ut--;for(;$--;){if(Y===q||q!==null&&Y===q.alternate){kt=Y;break e}Y=kt(Y),q=kt(q)}kt=null}else kt=null;nt!==null&&Zp(ht,Q,nt,kt,!1),Et!==null&&se!==null&&Zp(ht,se,Et,kt,!0)}}t:{if(Q=K?Ea(K):window,nt=Q.nodeName&&Q.nodeName.toLowerCase(),nt==="select"||nt==="input"&&Q.type==="file")var Zt=dd;else if(ud(Q))if(fd)Zt=cy;else{Zt=oy;var Tt=ry}else nt=Q.nodeName,!nt||nt.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?K&&Il(K.elementType)&&(Zt=dd):Zt=ly;if(Zt&&(Zt=Zt(e,K))){hd(ht,Zt,r,lt);break t}Tt&&Tt(e,Q,K),e==="focusout"&&K&&Q.type==="number"&&K.memoizedProps.value!=null&&zl(Q,"number",Q.value)}switch(Tt=K?Ea(K):window,e){case"focusin":(ud(Tt)||Tt.contentEditable==="true")&&(Ls=Tt,Wl=K,Na=null);break;case"focusout":Na=Wl=Ls=null;break;case"mousedown":Ql=!0;break;case"contextmenu":case"mouseup":case"dragend":Ql=!1,Ad(ht,r,lt);break;case"selectionchange":if(hy)break;case"keydown":case"keyup":Ad(ht,r,lt)}var Pt;if(Xl)t:{switch(e){case"compositionstart":var Yt="onCompositionStart";break t;case"compositionend":Yt="onCompositionEnd";break t;case"compositionupdate":Yt="onCompositionUpdate";break t}Yt=void 0}else Ns?ld(e,r)&&(Yt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Yt="onCompositionStart");Yt&&(ad&&r.locale!=="ko"&&(Ns||Yt!=="onCompositionStart"?Yt==="onCompositionEnd"&&Ns&&(Pt=td()):(_n=lt,jl="value"in _n?_n.value:_n.textContent,Ns=!0)),Tt=Fo(K,Yt),0<Tt.length&&(Yt=new nd(Yt,e,null,r,lt),ht.push({event:Yt,listeners:Tt}),Pt?Yt.data=Pt:(Pt=cd(r),Pt!==null&&(Yt.data=Pt)))),(Pt=ey?iy(e,r):ny(e,r))&&(Yt=Fo(K,"onBeforeInput"),0<Yt.length&&(Tt=new nd("onBeforeInput","beforeinput",null,r,lt),ht.push({event:Tt,listeners:Yt}),Tt.data=Pt)),$y(ht,e,K,r,lt)}$p(ht,n)})}function sr(e,n,r){return{instance:e,listener:n,currentTarget:r}}function Fo(e,n){for(var r=n+"Capture",c=[];e!==null;){var f=e,y=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||y===null||(f=Ca(e,r),f!=null&&c.unshift(sr(e,f,y)),f=Ca(e,n),f!=null&&c.push(sr(e,f,y))),e.tag===3)return c;e=e.return}return[]}function Qy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Zp(e,n,r,c,f){for(var y=n._reactName,E=[];r!==null&&r!==c;){var R=r,P=R.alternate,K=R.stateNode;if(R=R.tag,P!==null&&P===c)break;R!==5&&R!==26&&R!==27||K===null||(P=K,f?(K=Ca(r,y),K!=null&&E.unshift(sr(r,K,P))):f||(K=Ca(r,y),K!=null&&E.push(sr(r,K,P)))),r=r.return}E.length!==0&&e.push({event:n,listeners:E})}var Jy=/\r\n?/g,tb=/\u0000|\uFFFD/g;function Wp(e){return(typeof e=="string"?e:""+e).replace(Jy,`
`).replace(tb,"")}function Qp(e,n){return n=Wp(n),Wp(e)===n}function ne(e,n,r,c,f,y){switch(r){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||Ds(e,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&Ds(e,""+c);break;case"className":Hr(e,"class",c);break;case"tabIndex":Hr(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Hr(e,r,c);break;case"style":Wh(e,c,y);break;case"data":if(n!=="object"){Hr(e,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||r!=="href")){e.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(r);break}c=Gr(""+c),e.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(r==="formAction"?(n!=="input"&&ne(e,n,"name",f.name,f,null),ne(e,n,"formEncType",f.formEncType,f,null),ne(e,n,"formMethod",f.formMethod,f,null),ne(e,n,"formTarget",f.formTarget,f,null)):(ne(e,n,"encType",f.encType,f,null),ne(e,n,"method",f.method,f,null),ne(e,n,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(r);break}c=Gr(""+c),e.setAttribute(r,c);break;case"onClick":c!=null&&(e.onclick=Wi);break;case"onScroll":c!=null&&qt("scroll",e);break;case"onScrollEnd":c!=null&&qt("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));e.innerHTML=r}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}r=Gr(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,""+c):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":c===!0?e.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,c):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(r,c):e.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(r):e.setAttribute(r,c);break;case"popover":qt("beforetoggle",e),qt("toggle",e),Ur(e,"popover",c);break;case"xlinkActuate":Zi(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Zi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Zi(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Zi(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Zi(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Zi(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Zi(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Zi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Zi(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ur(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=M0.get(r)||r,Ur(e,r,c))}}function wu(e,n,r,c,f,y){switch(r){case"style":Wh(e,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));e.innerHTML=r}}break;case"children":typeof c=="string"?Ds(e,c):(typeof c=="number"||typeof c=="bigint")&&Ds(e,""+c);break;case"onScroll":c!=null&&qt("scroll",e);break;case"onScrollEnd":c!=null&&qt("scrollend",e);break;case"onClick":c!=null&&(e.onclick=Wi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jh.hasOwnProperty(r))t:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),n=r.slice(2,f?r.length-7:void 0),y=e[Qe]||null,y=y!=null?y[r]:null,typeof y=="function"&&e.removeEventListener(n,y,f),typeof c=="function")){typeof y!="function"&&y!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(n,c,f);break t}r in e?e[r]=c:c===!0?e.setAttribute(r,""):Ur(e,r,c)}}}function Pe(e,n,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qt("error",e),qt("load",e);var c=!1,f=!1,y;for(y in r)if(r.hasOwnProperty(y)){var E=r[y];if(E!=null)switch(y){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:ne(e,n,y,E,r,null)}}f&&ne(e,n,"srcSet",r.srcSet,r,null),c&&ne(e,n,"src",r.src,r,null);return;case"input":qt("invalid",e);var R=y=E=f=null,P=null,K=null;for(c in r)if(r.hasOwnProperty(c)){var lt=r[c];if(lt!=null)switch(c){case"name":f=lt;break;case"type":E=lt;break;case"checked":P=lt;break;case"defaultChecked":K=lt;break;case"value":y=lt;break;case"defaultValue":R=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(s(137,n));break;default:ne(e,n,c,lt,r,null)}}Xh(e,y,R,P,K,E,f,!1);return;case"select":qt("invalid",e),c=E=y=null;for(f in r)if(r.hasOwnProperty(f)&&(R=r[f],R!=null))switch(f){case"value":y=R;break;case"defaultValue":E=R;break;case"multiple":c=R;default:ne(e,n,f,R,r,null)}n=y,r=E,e.multiple=!!c,n!=null?Rs(e,!!c,n,!1):r!=null&&Rs(e,!!c,r,!0);return;case"textarea":qt("invalid",e),y=f=c=null;for(E in r)if(r.hasOwnProperty(E)&&(R=r[E],R!=null))switch(E){case"value":c=R;break;case"defaultValue":f=R;break;case"children":y=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(s(91));break;default:ne(e,n,E,R,r,null)}Kh(e,c,f,y);return;case"option":for(P in r)if(r.hasOwnProperty(P)&&(c=r[P],c!=null))switch(P){case"selected":e.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:ne(e,n,P,c,r,null)}return;case"dialog":qt("beforetoggle",e),qt("toggle",e),qt("cancel",e),qt("close",e);break;case"iframe":case"object":qt("load",e);break;case"video":case"audio":for(c=0;c<nr.length;c++)qt(nr[c],e);break;case"image":qt("error",e),qt("load",e);break;case"details":qt("toggle",e);break;case"embed":case"source":case"link":qt("error",e),qt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in r)if(r.hasOwnProperty(K)&&(c=r[K],c!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:ne(e,n,K,c,r,null)}return;default:if(Il(n)){for(lt in r)r.hasOwnProperty(lt)&&(c=r[lt],c!==void 0&&wu(e,n,lt,c,r,void 0));return}}for(R in r)r.hasOwnProperty(R)&&(c=r[R],c!=null&&ne(e,n,R,c,r,null))}function eb(e,n,r,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,y=null,E=null,R=null,P=null,K=null,lt=null;for(nt in r){var ht=r[nt];if(r.hasOwnProperty(nt)&&ht!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":P=ht;default:c.hasOwnProperty(nt)||ne(e,n,nt,null,c,ht)}}for(var Q in c){var nt=c[Q];if(ht=r[Q],c.hasOwnProperty(Q)&&(nt!=null||ht!=null))switch(Q){case"type":y=nt;break;case"name":f=nt;break;case"checked":K=nt;break;case"defaultChecked":lt=nt;break;case"value":E=nt;break;case"defaultValue":R=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(s(137,n));break;default:nt!==ht&&ne(e,n,Q,nt,c,ht)}}Bl(e,E,R,P,K,lt,y,f);return;case"select":nt=E=R=Q=null;for(y in r)if(P=r[y],r.hasOwnProperty(y)&&P!=null)switch(y){case"value":break;case"multiple":nt=P;default:c.hasOwnProperty(y)||ne(e,n,y,null,c,P)}for(f in c)if(y=c[f],P=r[f],c.hasOwnProperty(f)&&(y!=null||P!=null))switch(f){case"value":Q=y;break;case"defaultValue":R=y;break;case"multiple":E=y;default:y!==P&&ne(e,n,f,y,c,P)}n=R,r=E,c=nt,Q!=null?Rs(e,!!r,Q,!1):!!c!=!!r&&(n!=null?Rs(e,!!r,n,!0):Rs(e,!!r,r?[]:"",!1));return;case"textarea":nt=Q=null;for(R in r)if(f=r[R],r.hasOwnProperty(R)&&f!=null&&!c.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:ne(e,n,R,null,c,f)}for(E in c)if(f=c[E],y=r[E],c.hasOwnProperty(E)&&(f!=null||y!=null))switch(E){case"value":Q=f;break;case"defaultValue":nt=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(s(91));break;default:f!==y&&ne(e,n,E,f,c,y)}$h(e,Q,nt);return;case"option":for(var Et in r)if(Q=r[Et],r.hasOwnProperty(Et)&&Q!=null&&!c.hasOwnProperty(Et))switch(Et){case"selected":e.selected=!1;break;default:ne(e,n,Et,null,c,Q)}for(P in c)if(Q=c[P],nt=r[P],c.hasOwnProperty(P)&&Q!==nt&&(Q!=null||nt!=null))switch(P){case"selected":e.selected=Q&&typeof Q!="function"&&typeof Q!="symbol";break;default:ne(e,n,P,Q,c,nt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var kt in r)Q=r[kt],r.hasOwnProperty(kt)&&Q!=null&&!c.hasOwnProperty(kt)&&ne(e,n,kt,null,c,Q);for(K in c)if(Q=c[K],nt=r[K],c.hasOwnProperty(K)&&Q!==nt&&(Q!=null||nt!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(s(137,n));break;default:ne(e,n,K,Q,c,nt)}return;default:if(Il(n)){for(var se in r)Q=r[se],r.hasOwnProperty(se)&&Q!==void 0&&!c.hasOwnProperty(se)&&wu(e,n,se,void 0,c,Q);for(lt in c)Q=c[lt],nt=r[lt],!c.hasOwnProperty(lt)||Q===nt||Q===void 0&&nt===void 0||wu(e,n,lt,Q,c,nt);return}}for(var Y in r)Q=r[Y],r.hasOwnProperty(Y)&&Q!=null&&!c.hasOwnProperty(Y)&&ne(e,n,Y,null,c,Q);for(ht in c)Q=c[ht],nt=r[ht],!c.hasOwnProperty(ht)||Q===nt||Q==null&&nt==null||ne(e,n,ht,Q,c,nt)}function Jp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ib(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,r=performance.getEntriesByType("resource"),c=0;c<r.length;c++){var f=r[c],y=f.transferSize,E=f.initiatorType,R=f.duration;if(y&&R&&Jp(E)){for(E=0,R=f.responseEnd,c+=1;c<r.length;c++){var P=r[c],K=P.startTime;if(K>R)break;var lt=P.transferSize,ht=P.initiatorType;lt&&Jp(ht)&&(P=P.responseEnd,E+=lt*(P<R?1:(R-K)/(P-K)))}if(--c,n+=8*(y+E)/(f.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Eu=null,Cu=null;function Po(e){return e.nodeType===9?e:e.ownerDocument}function tg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function eg(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Tu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var xu=null;function nb(){var e=window.event;return e&&e.type==="popstate"?e===xu?!1:(xu=e,!0):(xu=null,!1)}var ig=typeof setTimeout=="function"?setTimeout:void 0,sb=typeof clearTimeout=="function"?clearTimeout:void 0,ng=typeof Promise=="function"?Promise:void 0,ab=typeof queueMicrotask=="function"?queueMicrotask:typeof ng<"u"?function(e){return ng.resolve(null).then(e).catch(rb)}:ig;function rb(e){setTimeout(function(){throw e})}function In(e){return e==="head"}function sg(e,n){var r=n,c=0;do{var f=r.nextSibling;if(e.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"||r==="/&"){if(c===0){e.removeChild(f),oa(n);return}c--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")c++;else if(r==="html")ar(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,ar(r);for(var y=r.firstChild;y;){var E=y.nextSibling,R=y.nodeName;y[wa]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&y.rel.toLowerCase()==="stylesheet"||r.removeChild(y),y=E}}else r==="body"&&ar(e.ownerDocument.body);r=f}while(r);oa(n)}function ag(e,n){var r=e;e=0;do{var c=r.nextSibling;if(r.nodeType===1?n?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(n?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=c}while(r)}function Mu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var r=n;switch(n=n.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Mu(r),Nl(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function ob(e,n,r,c){for(;e.nodeType===1;){var f=r;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[wa])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(y=e.getAttribute("rel"),y==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(y!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(y=e.getAttribute("src"),(y!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&y&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var y=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===y)return e}else return e;if(e=Mi(e.nextSibling),e===null)break}return null}function lb(e,n,r){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Mi(e.nextSibling),e===null))return null;return e}function rg(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Mi(e.nextSibling),e===null))return null;return e}function Ru(e){return e.data==="$?"||e.data==="$~"}function Du(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function cb(e,n){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||r.readyState!=="loading")n();else{var c=function(){n(),r.removeEventListener("DOMContentLoaded",c)};r.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function Mi(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Ou=null;function og(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(n===0)return Mi(e.nextSibling);n--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||n++}e=e.nextSibling}return null}function lg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(n===0)return e;n--}else r!=="/$"&&r!=="/&"||n++}e=e.previousSibling}return null}function cg(e,n,r){switch(n=Po(r),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function ar(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);Nl(e)}var Ri=new Map,ug=new Set;function Uo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var pn=H.d;H.d={f:ub,r:hb,D:db,C:fb,L:pb,m:gb,X:yb,S:mb,M:bb};function ub(){var e=pn.f(),n=Oo();return e||n}function hb(e){var n=Ts(e);n!==null&&n.tag===5&&n.type==="form"?xf(n):pn.r(e)}var sa=typeof document>"u"?null:document;function hg(e,n,r){var c=sa;if(c&&typeof n=="string"&&n){var f=Ai(n);f='link[rel="'+e+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),ug.has(f)||(ug.add(f),e={rel:e,crossOrigin:r,href:n},c.querySelector(f)===null&&(n=c.createElement("link"),Pe(n,"link",e),ke(n),c.head.appendChild(n)))}}function db(e){pn.D(e),hg("dns-prefetch",e,null)}function fb(e,n){pn.C(e,n),hg("preconnect",e,n)}function pb(e,n,r){pn.L(e,n,r);var c=sa;if(c&&e&&n){var f='link[rel="preload"][as="'+Ai(n)+'"]';n==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+Ai(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+Ai(r.imageSizes)+'"]')):f+='[href="'+Ai(e)+'"]';var y=f;switch(n){case"style":y=aa(e);break;case"script":y=ra(e)}Ri.has(y)||(e=m({rel:"preload",href:n==="image"&&r&&r.imageSrcSet?void 0:e,as:n},r),Ri.set(y,e),c.querySelector(f)!==null||n==="style"&&c.querySelector(rr(y))||n==="script"&&c.querySelector(or(y))||(n=c.createElement("link"),Pe(n,"link",e),ke(n),c.head.appendChild(n)))}}function gb(e,n){pn.m(e,n);var r=sa;if(r&&e){var c=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+Ai(c)+'"][href="'+Ai(e)+'"]',y=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=ra(e)}if(!Ri.has(y)&&(e=m({rel:"modulepreload",href:e},n),Ri.set(y,e),r.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(or(y)))return}c=r.createElement("link"),Pe(c,"link",e),ke(c),r.head.appendChild(c)}}}function mb(e,n,r){pn.S(e,n,r);var c=sa;if(c&&e){var f=xs(c).hoistableStyles,y=aa(e);n=n||"default";var E=f.get(y);if(!E){var R={loading:0,preload:null};if(E=c.querySelector(rr(y)))R.loading=5;else{e=m({rel:"stylesheet",href:e,"data-precedence":n},r),(r=Ri.get(y))&&ku(e,r);var P=E=c.createElement("link");ke(P),Pe(P,"link",e),P._p=new Promise(function(K,lt){P.onload=K,P.onerror=lt}),P.addEventListener("load",function(){R.loading|=1}),P.addEventListener("error",function(){R.loading|=2}),R.loading|=4,Ho(E,n,c)}E={type:"stylesheet",instance:E,count:1,state:R},f.set(y,E)}}}function yb(e,n){pn.X(e,n);var r=sa;if(r&&e){var c=xs(r).hoistableScripts,f=ra(e),y=c.get(f);y||(y=r.querySelector(or(f)),y||(e=m({src:e,async:!0},n),(n=Ri.get(f))&&Nu(e,n),y=r.createElement("script"),ke(y),Pe(y,"link",e),r.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(f,y))}}function bb(e,n){pn.M(e,n);var r=sa;if(r&&e){var c=xs(r).hoistableScripts,f=ra(e),y=c.get(f);y||(y=r.querySelector(or(f)),y||(e=m({src:e,async:!0,type:"module"},n),(n=Ri.get(f))&&Nu(e,n),y=r.createElement("script"),ke(y),Pe(y,"link",e),r.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(f,y))}}function dg(e,n,r,c){var f=(f=At.current)?Uo(f):null;if(!f)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(n=aa(r.href),r=xs(f).hoistableStyles,c=r.get(n),c||(c={type:"style",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=aa(r.href);var y=xs(f).hoistableStyles,E=y.get(e);if(E||(f=f.ownerDocument||f,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(e,E),(y=f.querySelector(rr(e)))&&!y._p&&(E.instance=y,E.state.loading=5),Ri.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Ri.set(e,r),y||vb(f,e,r,E.state))),n&&c===null)throw Error(s(528,""));return E}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=r.async,r=r.src,typeof r=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=ra(r),r=xs(f).hoistableScripts,c=r.get(n),c||(c={type:"script",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function aa(e){return'href="'+Ai(e)+'"'}function rr(e){return'link[rel="stylesheet"]['+e+"]"}function fg(e){return m({},e,{"data-precedence":e.precedence,precedence:null})}function vb(e,n,r,c){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=e.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),Pe(n,"link",r),ke(n),e.head.appendChild(n))}function ra(e){return'[src="'+Ai(e)+'"]'}function or(e){return"script[async]"+e}function pg(e,n,r){if(n.count++,n.instance===null)switch(n.type){case"style":var c=e.querySelector('style[data-href~="'+Ai(r.href)+'"]');if(c)return n.instance=c,ke(c),c;var f=m({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),ke(c),Pe(c,"style",f),Ho(c,r.precedence,e),n.instance=c;case"stylesheet":f=aa(r.href);var y=e.querySelector(rr(f));if(y)return n.state.loading|=4,n.instance=y,ke(y),y;c=fg(r),(f=Ri.get(f))&&ku(c,f),y=(e.ownerDocument||e).createElement("link"),ke(y);var E=y;return E._p=new Promise(function(R,P){E.onload=R,E.onerror=P}),Pe(y,"link",c),n.state.loading|=4,Ho(y,r.precedence,e),n.instance=y;case"script":return y=ra(r.src),(f=e.querySelector(or(y)))?(n.instance=f,ke(f),f):(c=r,(f=Ri.get(y))&&(c=m({},r),Nu(c,f)),e=e.ownerDocument||e,f=e.createElement("script"),ke(f),Pe(f,"link",c),e.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,Ho(c,r.precedence,e));return n.instance}function Ho(e,n,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,y=f,E=0;E<c.length;E++){var R=c[E];if(R.dataset.precedence===n)y=R;else if(y!==f)break}y?y.parentNode.insertBefore(e,y.nextSibling):(n=r.nodeType===9?r.head:r,n.insertBefore(e,n.firstChild))}function ku(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Nu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var jo=null;function gg(e,n,r){if(jo===null){var c=new Map,f=jo=new Map;f.set(r,c)}else f=jo,c=f.get(r),c||(c=new Map,f.set(r,c));if(c.has(e))return c;for(c.set(e,null),r=r.getElementsByTagName(e),f=0;f<r.length;f++){var y=r[f];if(!(y[wa]||y[Be]||e==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var E=y.getAttribute(n)||"";E=e+E;var R=c.get(E);R?R.push(y):c.set(E,[y])}}return c}function mg(e,n,r){e=e.ownerDocument||e,e.head.insertBefore(r,n==="title"?e.querySelector("head > title"):null)}function _b(e,n,r){if(r===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function yg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Ab(e,n,r,c){if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=aa(c.href),y=n.querySelector(rr(f));if(y){n=y._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=Go.bind(e),n.then(e,e)),r.state.loading|=4,r.instance=y,ke(y);return}y=n.ownerDocument||n,c=fg(c),(f=Ri.get(f))&&ku(c,f),y=y.createElement("link"),ke(y);var E=y;E._p=new Promise(function(R,P){E.onload=R,E.onerror=P}),Pe(y,"link",c),r.instance=y}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,n),(n=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=Go.bind(e),n.addEventListener("load",r),n.addEventListener("error",r))}}var Lu=0;function Sb(e,n){return e.stylesheets&&e.count===0&&Vo(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var c=setTimeout(function(){if(e.stylesheets&&Vo(e,e.stylesheets),e.unsuspend){var y=e.unsuspend;e.unsuspend=null,y()}},6e4+n);0<e.imgBytes&&Lu===0&&(Lu=62500*ib());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Vo(e,e.stylesheets),e.unsuspend)){var y=e.unsuspend;e.unsuspend=null,y()}},(e.imgBytes>Lu?50:800)+n);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Go(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Vo(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var qo=null;function Vo(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,qo=new Map,n.forEach(wb,e),qo=null,Go.call(e))}function wb(e,n){if(!(n.state.loading&4)){var r=qo.get(e);if(r)var c=r.get(null);else{r=new Map,qo.set(e,r);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<f.length;y++){var E=f[y];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(r.set(E.dataset.precedence,E),c=E)}c&&r.set(null,c)}f=n.instance,E=f.getAttribute("data-precedence"),y=r.get(E)||c,y===c&&r.set(null,f),r.set(E,f),this.count++,c=Go.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),y?y.parentNode.insertBefore(f,y.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),n.state.loading|=4}}var lr={$$typeof:M,Provider:null,Consumer:null,_currentValue:ct,_currentValue2:ct,_threadCount:0};function Eb(e,n,r,c,f,y,E,R,P){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Rl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rl(0),this.hiddenUpdates=Rl(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=y,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function bg(e,n,r,c,f,y,E,R,P,K,lt,ht){return e=new Eb(e,n,r,E,P,K,lt,ht,R),n=1,y===!0&&(n|=24),y=ci(3,null,null,n),e.current=y,y.stateNode=e,n=fc(),n.refCount++,e.pooledCache=n,n.refCount++,y.memoizedState={element:c,isDehydrated:r,cache:n},yc(y),e}function vg(e){return e?(e=Is,e):Is}function _g(e,n,r,c,f,y){f=vg(f),c.context===null?c.context=f:c.pendingContext=f,c=Tn(n),c.payload={element:r},y=y===void 0?null:y,y!==null&&(c.callback=y),r=xn(e,c,n),r!==null&&(si(r,e,n),Ua(r,e,n))}function Ag(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<n?r:n}}function Bu(e,n){Ag(e,n),(e=e.alternate)&&Ag(e,n)}function Sg(e){if(e.tag===13||e.tag===31){var n=es(e,67108864);n!==null&&si(n,e,67108864),Bu(e,67108864)}}function wg(e){if(e.tag===13||e.tag===31){var n=pi();n=Dl(n);var r=es(e,n);r!==null&&si(r,e,n),Bu(e,n)}}var Yo=!0;function Cb(e,n,r,c){var f=U.T;U.T=null;var y=H.p;try{H.p=2,zu(e,n,r,c)}finally{H.p=y,U.T=f}}function Tb(e,n,r,c){var f=U.T;U.T=null;var y=H.p;try{H.p=8,zu(e,n,r,c)}finally{H.p=y,U.T=f}}function zu(e,n,r,c){if(Yo){var f=Iu(c);if(f===null)Su(e,n,c,Xo,r),Cg(e,c);else if(Mb(f,e,n,r,c))c.stopPropagation();else if(Cg(e,c),n&4&&-1<xb.indexOf(e)){for(;f!==null;){var y=Ts(f);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var E=vi(y.pendingLanes);if(E!==0){var R=y;for(R.pendingLanes|=2,R.entangledLanes|=2;E;){var P=1<<31-pe(E);R.entanglements[1]|=P,E&=~P}ji(y),(Qt&6)===0&&(Ro=bt()+500,ir(0))}}break;case 31:case 13:R=es(y,2),R!==null&&si(R,y,2),Oo(),Bu(y,2)}if(y=Iu(c),y===null&&Su(e,n,c,Xo,r),y===f)break;f=y}f!==null&&c.stopPropagation()}else Su(e,n,c,null,r)}}function Iu(e){return e=Pl(e),Fu(e)}var Xo=null;function Fu(e){if(Xo=null,e=Cs(e),e!==null){var n=o(e);if(n===null)e=null;else{var r=n.tag;if(r===13){if(e=l(n),e!==null)return e;e=null}else if(r===31){if(e=u(n),e!==null)return e;e=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return Xo=e,null}function Eg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(yt()){case Rt:return 2;case Jt:return 8;case jt:case We:return 32;case bn:return 268435456;default:return 32}default:return 32}}var Pu=!1,Fn=null,Pn=null,Un=null,cr=new Map,ur=new Map,Hn=[],xb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cg(e,n){switch(e){case"focusin":case"focusout":Fn=null;break;case"dragenter":case"dragleave":Pn=null;break;case"mouseover":case"mouseout":Un=null;break;case"pointerover":case"pointerout":cr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ur.delete(n.pointerId)}}function hr(e,n,r,c,f,y){return e===null||e.nativeEvent!==y?(e={blockedOn:n,domEventName:r,eventSystemFlags:c,nativeEvent:y,targetContainers:[f]},n!==null&&(n=Ts(n),n!==null&&Sg(n)),e):(e.eventSystemFlags|=c,n=e.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),e)}function Mb(e,n,r,c,f){switch(n){case"focusin":return Fn=hr(Fn,e,n,r,c,f),!0;case"dragenter":return Pn=hr(Pn,e,n,r,c,f),!0;case"mouseover":return Un=hr(Un,e,n,r,c,f),!0;case"pointerover":var y=f.pointerId;return cr.set(y,hr(cr.get(y)||null,e,n,r,c,f)),!0;case"gotpointercapture":return y=f.pointerId,ur.set(y,hr(ur.get(y)||null,e,n,r,c,f)),!0}return!1}function Tg(e){var n=Cs(e.target);if(n!==null){var r=o(n);if(r!==null){if(n=r.tag,n===13){if(n=l(r),n!==null){e.blockedOn=n,Ph(e.priority,function(){wg(r)});return}}else if(n===31){if(n=u(r),n!==null){e.blockedOn=n,Ph(e.priority,function(){wg(r)});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $o(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var r=Iu(e.nativeEvent);if(r===null){r=e.nativeEvent;var c=new r.constructor(r.type,r);Fl=c,r.target.dispatchEvent(c),Fl=null}else return n=Ts(r),n!==null&&Sg(n),e.blockedOn=r,!1;n.shift()}return!0}function xg(e,n,r){$o(e)&&r.delete(n)}function Rb(){Pu=!1,Fn!==null&&$o(Fn)&&(Fn=null),Pn!==null&&$o(Pn)&&(Pn=null),Un!==null&&$o(Un)&&(Un=null),cr.forEach(xg),ur.forEach(xg)}function Ko(e,n){e.blockedOn===n&&(e.blockedOn=null,Pu||(Pu=!0,g.unstable_scheduleCallback(g.unstable_NormalPriority,Rb)))}var Zo=null;function Mg(e){Zo!==e&&(Zo=e,g.unstable_scheduleCallback(g.unstable_NormalPriority,function(){Zo===e&&(Zo=null);for(var n=0;n<e.length;n+=3){var r=e[n],c=e[n+1],f=e[n+2];if(typeof c!="function"){if(Fu(c||r)===null)continue;break}var y=Ts(r);y!==null&&(e.splice(n,3),n-=3,Ic(y,{pending:!0,data:f,method:r.method,action:c},c,f))}}))}function oa(e){function n(P){return Ko(P,e)}Fn!==null&&Ko(Fn,e),Pn!==null&&Ko(Pn,e),Un!==null&&Ko(Un,e),cr.forEach(n),ur.forEach(n);for(var r=0;r<Hn.length;r++){var c=Hn[r];c.blockedOn===e&&(c.blockedOn=null)}for(;0<Hn.length&&(r=Hn[0],r.blockedOn===null);)Tg(r),r.blockedOn===null&&Hn.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var f=r[c],y=r[c+1],E=f[Qe]||null;if(typeof y=="function")E||Mg(r);else if(E){var R=null;if(y&&y.hasAttribute("formAction")){if(f=y,E=y[Qe]||null)R=E.formAction;else if(Fu(f)!==null)continue}else R=E.action;typeof R=="function"?r[c+1]=R:(r.splice(c,3),c-=3),Mg(r)}}}function Rg(){function e(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(E){return f=E})},focusReset:"manual",scroll:"manual"})}function n(){f!==null&&(f(),f=null),c||setTimeout(r,20)}function r(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(r,100),function(){c=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),f!==null&&(f(),f=null)}}}function Uu(e){this._internalRoot=e}Wo.prototype.render=Uu.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var r=n.current,c=pi();_g(r,c,e,n,null,null)},Wo.prototype.unmount=Uu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;_g(e.current,2,null,e,null,null),Oo(),n[Es]=null}};function Wo(e){this._internalRoot=e}Wo.prototype.unstable_scheduleHydration=function(e){if(e){var n=Fh();e={blockedOn:null,target:e,priority:n};for(var r=0;r<Hn.length&&n!==0&&n<Hn[r].priority;r++);Hn.splice(r,0,e),r===0&&Tg(e)}};var Dg=t.version;if(Dg!=="19.2.0")throw Error(s(527,Dg,"19.2.0"));H.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=d(n),e=e!==null?p(e):null,e=e===null?null:e.stateNode,e};var Db={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qo.isDisabled&&Qo.supportsFiber)try{re=Qo.inject(Db),Oe=Qo}catch{}}return fr.createRoot=function(e,n){if(!a(e))throw Error(s(299));var r=!1,c="",f=If,y=Ff,E=Pf;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(E=n.onRecoverableError)),n=bg(e,1,!1,null,null,r,c,null,f,y,E,Rg),e[Es]=n.current,Au(e),new Uu(n)},fr.hydrateRoot=function(e,n,r){if(!a(e))throw Error(s(299));var c=!1,f="",y=If,E=Ff,R=Pf,P=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(y=r.onUncaughtError),r.onCaughtError!==void 0&&(E=r.onCaughtError),r.onRecoverableError!==void 0&&(R=r.onRecoverableError),r.formState!==void 0&&(P=r.formState)),n=bg(e,1,!0,n,r??null,c,f,P,y,E,R,Rg),n.context=vg(null),r=n.current,c=pi(),c=Dl(c),f=Tn(c),f.callback=null,xn(r,f,c),r=c,n.current.lanes=r,Sa(n,r),ji(n),e[Es]=n.current,Au(e),new Wo(n)},fr.version="19.2.0",fr}var jg;function Hb(){if(jg)return qu.exports;jg=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),qu.exports=Ub(),qu.exports}var jb=Hb();const $e=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),nh=[.001,0,0,.001,0,0],$u=1.35,gi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},qn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},wr="pdfjs_internal_editor_",It={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},$t={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Gb={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ue={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},dl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Me={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ua={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},_l={ERRORS:0,WARNINGS:1,INFOS:5},Er={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},tl={moveTo:0,lineTo:1,curveTo:2,closePath:3},qb={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Al=_l.WARNINGS;function Vb(g){Number.isInteger(g)&&(Al=g)}function Yb(){return Al}function Sl(g){Al>=_l.INFOS&&console.info(`Info: ${g}`)}function zt(g){Al>=_l.WARNINGS&&console.warn(`Warning: ${g}`)}function le(g){throw new Error(g)}function Kt(g,t){g||le(t)}function Xb(g){switch(g?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Bm(g,t=null,i=null){if(!g)return null;if(i&&typeof g=="string"&&(i.addDefaultProtocol&&g.startsWith("www.")&&g.match(/\./g)?.length>=2&&(g=`http://${g}`),i.tryConvertEncoding))try{g=Qb(g)}catch{}const s=t?URL.parse(g,t):URL.parse(g);return Xb(s)?s:null}function zm(g,t,i=!1){const s=URL.parse(g);return s?(s.hash=t,s.href):i&&Bm(g,"http://example.com")?g.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Ht(g,t,i,s=!1){return Object.defineProperty(g,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const As=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Gg extends As{constructor(t,i){super(t,"PasswordException"),this.code=i}}class Ku extends As{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class sh extends As{constructor(t){super(t,"InvalidPDFException")}}class ml extends As{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class $b extends As{constructor(t){super(t,"FormatError")}}class Xn extends As{constructor(t){super(t,"AbortException")}}function Im(g){(typeof g!="object"||g?.length===void 0)&&le("Invalid argument for bytesToString");const t=g.length,i=8192;if(t<i)return String.fromCharCode.apply(null,g);const s=[];for(let a=0;a<t;a+=i){const o=Math.min(a+i,t),l=g.subarray(a,o);s.push(String.fromCharCode.apply(null,l))}return s.join("")}function Dr(g){typeof g!="string"&&le("Invalid argument for stringToBytes");const t=g.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=g.charCodeAt(s)&255;return i}function Kb(g){return String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,g&255)}function Zb(){const g=new Uint8Array(4);return g[0]=1,new Uint32Array(g.buffer,0,1)[0]===1}function Wb(){try{return new Function(""),!0}catch{return!1}}class Ge{static get isLittleEndian(){return Ht(this,"isLittleEndian",Zb())}static get isEvalSupported(){return Ht(this,"isEvalSupported",Wb())}static get isOffscreenCanvasSupported(){return Ht(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ht(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return Ht(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return Ht(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Zu=Array.from(Array(256).keys(),g=>g.toString(16).padStart(2,"0"));class Ct{static makeHexColor(t,i,s){return`#${Zu[t]}${Zu[i]}${Zu[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const a=t[s],o=t[s+1];t[s]=a*i[0]+o*i[2]+i[4],t[s+1]=a*i[1]+o*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const a=i[0],o=i[1],l=i[2],u=i[3],h=i[4],d=i[5];for(let p=0;p<6;p+=2){const m=t[s+p],v=t[s+p+1];t[s+p]=m*a+v*l+h,t[s+p+1]=m*o+v*u+d}}static applyInverseTransform(t,i){const s=t[0],a=t[1],o=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-a*i[2]+i[2]*i[5]-i[4]*i[3])/o,t[1]=(-s*i[1]+a*i[0]+i[4]*i[1]-i[5]*i[0])/o}static axialAlignedBoundingBox(t,i,s){const a=i[0],o=i[1],l=i[2],u=i[3],h=i[4],d=i[5],p=t[0],m=t[1],v=t[2],b=t[3];let A=a*p+h,_=A,w=a*v+h,S=w,T=u*m+d,M=T,k=u*b+d,O=k;if(o!==0||l!==0){const z=o*p,L=o*v,G=l*m,j=l*b;A+=G,S+=G,w+=j,_+=j,T+=z,O+=z,k+=L,M+=L}s[0]=Math.min(s[0],A,w,_,S),s[1]=Math.min(s[1],T,k,M,O),s[2]=Math.max(s[2],A,w,_,S),s[3]=Math.max(s[3],T,k,M,O)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],a=t[1],o=t[2],l=t[3],u=s**2+a**2,h=s*o+a*l,d=o**2+l**2,p=(u+d)/2,m=Math.sqrt(p**2-(u*d-h**2));i[0]=Math.sqrt(p+m||1),i[1]=Math.sqrt(p-m||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>a)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return o>l?null:[s,o,a,l]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,a,o){o[0]=Math.min(o[0],t,s),o[1]=Math.min(o[1],i,a),o[2]=Math.max(o[2],t,s),o[3]=Math.max(o[3],i,a)}static#t(t,i,s,a,o,l,u,h,d,p){if(d<=0||d>=1)return;const m=1-d,v=d*d,b=v*d,A=m*(m*(m*t+3*d*i)+3*v*s)+b*a,_=m*(m*(m*o+3*d*l)+3*v*u)+b*h;p[0]=Math.min(p[0],A),p[1]=Math.min(p[1],_),p[2]=Math.max(p[2],A),p[3]=Math.max(p[3],_)}static#e(t,i,s,a,o,l,u,h,d,p,m,v){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,i,s,a,o,l,u,h,-m/p,v);return}const b=p**2-4*m*d;if(b<0)return;const A=Math.sqrt(b),_=2*d;this.#t(t,i,s,a,o,l,u,h,(-p+A)/_,v),this.#t(t,i,s,a,o,l,u,h,(-p-A)/_,v)}static bezierBoundingBox(t,i,s,a,o,l,u,h,d){d[0]=Math.min(d[0],t,u),d[1]=Math.min(d[1],i,h),d[2]=Math.max(d[2],t,u),d[3]=Math.max(d[3],i,h),this.#e(t,s,o,u,i,a,l,h,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),d),this.#e(t,s,o,u,i,a,l,h,3*(-i+3*(a-l)+h),6*(i-2*a+l),3*(a-i),d)}}function Qb(g){return decodeURIComponent(escape(g))}let Wu=null,qg=null;function Jb(g){return Wu||(Wu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,qg=new Map([["ﬅ","ſt"]])),g.replaceAll(Wu,(t,i,s)=>i?i.normalize("NFKC"):qg.get(s))}function Fm(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const g=new Uint8Array(32);return crypto.getRandomValues(g),Im(g)}const yh="pdfjs_internal_id_";function tv(g,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,a,...o]=i;if(!g(s)&&!Number.isInteger(s)||!t(a))return!1;const l=o.length;let u=!0;switch(a.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Ke(g,t,i){return Math.min(Math.max(g,t),i)}function Pm(g){return Uint8Array.prototype.toBase64?g.toBase64():btoa(Im(g))}function ev(g){return Uint8Array.fromBase64?Uint8Array.fromBase64(g):Dr(atob(g))}typeof Promise.try!="function"&&(Promise.try=function(g,...t){return new Promise(i=>{i(g(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(g){return g.reduce((t,i)=>t+i,0)});class Cr{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function a(o){if(!o)return;let l=null;const u=o.name;if(u==="#text")l=o.value;else if(Cr.shouldBuildText(u))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&i.push({str:l}),!!o.children)for(const h of o.children)a(h)}return a(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Um{static setupStorage(t,i,s,a,o){const l=a.getValue(i,{value:null});switch(s.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(l.value===s.attributes.xfaOn?t.setAttribute("checked",!0):l.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",u=>{a.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(i,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of s.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;a.setValue(i,{value:d})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:a,linkService:o}){const{attributes:l}=i,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${a}`);for(const[h,d]of Object.entries(l))if(d!=null)switch(h){case"class":d.length&&t.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,d)}u&&o.addLinkAttributes(t,l.href,l.newWindow),s&&l.dataId&&this.setupStorage(t,l.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,a=t.xfaHtml,o=t.intent||"display",l=document.createElement(a.name);a.attributes&&this.setAttributes({html:l,element:a,intent:o,linkService:s});const u=o!=="richText",h=t.div;if(h.append(l),t.viewport){const m=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=m}u&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(a.children.length===0){if(a.value){const m=document.createTextNode(a.value);l.append(m),u&&Cr.shouldBuildText(a.name)&&d.push(m)}return{textDivs:d}}const p=[[a,-1,l]];for(;p.length>0;){const[m,v,b]=p.at(-1);if(v+1===m.children.length){p.pop();continue}const A=m.children[++p.at(-1)[1]];if(A===null)continue;const{name:_}=A;if(_==="#text"){const S=document.createTextNode(A.value);d.push(S),b.append(S);continue}const w=A?.attributes?.xmlns?document.createElementNS(A.attributes.xmlns,_):document.createElement(_);if(b.append(w),A.attributes&&this.setAttributes({html:w,element:A,storage:i,intent:o,linkService:s}),A.children?.length>0)p.push([A,-1,w]);else if(A.value){const S=document.createTextNode(A.value);u&&Cr.shouldBuildText(_)&&d.push(S),w.append(S)}}for(const m of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const gn="http://www.w3.org/2000/svg";class _a{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Or(g,t="text"){if(br(g,document.baseURI)){const i=await fetch(g);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const a=new XMLHttpRequest;a.open("GET",g,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(a.response);return}i(a.responseText);return}s(new Error(a.statusText))}},a.send(null)})}class kr{constructor({viewBox:t,userUnit:i,scale:s,rotation:a,offsetX:o=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=a,this.offsetX=o,this.offsetY=l,s*=i;const h=(t[2]+t[0])/2,d=(t[3]+t[1])/2;let p,m,v,b;switch(a%=360,a<0&&(a+=360),a){case 180:p=-1,m=0,v=0,b=1;break;case 90:p=0,m=1,v=1,b=0;break;case 270:p=0,m=-1,v=-1,b=0;break;case 0:p=1,m=0,v=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,b=-b);let A,_,w,S;p===0?(A=Math.abs(d-t[1])*s+o,_=Math.abs(h-t[0])*s+l,w=(t[3]-t[1])*s,S=(t[2]-t[0])*s):(A=Math.abs(h-t[0])*s+o,_=Math.abs(d-t[1])*s+l,w=(t[2]-t[0])*s,S=(t[3]-t[1])*s),this.transform=[p*s,m*s,v*s,b*s,A-p*s*h-v*s*d,_-m*s*h-b*s*d],this.width=w,this.height=S}get rawDims(){const t=this.viewBox;return Ht(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:a=this.offsetY,dontFlip:o=!1}={}){return new kr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:a,dontFlip:o})}convertToViewportPoint(t,i){const s=[t,i];return Ct.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];Ct.applyTransform(i,this.transform);const s=[t[2],t[3]];return Ct.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return Ct.applyInverseTransform(s,this.transform),s}}class bh extends As{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function wl(g){const t=g.length;let i=0;for(;i<t&&g[i].trim()==="";)i++;return g.substring(i,i+5).toLowerCase()==="data:"}function vh(g){return typeof g=="string"&&/\.pdf$/i.test(g)}function iv(g){return[g]=g.split(/[#?]/,1),g.substring(g.lastIndexOf("/")+1)}function nv(g,t="document.pdf"){if(typeof g!="string")return t;if(wl(g))return zt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(g);if(!s)return t;const a=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},o=/\.pdf$/i,l=s.pathname.split("/").at(-1);if(o.test(l))return a(l);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const d of u)if(o.test(d))return a(d);const h=Array.from(s.searchParams.keys()).reverse();for(const d of h)if(o.test(d))return a(d)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return a(h[0])}return t}class Vg{started=Object.create(null);times=[];time(t){t in this.started&&zt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||zt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:a,end:o}of this.times)t.push(`${s.padEnd(i)} ${o-a}ms
`);return t.join("")}}function br(g,t){const i=t?URL.parse(g,t):URL.parse(g);return i?.protocol==="http:"||i?.protocol==="https:"}function Ni(g){g.preventDefault()}function ve(g){g.preventDefault(),g.stopPropagation()}function sv(g){console.log("Deprecated API usage: "+g)}class ah{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let a=parseInt(i[2],10);a=a>=1&&a<=12?a-1:0;let o=parseInt(i[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(i[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(i[6],10);h=h>=0&&h<=59?h:0;const d=i[7]||"Z";let p=parseInt(i[8],10);p=p>=0&&p<=23?p:0;let m=parseInt(i[9],10)||0;return m=m>=0&&m<=59?m:0,d==="-"?(l+=p,u+=m):d==="+"&&(l-=p,u-=m),new Date(Date.UTC(s,a,o,l,u,h))}}function av(g,{scale:t=1,rotation:i=0}){const{width:s,height:a}=g.attributes.style,o=[0,0,parseInt(s),parseInt(a)];return new kr({viewBox:o,userUnit:1,scale:t,rotation:i})}function Nr(g){if(g.startsWith("#")){const t=parseInt(g.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return g.startsWith("rgb(")?g.slice(4,-1).split(",").map(t=>parseInt(t)):g.startsWith("rgba(")?g.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(zt(`Not a valid color format: "${g}"`),[0,0,0])}function rv(g){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of g.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;g.set(i,Nr(s))}t.remove()}function ge(g){const{a:t,b:i,c:s,d:a,e:o,f:l}=g.getTransform();return[t,i,s,a,o,l]}function Vi(g){const{a:t,b:i,c:s,d:a,e:o,f:l}=g.getTransform().invertSelf();return[t,i,s,a,o,l]}function bs(g,t,i=!1,s=!0){if(t instanceof kr){const{pageWidth:a,pageHeight:o}=t.rawDims,{style:l}=g,u=Ge.isCSSRoundSupported,h=`var(--total-scale-factor) * ${a}px`,d=`var(--total-scale-factor) * ${o}px`,p=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,m=u?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!i||t.rotation%180===0?(l.width=p,l.height=m):(l.width=m,l.height=p)}s&&g.setAttribute("data-main-rotation",t.rotation)}class Ki{constructor(){const{pixelRatio:t}=Ki;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,a,o=-1){let l=1/0,u=1/0,h=1/0;s=Ki.capPixels(s,o),s>0&&(l=Math.sqrt(s/(t*i))),a!==-1&&(u=a/t,h=a/i);const d=Math.min(l,u,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const rh=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class ov{static get isDarkMode(){return Ht(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class lv{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),Ht(this,"commentForegroundColor",Nr(s))}}function cv(g,t,i,s){s=Math.min(Math.max(s??1,0),1);const a=255*(1-s);return g=Math.round(g*s+a),t=Math.round(t*s+a),i=Math.round(i*s+a),[g,t,i]}function Yg(g,t){const i=g[0]/255,s=g[1]/255,a=g[2]/255,o=Math.max(i,s,a),l=Math.min(i,s,a),u=(o+l)/2;if(o===l)t[0]=t[1]=0;else{const h=o-l;switch(t[1]=u<.5?h/(o+l):h/(2-o-l),o){case i:t[0]=((s-a)/h+(s<a?6:0))*60;break;case s:t[0]=((a-i)/h+2)*60;break;case a:t[0]=((i-s)/h+4)*60;break}}t[2]=u}function oh(g,t){const i=g[0],s=g[1],a=g[2],o=(1-Math.abs(2*a-1))*s,l=o*(1-Math.abs(i/60%2-1)),u=a-o/2;switch(Math.floor(i/60)){case 0:t[0]=o+u,t[1]=l+u,t[2]=u;break;case 1:t[0]=l+u,t[1]=o+u,t[2]=u;break;case 2:t[0]=u,t[1]=o+u,t[2]=l+u;break;case 3:t[0]=u,t[1]=l+u,t[2]=o+u;break;case 4:t[0]=l+u,t[1]=u,t[2]=o+u;break;case 5:case 6:t[0]=o+u,t[1]=u,t[2]=l+u;break}}function Xg(g){return g<=.03928?g/12.92:((g+.055)/1.055)**2.4}function $g(g,t,i){oh(g,i),i.map(Xg);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];oh(t,i),i.map(Xg);const a=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>a?(s+.05)/(a+.05):(a+.05)/(s+.05)}const Kg=new Map;function uv(g,t){const i=g[0]+g[1]*256+g[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=Kg.get(i);if(s)return s;const a=new Float32Array(9),o=a.subarray(0,3),l=a.subarray(3,6);Yg(g,l);const u=a.subarray(6,9);Yg(t,u);const h=u[2]<.5,d=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),$g(l,u,o)<d){let p,m;h?(p=l[2],m=1):(p=0,m=l[2]);const v=.005;for(;m-p>v;){const b=l[2]=(p+m)/2;h===$g(l,u,o)<d?p=b:m=b}l[2]=h?m:p}return oh(l,o),s=Ct.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),Kg.set(i,s),s}function Hm({html:g,dir:t,className:i},s){const a=document.createDocumentFragment();if(typeof g=="string"){const o=document.createElement("p");o.dir=t||"auto";const l=g.split(/(?:\r\n?|\n)/);for(let u=0,h=l.length;u<h;++u){const d=l[u];o.append(document.createTextNode(d)),u<h-1&&o.append(document.createElement("br"))}a.append(o)}else Um.render({xfaHtml:g,div:a,intent:"richText"});a.firstChild.classList.add("richText",i),s.append(a)}class Ar{#t=null;#e=null;#n;#i=null;#r=null;#s=null;#a=null;#o=null;static#c=null;constructor(t){this.#n=t,Ar.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",Ni,{signal:i}),t.addEventListener("pointerdown",Ar.#l,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const a=this.#n.toolbarPosition;if(a){const{style:o}=t,l=this.#n._uiManager.direction==="ltr"?1-a[0]:a[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,ve(t)}#h(t){this.#n._focusEventsAllowed=!0,ve(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",Ni,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",Ar.#c[t]),this.#f(s)&&s.addEventListener("click",a=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#m),this.#r=t}addComment(t,i=null){if(this.#s)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const a=this.#a=this.#m;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(a,i)):this.#i.append(s,a),this.#s=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#m)}async addEditSignatureButton(t){const i=this.#o=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#m)}removeButton(t){switch(t){case"comment":this.#s?.removeToolbarCommentButton(),this.#s=null,this.#a?.remove(),this.#a=null;break}}async addButton(t,i){switch(t){case"colorPicker":this.addColorPicker(i);break;case"altText":await this.addAltText(i);break;case"editSignature":await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(i);break}}async addButtonBefore(t,i,s){const a=this.#i.querySelector(s);a&&t==="comment"&&this.addComment(i,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class hv{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",Ni,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#r(t,i){let s=0,a=0;for(const o of t){const l=o.y+o.height;if(l<s)continue;const u=o.x+(i?o.width:0);if(l>s){a=u,s=l;continue}i?u>a&&(a=u):u<a&&(a=u)}return[i?1-a:a,s]}show(t,i,s){const[a,o]=this.#r(i,s),{style:l}=this.#e||=this.#i();t.append(this.#e),l.insetInlineEnd=`${100*a}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(t,i,s,a){const o=document.createElement("button");o.classList.add("basic",t),o.tabIndex=0,o.setAttribute("data-l10n-id",i);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(o.addEventListener("contextmenu",Ni,{signal:u}),o.addEventListener("click",a,{signal:u})),this.#t.append(o)}}function jm(g,t,i){for(const s of i)t.addEventListener(s,g[s].bind(g))}class dv{#t=0;get id(){return`${wr}${this.#t++}`}}class _h{#t=Fm();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const o=a.decode().then(()=>(s.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return Ht(this,"_isSVGFittingCanvas",o)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof i=="string"?(s.url=i,a=await Or(i,"blob")):i instanceof File?a=s.file=i:i instanceof Blob&&(a=i),a.type==="image/svg+xml"){const o=_h._isSVGFittingCanvas,l=new FileReader,u=new Image,h=new Promise((d,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,d()},l.onload=async()=>{const m=s.svgUrl=l.result;u.src=await o?`${m}#svgView(preserveAspectRatio(none))`:m},u.onerror=l.onerror=p});l.readAsDataURL(a),await h}else s.bitmap=await createImageBitmap(a);s.refCounter=1}catch(a){zt(a),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:a,type:o}=t;return this.#i(`${i}_${s}_${a}_${o}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const a=new OffscreenCanvas(i.width,i.height);return a.getContext("2d").drawImage(i,0,0),s={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const a=new OffscreenCanvas(s.width,s.height);a.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=a.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class fv{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:a,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const h={cmd:t,undo:i,post:s,type:o};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(l&&this.#t[this.#i].type===o){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const d=this.#i+1;d===this.#n?this.#t.splice(0,1):(this.#i=d,d<this.#t.length&&this.#t.splice(d)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class Lr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=Ge.platform;for(const[s,a,o={}]of t)for(const l of s){const u=l.startsWith("mac+");i&&u?(this.callbacks.set(l.slice(4),{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1))):!i&&!u&&(this.callbacks.set(l,{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:a,options:{bubbles:o=!1,args:l=[],checker:u=null}}=s;u&&!u(t,i)||(a.bind(t,...l,i)(),o||ve(i))}}class Ah{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return rv(t),Ht(this,"_colors",t)}convert(t){const i=Nr(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,a]of this._colors)if(a.every((o,l)=>o===i[l]))return Ah._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?Ct.makeHexColor(...i):t}}class $n{#t=new AbortController;#e=null;#n=null;#i=new Map;#r=new Map;#s=null;#a=null;#o=null;#c=new fv;#l=null;#d=null;#h=null;#f=0;#m=new Set;#p=null;#u=null;#g=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#C=null;#w=null;#_=null;#x=null;#S=!1;#E=null;#D=new dv;#M=!1;#R=!1;#I=!1;#k=null;#L=null;#F=null;#B=null;#q=null;#T=It.NONE;#A=new Set;#N=null;#P=null;#H=null;#X=null;#Y=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#z=null;#V=null;#Q=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=$n.prototype,i=l=>l.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),s=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},a=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Ht(this,"_keyboardManager",new Lr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#V.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:i}]]))}constructor(t,i,s,a,o,l,u,h,d,p,m,v,b,A,_,w){const S=this._signal=this.#t.signal;this.#V=t,this.#Q=i,this.#J=s,this.#s=a,this.#l=o,this.#P=l,this.#Y=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:S}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:S}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:S}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:S}),u._on("setpreference",this.onSetPreference.bind(this),{signal:S}),u._on("switchannotationeditorparams",T=>this.updateParams(T.type,T.value),{signal:S}),window.addEventListener("pointerdown",()=>{this.#R=!0},{capture:!0,signal:S}),window.addEventListener("pointerup",()=>{this.#R=!1},{capture:!0,signal:S}),this.#lt(),this.#dt(),this.#et(),this.#a=h.annotationStorage,this.#C=h.filterFactory,this.#H=d,this.#x=p||null,this.#y=m,this.#v=v,this.#b=b,this.#q=A||null,this.viewParameters={realScale:_a.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=w!==!1,o?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#g.clear(),this.#B?.clear(),this.#e=null,this.#A.clear(),this.#c.destroy(),this.#s?.destroy(),this.#l?.destroy(),this.#P?.destroy(),this.#E?.hide(),this.#E=null,this.#F?.destroy(),this.#F=null,this.#n=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#z&&(clearTimeout(this.#z),this.#z=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return Ht(this,"hcmFilter",this.#H?this.#C.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return Ht(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return Ht(this,"_highlightColors",this.#x?new Map(this.#x.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Ht(this,"highlightColors",null);const i=new Map,s=!!this.#H;for(const[a,o]of t){const l=a.endsWith("_HCM");if(s&&l){i.set(a.replace("_HCM",""),o);continue}!s&&!l&&i.set(a,o)}return Ht(this,"highlightColors",i)}get highlightColorNames(){return Ht(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,i=!1){this.#s?.editAltText(this,t,i)}hasCommentManager(){return!!this.#l}editComment(t,i,s,a){this.#l?.showDialog(this,t,i,s,a)}selectComment(t,i){this.#r.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,i,s=void 0){this.#l?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#l?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),a=o=>{o.pageNumber===t&&(this._eventBus._off("editorsrendered",a),i())};this._eventBus.on("editorsrendered",a),await s}getSignature(t){this.#P?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#P}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":this.#b=i;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,i){for(const s of this.#r.values()){const{x:a,y:o,width:l,height:u}=s.div.getBoundingClientRect();if(t>=a&&t<=a+l&&i>=o&&i<=o+u)return s}return null}disableUserSelect(t=!1){this.#Q.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*_a.PDF_TO_CSS_UNITS;for(const i of this.#g)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#r.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u}=s,h=s.toString(),p=this.#W(s).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;s.empty();const v=this.#tt(p),b=this.#T===It.NONE,A=()=>{const _=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u,text:h});b&&this.showAllEditors("highlight",!0,!0),i&&_?.editComment()};if(b){this.switchToMode(It.HIGHLIGHT,A);return}A()}commentSelection(t=""){this.highlightSelection(t,!0)}#rt(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#W(t).closest(".textLayer"),a=this.getSelectionBoxes(s);a&&(this.#E||=new hv(this),this.#E.show(s,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#a)return null;const i=`${wr}${t}`,s=this.#a.getRawValue(i);return s&&this.#a.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#N&&(this.#E?.hide(),this.#N=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#N)return;const a=this.#W(t).closest(".textLayer");if(!a){this.#N&&(this.#E?.hide(),this.#N=null,this.#O({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#N=i,this.#O({hasSelectedText:!0}),!(this.#T!==It.HIGHLIGHT&&this.#T!==It.NONE)&&(this.#T===It.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#T===It.HIGHLIGHT?this.#tt(a):null;if(o?.toggleDrawing(),this.#R){const l=new AbortController,u=this.combinedSignal(l),h=d=>{d.type==="pointerup"&&d.button!==0||(l.abort(),o?.toggleDrawing(!0),d.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else o?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#T===It.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#rt()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#_)return;this.#_=new AbortController;const t=this.combinedSignal(this.#_);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#_?.abort(),this.#_=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#A)if(i.div.contains(t)){this.#L=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,i]=this.#L;this.#L=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#k?.abort(),this.#k=null}#it(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#nt(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#it()}removeEditListeners(){this.#ht(),this.#nt()}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#A){const a=s.serialize(!0);a&&i.push(a)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const o of i.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){zt(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const a=this.currentLayer;try{const o=[];for(const h of s){const d=await a.deserialize(h);if(!d)return;o.push(d)}const l=()=>{for(const h of o)this.#st(h);this.#at(o)},u=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(o){zt(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==It.NONE&&!this.isEditorHandlingKeyboard&&$n._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([s,a])=>this.#$[s]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#T===It.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[$t.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#it(),this.#O({isEditing:this.#T!==It.NONE,isEmpty:this.#Z(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#nt(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,a=!1,o=!1){if(this.#T!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===It.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===It.NONE){this.setEditingState(!1),this.#pt();for(const l of this.#i.values())l.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const l of this.#i.values())l.addStandaloneCommentButton();t===It.SIGNATURE&&await this.#P?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const l of this.#r.values())l.updateMode(t);if(t===It.POPUP){this.#n||=await this.#Y.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const l=new Set,u=[];for(const h of this.#i.values()){const{annotationElementId:d,hasComment:p,deleted:m}=h;d&&l.add(d),p&&!m&&u.push(h.getData())}for(const h of this.#n){const{id:d,popupRef:p,contentsObj:m}=h;p&&m?.str&&!l.has(d)&&!this.#m.has(d)&&u.push(h)}this.#l?.showSidebar(u)}if(!i){s&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const l of this.#i.values())l.uid===i?(this.setSelected(l),o?l.editComment():a?l.enterInEditMode():l.focus()):l.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case $t.CREATE:this.currentLayer.addNewEditor(i);return;case $t.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#X||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#A)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const o of this.#i.values())o.editorType===t&&o.show(i);(this.#X?.get($t.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[$t.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#I!==t){this.#I=t;for(const i of this.#r.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#r.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#pt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#st(t){const i=this.#r.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#A);return t}updateUI(t){this.#gt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#A.has(t)){this.#A.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#A.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#h?.commitOrRemove();for(const i of this.#A)i!==t&&i.unselect();this.#A.clear(),this.#A.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#A.has(t)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(t){t.unselect(),this.#A.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#O({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Z()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Z()})}addCommands(t){this.#c.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Z()})}cleanUndoStack(t){this.#c.cleanType(t)}#Z(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#A],s=()=>{this._editorUndoBar?.show(a,i.length===1?i[0].editorType:i.length);for(const o of i)o.remove()},a=()=>{for(const o of i)this.#st(o)};this.addCommands({cmd:s,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#at(t){for(const i of this.#A)i.unselect();this.#A.clear();for(const i of t)i.isEmpty()||(this.#A.add(i),i.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#A)t.commit();this.#at(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==It.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#A)t.unselect();this.#A.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=i;const[a,o]=this.#j,l=[...this.#A],u=1e3;this.#z&&clearTimeout(this.#z),this.#z=setTimeout(()=>{this.#z=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#i.has(h.id)&&(h.translateInPage(a,o),h.translationDone())},undo:()=>{for(const h of l)this.#i.has(h.id)&&(h.translateInPage(-a,-o),h.translationDone())},mustExec:!1})},u);for(const h of l)h.translateInPage(t,i),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#A)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let i=!1;for(const[{x:a,y:o,pageIndex:l},u]of t)u.newX=a,u.newY=o,u.newPageIndex=l,i||=a!==u.savedX||o!==u.savedY||l!==u.savedPageIndex;if(!i)return!1;const s=(a,o,l,u)=>{if(this.#i.has(a.id)){const h=this.#r.get(u);h?a._setParentAndPosition(h,o,l):(a.pageIndex=u,a.x=o,a.y=l)}};return this.addCommands({cmd:()=>{for(const[a,{newX:o,newY:l,newPageIndex:u}]of t)s(a,o,l,u)},undo:()=>{for(const[a,{savedX:o,savedY:l,savedPageIndex:u}]of t)s(a,o,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#p)for(const s of this.#p.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==It.NONE}get imageManager(){return Ht(this,"imageManager",new _h)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let d=0,p=i.rangeCount;d<p;d++)if(!t.contains(i.getRangeAt(d).commonAncestorContainer))return null;const{x:s,y:a,width:o,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(d,p,m,v)=>({x:(p-a)/l,y:1-(d+m-s)/o,width:v/l,height:m/o});break;case"180":u=(d,p,m,v)=>({x:1-(d+m-s)/o,y:1-(p+v-a)/l,width:m/o,height:v/l});break;case"270":u=(d,p,m,v)=>({x:1-(p+v-a)/l,y:(d-s)/o,width:v/l,height:m/o});break;default:u=(d,p,m,v)=>({x:(d-s)/o,y:(p-a)/l,width:m/o,height:v/l});break}const h=[];for(let d=0,p=i.rangeCount;d<p;d++){const m=i.getRangeAt(d);if(!m.collapsed)for(const{x:v,y:b,width:A,height:_}of m.getClientRects())A===0||_===0||h.push(u(v,b,A,_))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#o||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const i=this.#o?.get(t.data.id);if(!i)return;const s=this.#a.getRawValue(i);s&&(this.#T===It.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const a=this.#B?.get(t);a&&(a.setCanvas(i,s),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class $i{#t=null;#e=!1;#n=null;#i=null;#r=null;#s=null;#a=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,$i.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){$i._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",$i.#f.missing),i.setAttribute("data-l10n-id",$i.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",Ni,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#a=!0,a(o))},{signal:s}),await this.#p(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await $i._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const i=this.#o=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#o.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#l===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:a,cancel:o=!1}){s&&(this.#l=s,this.#d=a),!(this.#t===t&&this.#e===i)&&(o||(this.#t=t,this.#e=i),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",$i.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",$i.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const a=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#r?.classList.remove("show")},{signal:o})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class el{#t=null;#e=null;#n=!1;#i=null;#r=null;#s=null;#a=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const a=this.#i.commentButtonColor;a&&(s.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#i.parent.boundingClientRect;return[(t-a)/l,(i+s-o)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",Ni,{signal:s}),i&&(t.addEventListener("focusin",o=>{this.#i._focusEventsAllowed=!1,ve(o)},{capture:!0,signal:s}),t.addEventListener("focusout",o=>{this.#i._focusEventsAllowed=!0,ve(o)},{capture:!0,signal:s})),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#n=!0,a(o))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,a;if(i)[s,a]=i;else{[s,a]=this.#i.commentButtonPosition;const{width:p,height:m,x:v,y:b}=this.#i;s=v+s*p,a=b+a*m}const o=this.#i.parent.boundingClientRect,{x:l,y:u,width:h,height:d}=o;this.#i._uiManager.editComment(this.#i,l+s*h,u+a*d,{...t,parentDimensions:o})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#a===""}isEmpty(){return this.#a===null}hasBeenEdited(){return this.isDeleted()||this.#a!==this.#r}serialize(){return this.data}get data(){return{text:this.#a,richText:this.#s,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#a&&(this.#s=null),t===null){this.#a="",this.#c=!0;return}this.#a=t,this.#o=new Date,this.#c=!1}setInitialText(t,i=null){this.#r=t,this.data=t,this.#o=null,this.#s=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#a="",this.#s=null,this.#o=null,this.#i=null,this.#n=!1,this.#c=!1}}class El{#t;#e=!1;#n=null;#i;#r;#s;#a;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:a=null,onPinching:o=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#r=a,this.#s=o,this.#a=l,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ki.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,o=AbortSignal.any([this.#c,a.signal]),l=this.#t,u={capture:!0,signal:o,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(ve(d),h(d))},u),l.addEventListener("pointerup",h,u),l.addEventListener("pointercancel",h,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),o=this.#t,l={signal:a,capture:!1,passive:!1};o.addEventListener("touchmove",this.#m.bind(this),l);const u=this.#p.bind(this);o.addEventListener("touchend",u,l),o.addEventListener("touchcancel",u,l),l.capture=!0,o.addEventListener("pointerdown",ve,l),o.addEventListener("pointermove",ve,l),o.addEventListener("pointercancel",ve,l),o.addEventListener("pointerup",ve,l),this.#r?.()}if(ve(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#l={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;ve(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:a,screenY:o}=i,{screenX:l,screenY:u}=s,h=this.#l,{touch0X:d,touch0Y:p,touch1X:m,touch1Y:v}=h,b=m-d,A=v-p,_=l-a,w=u-o,S=Math.hypot(_,w)||1,T=Math.hypot(b,A)||1;if(!this.#e&&Math.abs(T-S)<=El.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=a,h.touch0Y=o,h.touch1X=l,h.touch1Y=u,!this.#e){this.#e=!0;return}const M=[(a+l)/2,(o+u)/2];this.#s?.(M,T,S)}#p(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#a?.()),this.#l&&(ve(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Ot{#t=null;#e=null;#n=null;#i=null;#r=null;#s=!1;#a=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#p=!1;#u=null;#g=!1;#y=!1;#v=!1;#b=null;#C=0;#w=0;#_=null;#x=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#E=Ot._zIndex++;static _borderLineWidth=-1;static _colorManager=new Ah;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Ot.prototype._resizeWithKeyboard,i=$n.TRANSLATE_SMALL,s=$n.TRANSLATE_BIG;return Ht(this,"_resizerKeyboardManager",new Lr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],Ot.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null;const{rotation:i,rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,a],this.pageTranslation=[o,l];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ht(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new pv({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(Ot._l10n??=t,Ot._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Ot._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);Ot._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){le("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#z(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,a){const[o,l]=this.parentDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(t+s)/o,this.y=(i+a)/l,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,a]=this.parentDimensions;this.setAt(t*s,i*a,this.width*s,this.height*a),this._onTranslated()}#D([t,i],s,a){[s,a]=this.screenToPageTranslation(s,a),this.x+=s/t,this.y+=a/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#D(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[a,o]}=this;if(this.x+=t/a,this.y+=i/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[h,d]=this.getBaseTranslation();l+=h,u+=d;const{style:p}=s;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=Ot,a=s/t,o=s/i;switch(this.rotation){case 90:return[-a,o];case 180:return[a,o];case 270:return[a,-o];default:return[-a,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,a]}=this;let{x:o,y:l,width:u,height:h}=this;if(u*=s,h*=a,o*=s,l*=a,this._mustFixPosition)switch(t){case 0:o=Ke(o,0,s-u),l=Ke(l,0,a-h);break;case 90:o=Ke(o,0,s-h),l=Ke(l,u,a);break;case 180:o=Ke(o,u,s),l=Ke(l,h,a);break;case 270:o=Ke(o,h,s),l=Ke(l,0,a-u);break}this.x=o/=s,this.y=l/=a;const[d,p]=this.getBaseTranslation();o+=d,l+=p,i.left=`${(100*o).toFixed(2)}%`,i.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return Ot.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return Ot.#M(t,i,360-this.parentRotation)}#R(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#I(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",s),a.setAttribute("data-resizer-name",s),a.addEventListener("pointerdown",this.#k.bind(this,s),{signal:i}),a.addEventListener("contextmenu",Ni,{signal:i}),a.tabIndex=-1}this.div.prepend(this.#c)}#k(t,i){i.preventDefault();const{isMac:s}=Ge.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[i.screenX,i.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",ve,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ni,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const d=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#F()};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}#L(t,i,s,a){this.width=s,this.height=a,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:a}=this.#d;this.#d=null;const o=this.x,l=this.y,u=this.width,h=this.height;o===t&&l===i&&u===s&&h===a||this.addCommands({cmd:this.#L.bind(this,o,l,u,h),undo:this.#L.bind(this,t,i,s,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[s,a]=this.parentDimensions,o=this.x,l=this.y,u=this.width,h=this.height,d=Ot.MIN_SIZE/s,p=Ot.MIN_SIZE/a,m=this.#R(this.rotation),v=(U,H)=>[m[0]*U+m[2]*H,m[1]*U+m[3]*H],b=this.#R(360-this.rotation),A=(U,H)=>[b[0]*U+b[2]*H,b[1]*U+b[3]*H];let _,w,S=!1,T=!1;switch(t){case"topLeft":S=!0,_=(U,H)=>[0,0],w=(U,H)=>[U,H];break;case"topMiddle":_=(U,H)=>[U/2,0],w=(U,H)=>[U/2,H];break;case"topRight":S=!0,_=(U,H)=>[U,0],w=(U,H)=>[0,H];break;case"middleRight":T=!0,_=(U,H)=>[U,H/2],w=(U,H)=>[0,H/2];break;case"bottomRight":S=!0,_=(U,H)=>[U,H],w=(U,H)=>[0,0];break;case"bottomMiddle":_=(U,H)=>[U/2,H],w=(U,H)=>[U/2,0];break;case"bottomLeft":S=!0,_=(U,H)=>[0,H],w=(U,H)=>[U,0];break;case"middleLeft":T=!0,_=(U,H)=>[0,H/2],w=(U,H)=>[U,H/2];break}const M=_(u,h),k=w(u,h);let O=v(...k);const z=Ot._round(o+O[0]),L=Ot._round(l+O[1]);let G=1,j=1,Z,ot;if(i.fromKeyboard)({deltaX:Z,deltaY:ot}=i);else{const{screenX:U,screenY:H}=i,[ct,st]=this.#l;[Z,ot]=this.screenToPageTranslation(U-ct,H-st),this.#l[0]=U,this.#l[1]=H}if([Z,ot]=A(Z/s,ot/a),S){const U=Math.hypot(u,h);G=j=Math.max(Math.min(Math.hypot(k[0]-M[0]-Z,k[1]-M[1]-ot)/U,1/u,1/h),d/u,p/h)}else T?G=Ke(Math.abs(k[0]-M[0]-Z),d,1)/u:j=Ke(Math.abs(k[1]-M[1]-ot),p,1)/h;const I=Ot._round(u*G),X=Ot._round(h*j);O=v(...w(I,X));const x=z-O[0],tt=L-O[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=I,this.height=X,this.x=x,this.y=tt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new Ar(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||($i.initialize(Ot._l10n),this.#n=new $i(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.#i||=new el(this)}addStandaloneCommentButton(){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:i,date:s,deleted:a}}=this.#i;return{text:i,richText:t,date:s,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new el(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new el(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new el(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,u=l+o+1,h=a-100,d=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,d,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#s?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#H();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[a,o]=this.getInitialTranslation();return this.translate(a,o),jm(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#x||=new El({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#A.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,i,s){let o=.7*(s/i)+1-.7;if(o===1)return;const l=this.#R(this.rotation),u=(z,L)=>[l[0]*z+l[2]*L,l[1]*z+l[3]*L],[h,d]=this.parentDimensions,p=this.x,m=this.y,v=this.width,b=this.height,A=Ot.MIN_SIZE/h,_=Ot.MIN_SIZE/d;o=Math.max(Math.min(o,1/v,1/b),A/v,_/b);const w=Ot._round(v*o),S=Ot._round(b*o);if(w===v&&S===b)return;this.#u||=[p,m,v,b];const T=u(v/2,b/2),M=Ot._round(p+T[0]),k=Ot._round(m+T[1]),O=u(w/2,S/2);this.x=M-O[0],this.y=k-O[1],this.width=w,this.height=S,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#A(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:i}=Ge.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#P(t);return}this.#N(t)}#N(t){const{isMac:i}=Ge.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#P(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const a=new AbortController,o=this._uiManager.combinedSignal(a),l={capture:!0,passive:!1,signal:o},u=d=>{a.abort(),this.#a=null,this.#p=!1,this._uiManager.endDragSession()||this.#N(d),s&&this._onStopDragging()};i&&(this.#C=t.clientX,this.#w=t.clientY,this.#a=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",d=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:m,pointerId:v}=d;if(v!==this.#a){ve(d);return}const[b,A]=this.screenToPageTranslation(p-this.#C,m-this.#w);this.#C=p,this.#w=m,this._uiManager.dragSelectedEditors(b,A)},l),window.addEventListener("touchmove",ve,l),window.addEventListener("pointerdown",d=>{d.pointerType===this.#o&&(this.#x||d.isPrimary)&&u(d),ve(d)},l));const h=d=>{if(!this.#a||this.#a===d.pointerId){u(d);return}ve(d)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const a=this.parentScale,[o,l]=this.pageDimensions,[u,h]=this.pageTranslation,d=t/a,p=i/a,m=this.x*o,v=this.y*l,b=this.width*o,A=this.height*l;switch(s){case 0:return[m+d+u,l-v-p-A+h,m+d+b+u,l-v-p+h];case 90:return[m+p+u,l-v+d+h,m+p+A+u,l-v+d+b+h];case 180:return[m-d-b+u,l-v+p+h,m-d+u,l-v+p+A+h];case 270:return[m-p-A+u,l-v-d-b+h,m-p+u,l-v-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,a,o,l]=t,u=o-s,h=l-a;switch(this.rotation){case 0:return[s,i-l,u,h];case 90:return[s,i-a,h,u];case 180:return[o,i-a,u,h];case 270:return[o,i-l,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Ot._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:a,deleted:o,richText:l},uid:u,pageIndex:h,creationDate:d,modificationDate:p}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:d,modificationDate:s||p,popupRef:!o,color:i,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:a}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return i<l&&a>0&&t<o&&s>0}#H(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#H()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const a=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[o,l]=a.pageDimensions,[u,h,d,p]=a.getRectInCurrentCoords(t.rect,l);return a.x=u/o,a.y=h/l,a.width=d/o,a.height=p/l,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#z(),this.removeEditToolbar(),this.#_){for(const t of this.#_.values())clearTimeout(t);this.#_=null}this.parent=null,this.#x?.destroy(),this.#x=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#I(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,a,o,l]=this.getPDFRect();return[Ot._round(s+(o-s)*t),Ot._round(a+(l-a)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const l=this.#X.bind(this),u=this.#Y.bind(this),h=this._uiManager._signal;for(const d of this.#e){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",l,{signal:h}),d.addEventListener("blur",u,{signal:h}),d.addEventListener("focus",this.#$.bind(this,p),{signal:h}),d.setAttribute("data-l10n-id",Ot._l10nResizer[p])}}const s=this.#e[0];let a=0;for(const l of i){if(l===s)break;a++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==a){if(o<a)for(let u=0;u<a-o;u++)this.#c.append(this.#c.firstChild);else if(o>a)for(let u=0;u<o-a;u++)this.#c.firstChild.before(this.#c.lastChild);let l=0;for(const u of i){const d=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Ot._l10nResizer[d])}}this.#j(0),this.#v=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#X(t){Ot._resizerKeyboardManager.exec(this,t)}#Y(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#z()}#$(t){this.#m=this.#v?t:""}#j(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#m,{deltaX:t,deltaY:i,fromKeyboard:!0})}#z(){this.#v=!1,this.#j(-1),this.#F()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#_||=new Map;const{action:s}=t;let a=this.#_.get(s);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#_.delete(s),this.#_.size===0&&(this.#_=null)},Ot._telemetryTimeout),this.#_.set(s,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class pv extends Ot{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Zg=3285377520,Di=4294901760,Yi=65535;class Gm{constructor(t){this.h1=t?t&4294967295:Zg,this.h2=t?t&4294967295:Zg}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let _=0,w=t.length;_<w;_++){const S=t.charCodeAt(_);S<=255?i[s++]=S:(i[s++]=S>>>8,i[s++]=S&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=s>>2,o=s-a*4,l=new Uint32Array(i.buffer,0,a);let u=0,h=0,d=this.h1,p=this.h2;const m=3432918353,v=461845907,b=m&Yi,A=v&Yi;for(let _=0;_<a;_++)_&1?(u=l[_],u=u*m&Di|u*b&Yi,u=u<<15|u>>>17,u=u*v&Di|u*A&Yi,d^=u,d=d<<13|d>>>19,d=d*5+3864292196):(h=l[_],h=h*m&Di|h*b&Yi,h=h<<15|h>>>17,h=h*v&Di|h*A&Yi,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,o){case 3:u^=i[a*4+2]<<16;case 2:u^=i[a*4+1]<<8;case 1:u^=i[a*4],u=u*m&Di|u*b&Yi,u=u<<15|u>>>17,u=u*v&Di|u*A&Yi,a&1?d^=u:p^=u}this.h1=d,this.h2=p}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&Di|t*36045&Yi,i=i*4283543511&Di|((i<<16|t>>>16)*2950163797&Di)>>>16,t^=i>>>1,t=t*444984403&Di|t*60499&Yi,i=i*3301882366&Di|((i<<16|t>>>16)*3120437893&Di)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const lh=Object.freeze({map:null,hash:"",transfer:void 0});class Sh{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof Ot&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof Ot)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let a=!1;if(s!==void 0)for(const[o,l]of Object.entries(i))s[o]!==l&&(a=!0,s[o]=l);else a=!0,this.#i.set(t,i);a&&this.#r(),i instanceof Ot&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new qm(this)}get serializable(){if(this.#i.size===0)return lh;const t=new Map,i=new Gm,s=[],a=Object.create(null);let o=!1;for(const[l,u]of this.#i){const h=u instanceof Ot?u.serialize(!1,a):u;h&&(t.set(l,h),i.update(`${l}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const l of t.values())l.bitmap&&s.push(l.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:lh}get editorStats(){let t=null;const i=new Map;let s=0,a=0;for(const o of this.#i.values()){if(!(o instanceof Ot)){o.popup&&(o.popup.deleted?a+=1:s+=1);continue}o.isCommentDeleted?a+=1:o.hasEditedComment&&(s+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:u}=l;i.has(u)||i.set(u,Object.getPrototypeOf(o).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[d,p]of Object.entries(l)){if(d==="type")continue;let m=h.get(d);m||(m=new Map,h.set(d,m));const v=m.get(p)??0;m.set(p,v+1)}}if((a>0||s>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:s}),!t)return null;for(const[o,l]of i)t[o]=l.computeTelemetryFinalData(t[o]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class qm extends Sh{#t;constructor(t){super();const{map:i,hash:s,transfer:a}=t.serializable,o=structuredClone(i,a?{transfer:a}:null);this.#t={map:o,hash:s,transfer:a}}get print(){le("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Ht(this,"modifiedIds",{ids:new Set,hash:""})}}class gv{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Kt(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:o,style:l}=t,u=new FontFace(a,o,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),s?.(t)}catch{zt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}le("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(a){throw zt(`Failed to load font '${s.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const a=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Ht(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Ht(this,"isSyncFontLoadingSupported",$e||Ge.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Kt(!a.done,"completeRequest() cannot be called twice."),a.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,a={done:!1,complete:i,callback:t};return s.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ht(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(k,O){return k.charCodeAt(O)<<24|k.charCodeAt(O+1)<<16|k.charCodeAt(O+2)<<8|k.charCodeAt(O+3)&255}function a(k,O,z,L){const G=k.substring(0,O),j=k.substring(O+z);return G+L+j}let o,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let d=0;function p(k,O){if(++d>30){zt("Load test font never loaded."),O();return}if(h.font="30px "+k,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(p.bind(null,k,O))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=a(v,976,m.length,m);const A=16,_=1482184792;let w=s(v,A);for(o=0,l=m.length-3;o<l;o+=4)w=w-_+s(m,o)|0;o<m.length&&(w=w-_+s(m+"XXX",o)|0),v=a(v,A,4,Kb(w));const S=`url(data:font/opentype;base64,${btoa(v)});`,T=`@font-face {font-family:"${m}";src:${S}}`;this.insertRule(T);const M=this._document.createElement("div");M.style.visibility="hidden",M.style.width=M.style.height="10px",M.style.position="absolute",M.style.top=M.style.left="0px";for(const k of[t.loadedName,m]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=k,M.append(O)}this._document.body.append(M),p(m,()=>{M.remove(),i.complete()})}}class mv{#t;constructor(t,i=null,s,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Pm(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let a;try{a=t.get(s)}catch(l){zt(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(a||"");return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=o}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}function yv(g){if(g instanceof URL)return g.href;if(typeof g=="string"){if($e)return g;const t=URL.parse(g,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function bv(g){if($e&&typeof Buffer<"u"&&g instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength)return g;if(typeof g=="string")return Dr(g);if(g instanceof ArrayBuffer||ArrayBuffer.isView(g)||typeof g=="object"&&!isNaN(g?.length))return new Uint8Array(g);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function il(g){if(typeof g!="string")return null;if(g.endsWith("/"))return g;throw new Error(`Invalid factory url: "${g}" must include trailing slash.`)}const ch=g=>typeof g=="object"&&Number.isInteger(g?.num)&&g.num>=0&&Number.isInteger(g?.gen)&&g.gen>=0,vv=g=>typeof g=="object"&&typeof g?.name=="string",_v=tv.bind(null,ch,vv);class Av{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,s)})}addEventListener(t,i,s=null){let a=null;if(s?.signal instanceof AbortSignal){const{signal:o}=s;if(o.aborted){zt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,i);a=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(i,a)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const nl={DATA:1,ERROR:2},xe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Wg(){}function ri(g){if(g instanceof Xn||g instanceof sh||g instanceof Gg||g instanceof ml||g instanceof Ku)return g;switch(g instanceof Error||typeof g=="object"&&g!==null||le('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),g.name){case"AbortException":return new Xn(g.message);case"InvalidPDFException":return new sh(g.message);case"PasswordException":return new Gg(g.message,g.code);case"ResponseException":return new ml(g.message,g.status,g.missing);case"UnknownErrorException":return new Ku(g.message,g.details)}return new Ku(g.message,g.toString())}class vr{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,a=this.callbackCapabilities[s];if(!a)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===nl.DATA)a.resolve(t.data);else if(t.callback===nl.ERROR)a.reject(ri(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,a=t.sourceName,o=this.comObj;Promise.try(i,t.data).then(function(l){o.postMessage({sourceName:s,targetName:a,callback:nl.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:s,targetName:a,callback:nl.ERROR,callbackId:t.callbackId,reason:ri(l)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const a=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[a]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:i},s)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,i,s,a){const o=this.streamId++,l=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[o]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:u,action:t,streamId:o,data:i,desiredSize:d.desiredSize},a),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[o].pullCall=p,h.postMessage({sourceName:l,targetName:u,stream:xe.PULL,streamId:o,desiredSize:d.desiredSize}),p.promise},cancel:d=>{Kt(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[o].cancelCall=p,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:u,stream:xe.CANCEL,streamId:o,reason:ri(d)}),p.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this,u=this.actionHandler[t.action],h={enqueue(d,p=1,m){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:a,stream:xe.ENQUEUE,streamId:i,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:xe.CLOSE,streamId:i}),delete l.streamSinks[i])},error(d){Kt(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:xe.ERROR,streamId:i,reason:ri(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,Promise.try(u,t.data,h).then(function(){o.postMessage({sourceName:s,targetName:a,stream:xe.START_COMPLETE,streamId:i,success:!0})},function(d){o.postMessage({sourceName:s,targetName:a,stream:xe.START_COMPLETE,streamId:i,reason:ri(d)})})}#i(t){const i=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case xe.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(ri(t.reason));break;case xe.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(ri(t.reason));break;case xe.PULL:if(!u){o.postMessage({sourceName:s,targetName:a,stream:xe.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Wg).then(function(){o.postMessage({sourceName:s,targetName:a,stream:xe.PULL_COMPLETE,streamId:i,success:!0})},function(d){o.postMessage({sourceName:s,targetName:a,stream:xe.PULL_COMPLETE,streamId:i,reason:ri(d)})});break;case xe.ENQUEUE:if(Kt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case xe.CLOSE:if(Kt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#r(l,i);break;case xe.ERROR:Kt(l,"error should have stream controller"),l.controller.error(ri(t.reason)),this.#r(l,i);break;case xe.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(ri(t.reason)),this.#r(l,i);break;case xe.CANCEL:if(!u)break;const h=ri(t.reason);Promise.try(u.onCancel||Wg,h).then(function(){o.postMessage({sourceName:s,targetName:a,stream:xe.CANCEL_COMPLETE,streamId:i,success:!0})},function(d){o.postMessage({sourceName:s,targetName:a,stream:xe.CANCEL_COMPLETE,streamId:i,reason:ri(d)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#r(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class Vm{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){le("Abstract method `_createCanvas` called.")}}class Sv extends Vm{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class Ym{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){le("Abstract method `_fetch` called.")}}class Qg extends Ym{async _fetch(t){const i=await Or(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):Dr(i)}}class Xm{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,a,o){return"none"}destroy(t=!1){}}class wv extends Xm{#t;#e;#n;#i;#r;#s;#a=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#r=i}get#o(){return this.#e||=new Map}get#c(){return this.#s||=new Map}get#l(){if(!this.#n){const t=this.#r.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#r.createElementNS(gn,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(gn,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],d=new Array(256);for(let m=0;m<256;m++)d[m]=h[m]/255;const p=d.join(",");return[p,p,p]}const[i,s,a]=t,o=new Array(256),l=new Array(256),u=new Array(256);for(let h=0;h<256;h++)o[h]=i[h]/255,l[h]=s[h]/255,u[h]=a[h]/255;return[o.join(","),l.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#r.URL;i!==this.#r.baseURI&&(wl(i)?zt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=zm(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#o.get(t);if(i)return i;const[s,a,o]=this.#d(t),l=t.length===1?s:`${s}${a}${o}`;if(i=this.#o.get(l),i)return this.#o.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#a++}`,h=this.#h(u);this.#o.set(t,h),this.#o.set(l,h);const d=this.#p(u);return this.#g(s,a,o,d),h}addHCMFilter(t,i){const s=`${t}-${i}`,a="base";let o=this.#c.get(a);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#c.set(a,o)),!t||!i))return o.url;const l=this.#v(t);t=Ct.makeHexColor(...l);const u=this.#v(i);if(i=Ct.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return o.url;const h=new Array(256);for(let b=0;b<=255;b++){const A=b/255;h[b]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const d=h.join(","),p=`g_${this.#i}_hcm_filter`,m=o.filter=this.#p(p);this.#g(d,d,d,m),this.#m(m);const v=(b,A)=>{const _=l[b]/255,w=u[b]/255,S=new Array(A+1);for(let T=0;T<=A;T++)S[T]=_+T/A*(w-_);return S.join(",")};return this.#g(v(0,5),v(1,5),v(2,5),m),o.url=this.#h(p),o.url}addAlphaFilter(t){let i=this.#o.get(t);if(i)return i;const[s]=this.#d([t]),a=`alpha_${s}`;if(i=this.#o.get(a),i)return this.#o.set(t,i),i;const o=`g_${this.#i}_alpha_map_${this.#a++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#p(o);return this.#y(s,u),l}addLuminosityFilter(t){let i=this.#o.get(t||"luminosity");if(i)return i;let s,a;if(t?([s]=this.#d([t]),a=`luminosity_${s}`):a="luminosity",i=this.#o.get(a),i)return this.#o.set(t,i),i;const o=`g_${this.#i}_luminosity_map_${this.#a++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#p(o);return this.#f(u),t&&this.#y(s,u),l}addHighlightHCMFilter(t,i,s,a,o){const l=`${i}-${s}-${a}-${o}`;let u=this.#c.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[h,d]=[i,s].map(this.#v.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[v,b]=[a,o].map(this.#v.bind(this));m<p&&([p,m,v,b]=[m,p,b,v]),this.#l.style.color="";const A=(S,T,M)=>{const k=new Array(256),O=(m-p)/M,z=S/255,L=(T-S)/(255*M);let G=0;for(let j=0;j<=M;j++){const Z=Math.round(p+j*O),ot=z+j*L;for(let I=G;I<=Z;I++)k[I]=ot;G=Z+1}for(let j=G;j<256;j++)k[j]=k[G-1];return k.join(",")},_=`g_${this.#i}_hcm_${t}_filter`,w=u.filter=this.#p(_);return this.#m(w),this.#g(A(v[0],b[0],5),A(v[1],b[1],5),A(v[2],b[2],5),w),u.url=this.#h(_),u.url}destroy(t=!1){t&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#a=0)}#f(t){const i=this.#r.createElementNS(gn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#m(t){const i=this.#r.createElementNS(gn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#p(t){const i=this.#r.createElementNS(gn,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#l.append(i),i}#u(t,i,s){const a=this.#r.createElementNS(gn,i);a.setAttribute("type","discrete"),a.setAttribute("tableValues",s),t.append(a)}#g(t,i,s,a){const o=this.#r.createElementNS(gn,"feComponentTransfer");a.append(o),this.#u(o,"feFuncR",t),this.#u(o,"feFuncG",i),this.#u(o,"feFuncB",s)}#y(t,i){const s=this.#r.createElementNS(gn,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#l.style.color=t,Nr(getComputedStyle(this.#l).getPropertyValue("color"))}}class $m{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){le("Abstract method `_fetch` called.")}}class Jg extends $m{async _fetch(t){const i=await Or(t,"arraybuffer");return new Uint8Array(i)}}class Km{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){le("Abstract method `_fetch` called.")}}class tm extends Km{async _fetch(t){const i=await Or(t,"arraybuffer");return new Uint8Array(i)}}$e&&zt("Please use the `legacy` build in Node.js environments.");async function wh(g){const i=await process.getBuiltinModule("fs").promises.readFile(g);return new Uint8Array(i)}class Ev extends Xm{}class Cv extends Vm{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class Tv extends Ym{async _fetch(t){return wh(t)}}class xv extends $m{async _fetch(t){return wh(t)}}class Mv extends Km{async _fetch(t){return wh(t)}}const la="__forcedDependency",{floor:em,ceil:im}=Math;function sl(g,t,i,s,a,o){g[t*4+0]=Math.min(g[t*4+0],i),g[t*4+1]=Math.min(g[t*4+1],s),g[t*4+2]=Math.max(g[t*4+2],a),g[t*4+3]=Math.max(g[t*4+3],o)}const uh=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class Rv{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===uh}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const al=(g,t)=>{if(!g)return;let i=g.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},g.set(t,i)),i};class Dv{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[la]:[]};#n=new Map;#i=[];#r=[];#s=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#p;#u;#g;constructor(t,i,s=!1){this.#f=t.width,this.#m=t.height,this.#y(i),s&&(this.#g=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,i){const s=new ArrayBuffer(t*4);this.#p=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(uh,i.length)):this.#u.fill(uh)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[la]:{__proto__:this.#e[la]}},this.#a={__proto__:this.#a},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const s=this.#i.pop();return s!==void 0&&(al(this.#g,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(al(this.#g,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const i=this.#r.pop();return i!==void 0&&(al(this.#g,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#s.push(Ct.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(la,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(la,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,i,s,a,o,l){const u=Ct.multiplyByDOMMatrix(this.#s.at(-1),i.getTransform()),h=[1/0,1/0,-1/0,-1/0];Ct.axialAlignedBoundingBox([s,o,a,l],u,h);const d=Ct.intersect(this.#a,h);return d?(this.#a[0]=d[0],this.#a[1]=d[1],this.#a[2]=d[2],this.#a[3]=d[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,i,s,a,o,l){const u=this.#a;if(u[0]===1/0)return this;const h=Ct.multiplyByDOMMatrix(this.#s.at(-1),i.getTransform());if(u[0]===-1/0)return Ct.axialAlignedBoundingBox([s,o,a,l],h,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return Ct.axialAlignedBoundingBox([s,o,a,l],h,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],u[3])),this}recordCharacterBBox(t,i,s,a=1,o=0,l=0,u){const h=s.bbox;let d,p;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(s),d!==!1&&(p=[0,0,0,0],Ct.axialAlignedBoundingBox(h,s.fontMatrix,p),(a!==1||o!==0||l!==0)&&Ct.scaleMinMax([a,0,0,-a,o,l],p),d)))return this.recordBBox(t,i,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const m=u();return h&&p&&d===void 0&&(d=p[0]<=o-m.actualBoundingBoxLeft&&p[2]>=o+m.actualBoundingBoxRight&&p[1]<=l-m.actualBoundingBoxAscent&&p[3]>=l+m.actualBoundingBoxDescent,this.#h.set(s,d),d)?this.recordBBox(t,i,p[0],p[2],p[1],p[3]):this.recordBBox(t,i,o-m.actualBoundingBoxLeft,o+m.actualBoundingBoxRight,l-m.actualBoundingBoxAscent,l+m.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#f,this.#a[2]),this.#o[3]=Math.min(this.#m,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#l,a=this.#t,o=this.#e;for(const l of i)l in this.#t?s.add(a[l]):l in o&&o[l].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#l.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[la]),this.#g){const s=al(this.#g,t),{dependencies:a}=s;this.#l.forEach(a.add,a),this.#i.forEach(a.add,a),this.#r.forEach(a.add,a),a.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=em(this.#o[0]*256/this.#f),a=em(this.#o[1]*256/this.#m),o=im(this.#o[2]*256/this.#f),l=im(this.#o[3]*256/this.#m);sl(this.#p,t,s,a,o,l);for(const u of this.#l)u!==t&&sl(this.#p,u,s,a,o,l);for(const u of this.#i)u!==t&&sl(this.#p,u,s,a,o,l);for(const u of this.#r)u!==t&&sl(this.#p,u,s,a,o,l);i||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#l);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const a of s)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3]),i||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#l.add(i)}take(){return this.#h.clear(),new Rv(this.#u,this.#p)}takeDebugMetadata(){return this.#g}}class yl{#t;#e;#n;#i=0;#r=0;constructor(t,i,s){if(t instanceof yl&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,a,o,l){return this.#n||this.#t.recordClipBox(this.#e,i,s,a,o,l),this}recordBBox(t,i,s,a,o,l){return this.#n||this.#t.recordBBox(this.#e,i,s,a,o,l),this}recordCharacterBBox(t,i,s,a,o,l,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,a,o,l,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Oi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},je={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function hh(g,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],i,s),g.clip(a)}class Eh{isModifyingCurrentTransform(){return!1}getPattern(){le("Abstract method `getPattern` called.")}}class Ov extends Eh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)i.addColorStop(s[0],s[1]);return i}getPattern(t,i,s,a){let o;if(a===je.STROKE||a===je.FILL){const l=i.current.getClippedPathBoundingBox(a,ge(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,d=i.cachedCanvases.getCanvas("pattern",u,h),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),s=Ct.transform(s,[1,0,0,1,l[0],l[1]]),p.transform(...i.baseTransform),this.matrix&&p.transform(...this.matrix),hh(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),o=t.createPattern(d.canvas,"no-repeat");const m=new DOMMatrix(s);o.setTransform(m)}else hh(t,this._bbox),o=this._createGradient(t);return o}}function Qu(g,t,i,s,a,o,l,u){const h=t.coords,d=t.colors,p=g.data,m=g.width*4;let v;h[i+1]>h[s+1]&&(v=i,i=s,s=v,v=o,o=l,l=v),h[s+1]>h[a+1]&&(v=s,s=a,a=v,v=l,l=u,u=v),h[i+1]>h[s+1]&&(v=i,i=s,s=v,v=o,o=l,l=v);const b=(h[i]+t.offsetX)*t.scaleX,A=(h[i+1]+t.offsetY)*t.scaleY,_=(h[s]+t.offsetX)*t.scaleX,w=(h[s+1]+t.offsetY)*t.scaleY,S=(h[a]+t.offsetX)*t.scaleX,T=(h[a+1]+t.offsetY)*t.scaleY;if(A>=T)return;const M=d[o],k=d[o+1],O=d[o+2],z=d[l],L=d[l+1],G=d[l+2],j=d[u],Z=d[u+1],ot=d[u+2],I=Math.round(A),X=Math.round(T);let x,tt,U,H,ct,st,mt,D;for(let B=I;B<=X;B++){if(B<w){const St=B<A?0:(A-B)/(A-w);x=b-(b-_)*St,tt=M-(M-z)*St,U=k-(k-L)*St,H=O-(O-G)*St}else{let St;B>T?St=1:w===T?St=0:St=(w-B)/(w-T),x=_-(_-S)*St,tt=z-(z-j)*St,U=L-(L-Z)*St,H=G-(G-ot)*St}let J;B<A?J=0:B>T?J=1:J=(A-B)/(A-T),ct=b-(b-S)*J,st=M-(M-j)*J,mt=k-(k-Z)*J,D=O-(O-ot)*J;const it=Math.round(Math.min(x,ct)),at=Math.round(Math.max(x,ct));let At=m*B+it*4;for(let St=it;St<=at;St++)J=(x-St)/(x-ct),J<0?J=0:J>1&&(J=1),p[At++]=tt-(tt-st)*J|0,p[At++]=U-(U-mt)*J|0,p[At++]=H-(H-D)*J|0,p[At++]=255}}function kv(g,t,i){const s=t.coords,a=t.colors;let o,l;switch(t.type){case"lattice":const u=t.verticesPerRow,h=Math.floor(s.length/u)-1,d=u-1;for(o=0;o<h;o++){let p=o*u;for(let m=0;m<d;m++,p++)Qu(g,i,s[p],s[p+1],s[p+u],a[p],a[p+1],a[p+u]),Qu(g,i,s[p+u+1],s[p+1],s[p+u],a[p+u+1],a[p+1],a[p+u])}break;case"triangles":for(o=0,l=s.length;o<l;o+=3)Qu(g,i,s[o],s[o+1],s[o+2],a[o],a[o+1],a[o+2]);break;default:throw new Error("illegal figure")}}class Nv extends Eh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,m=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),b=d/m,A=p/v,_={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/b,scaleY:1/A},w=m+4,S=v+4,T=s.getCanvas("mesh",w,S),M=T.context,k=M.createImageData(m,v);if(i){const z=k.data;for(let L=0,G=z.length;L<G;L+=4)z[L]=i[0],z[L+1]=i[1],z[L+2]=i[2],z[L+3]=255}for(const z of this._figures)kv(k,z,_);return M.putImageData(k,2,2),{canvas:T.canvas,offsetX:u-2*b,offsetY:h-2*A,scaleX:b,scaleY:A}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,a){hh(t,this._bbox);const o=new Float32Array(2);if(a===je.SHADING)Ct.singularValueDecompose2dScale(ge(t),o);else if(this.matrix){Ct.singularValueDecompose2dScale(this.matrix,o);const[u,h]=o;Ct.singularValueDecompose2dScale(i.baseTransform,o),o[0]*=u,o[1]*=h}else Ct.singularValueDecompose2dScale(i.baseTransform,o);const l=this._createMeshCanvas(o,a===je.SHADING?null:this._background,i.cachedCanvases);return a!==je.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class Lv extends Eh{getPattern(){return"hotpink"}}function Bv(g){switch(g[0]){case"RadialAxial":return new Ov(g);case"Mesh":return new Nv(g);case"Dummy":return new Lv}throw new Error(`Unknown IR type: ${g[0]}`)}const nm={COLORED:1,UNCOLORED:2};class Ch{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(t,i){const{bbox:s,operatorList:a,paintType:o,tilingType:l,color:u,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:p}=this;d=Math.abs(d),p=Math.abs(p),Sl("TilingType: "+l);const m=s[0],v=s[1],b=s[2],A=s[3],_=b-m,w=A-v,S=new Float32Array(2);Ct.singularValueDecompose2dScale(this.matrix,S);const[T,M]=S;Ct.singularValueDecompose2dScale(this.baseTransform,S);const k=T*S[0],O=M*S[1];let z=_,L=w,G=!1,j=!1;const Z=Math.ceil(d*k),ot=Math.ceil(p*O),I=Math.ceil(_*k),X=Math.ceil(w*O);Z>=I?z=d:G=!0,ot>=X?L=p:j=!0;const x=this.getSizeAndScale(z,this.ctx.canvas.width,k),tt=this.getSizeAndScale(L,this.ctx.canvas.height,O),U=t.cachedCanvases.getCanvas("pattern",x.size,tt.size),H=U.context,ct=h.createCanvasGraphics(H,i);if(ct.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(ct,o,u),H.translate(-x.scale*m,-tt.scale*v),ct.transform(0,x.scale,0,0,tt.scale,0,0),H.save(),ct.dependencyTracker?.save(),this.clipBbox(ct,m,v,b,A),ct.baseTransform=ge(ct.ctx),ct.executeOperatorList(a),ct.endDrawing(),ct.dependencyTracker?.restore(),H.restore(),G||j){const st=U.canvas;G&&(z=d),j&&(L=p);const mt=this.getSizeAndScale(z,this.ctx.canvas.width,k),D=this.getSizeAndScale(L,this.ctx.canvas.height,O),B=mt.size,J=D.size,it=t.cachedCanvases.getCanvas("pattern-workaround",B,J),at=it.context,At=G?Math.floor(_/d):0,St=j?Math.floor(w/p):0;for(let Mt=0;Mt<=At;Mt++)for(let xt=0;xt<=St;xt++)at.drawImage(st,B*Mt,J*xt,B,J,0,0,B,J);return{canvas:it.canvas,scaleX:mt.scale,scaleY:D.scale,offsetX:m,offsetY:v}}return{canvas:U.canvas,scaleX:x.scale,scaleY:tt.scale,offsetX:m,offsetY:v}}getSizeAndScale(t,i,s){const a=Math.max(Ch.MAX_PATTERN_SIZE,i);let o=Math.ceil(t*s);return o>=a?o=a:s=o/t,{scale:s,size:o}}clipBbox(t,i,s,a,o){const l=a-i,u=o-s;t.ctx.rect(i,s,l,u),Ct.axialAlignedBoundingBox([i,s,a,o],ge(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const a=t.ctx,o=t.current;switch(i){case nm.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;a.fillStyle=o.fillColor=l,a.strokeStyle=o.strokeColor=u;break;case nm.UNCOLORED:a.fillStyle=a.strokeStyle=s,o.fillColor=o.strokeColor=s;break;default:throw new $b(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,a,o){let l=s;a!==je.SHADING&&(l=Ct.transform(l,i.baseTransform),this.matrix&&(l=Ct.transform(l,this.matrix)));const u=this.createPatternCanvas(i,o);let h=new DOMMatrix(l);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const d=t.createPattern(u.canvas,"repeat");return d.setTransform(h),d}}function zv({src:g,srcPos:t=0,dest:i,width:s,height:a,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const u=Ge.isLittleEndian?4278190080:255,[h,d]=l?[o,u]:[u,o],p=s>>3,m=s&7,v=g.length;i=new Uint32Array(i.buffer);let b=0;for(let A=0;A<a;A++){for(const w=t+p;t<w;t++){const S=t<v?g[t]:255;i[b++]=S&128?d:h,i[b++]=S&64?d:h,i[b++]=S&32?d:h,i[b++]=S&16?d:h,i[b++]=S&8?d:h,i[b++]=S&4?d:h,i[b++]=S&2?d:h,i[b++]=S&1?d:h}if(m===0)continue;const _=t<v?g[t++]:255;for(let w=0;w<m;w++)i[b++]=_&1<<7-w?d:h}return{srcPos:t,destPos:b}}const sm=16,am=100,Iv=15,rm=10,oi=16,Ju=new DOMMatrix,mi=new Float32Array(2),fa=new Float32Array([1/0,1/0,-1/0,-1/0]);function Fv(g,t){if(g._removeMirroring)throw new Error("Context is already forwarding operations.");g.__originalSave=g.save,g.__originalRestore=g.restore,g.__originalRotate=g.rotate,g.__originalScale=g.scale,g.__originalTranslate=g.translate,g.__originalTransform=g.transform,g.__originalSetTransform=g.setTransform,g.__originalResetTransform=g.resetTransform,g.__originalClip=g.clip,g.__originalMoveTo=g.moveTo,g.__originalLineTo=g.lineTo,g.__originalBezierCurveTo=g.bezierCurveTo,g.__originalRect=g.rect,g.__originalClosePath=g.closePath,g.__originalBeginPath=g.beginPath,g._removeMirroring=()=>{g.save=g.__originalSave,g.restore=g.__originalRestore,g.rotate=g.__originalRotate,g.scale=g.__originalScale,g.translate=g.__originalTranslate,g.transform=g.__originalTransform,g.setTransform=g.__originalSetTransform,g.resetTransform=g.__originalResetTransform,g.clip=g.__originalClip,g.moveTo=g.__originalMoveTo,g.lineTo=g.__originalLineTo,g.bezierCurveTo=g.__originalBezierCurveTo,g.rect=g.__originalRect,g.closePath=g.__originalClosePath,g.beginPath=g.__originalBeginPath,delete g._removeMirroring},g.save=function(){t.save(),this.__originalSave()},g.restore=function(){t.restore(),this.__originalRestore()},g.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},g.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},g.transform=function(i,s,a,o,l,u){t.transform(i,s,a,o,l,u),this.__originalTransform(i,s,a,o,l,u)},g.setTransform=function(i,s,a,o,l,u){t.setTransform(i,s,a,o,l,u),this.__originalSetTransform(i,s,a,o,l,u)},g.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},g.rotate=function(i){t.rotate(i),this.__originalRotate(i)},g.clip=function(i){t.clip(i),this.__originalClip(i)},g.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},g.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},g.bezierCurveTo=function(i,s,a,o,l,u){t.bezierCurveTo(i,s,a,o,l,u),this.__originalBezierCurveTo(i,s,a,o,l,u)},g.rect=function(i,s,a,o){t.rect(i,s,a,o),this.__originalRect(i,s,a,o)},g.closePath=function(){t.closePath(),this.__originalClosePath()},g.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Pv{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,i,s)):(a=this.canvasFactory.create(i,s),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function rl(g,t,i,s,a,o,l,u,h,d){const[p,m,v,b,A,_]=ge(g);if(m===0&&v===0){const T=l*p+A,M=Math.round(T),k=u*b+_,O=Math.round(k),z=(l+h)*p+A,L=Math.abs(Math.round(z)-M)||1,G=(u+d)*b+_,j=Math.abs(Math.round(G)-O)||1;return g.setTransform(Math.sign(p),0,0,Math.sign(b),M,O),g.drawImage(t,i,s,a,o,0,0,L,j),g.setTransform(p,m,v,b,A,_),[L,j]}if(p===0&&b===0){const T=u*v+A,M=Math.round(T),k=l*m+_,O=Math.round(k),z=(u+d)*v+A,L=Math.abs(Math.round(z)-M)||1,G=(l+h)*m+_,j=Math.abs(Math.round(G)-O)||1;return g.setTransform(0,Math.sign(m),Math.sign(v),0,M,O),g.drawImage(t,i,s,a,o,0,0,j,L),g.setTransform(p,m,v,b,A,_),[j,L]}g.drawImage(t,i,s,a,o,l,u,h,d);const w=Math.hypot(p,m),S=Math.hypot(v,b);return[w*h,S*d]}class om{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=nh;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Ue.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=fa.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=je.FILL,i=null){const s=this.minMax.slice();if(t===je.STROKE){i||le("Stroke bounding box must include transform."),Ct.singularValueDecompose2dScale(i,mi);const a=mi[0]*this.lineWidth/2,o=mi[1]*this.lineWidth/2;s[0]-=a,s[1]-=o,s[2]+=a,s[3]+=o}return s}updateClipFromPath(){const t=Ct.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(fa,0)}getClippedPathBoundingBox(t=je.FILL,i=null){return Ct.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function lm(g,t){if(t instanceof ImageData){g.putImageData(t,0,0);return}const i=t.height,s=t.width,a=i%oi,o=(i-a)/oi,l=a===0?o:o+1,u=g.createImageData(s,oi);let h=0,d;const p=t.data,m=u.data;let v,b,A,_;if(t.kind===dl.GRAYSCALE_1BPP){const w=p.byteLength,S=new Uint32Array(m.buffer,0,m.byteLength>>2),T=S.length,M=s+7>>3,k=4294967295,O=Ge.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(A=v<o?oi:a,d=0,b=0;b<A;b++){const z=w-h;let L=0;const G=z>M?s:z*8-7,j=G&-8;let Z=0,ot=0;for(;L<j;L+=8)ot=p[h++],S[d++]=ot&128?k:O,S[d++]=ot&64?k:O,S[d++]=ot&32?k:O,S[d++]=ot&16?k:O,S[d++]=ot&8?k:O,S[d++]=ot&4?k:O,S[d++]=ot&2?k:O,S[d++]=ot&1?k:O;for(;L<G;L++)Z===0&&(ot=p[h++],Z=128),S[d++]=ot&Z?k:O,Z>>=1}for(;d<T;)S[d++]=0;g.putImageData(u,0,v*oi)}}else if(t.kind===dl.RGBA_32BPP){for(b=0,_=s*oi*4,v=0;v<o;v++)m.set(p.subarray(h,h+_)),h+=_,g.putImageData(u,0,b),b+=oi;v<l&&(_=s*a*4,m.set(p.subarray(h,h+_)),g.putImageData(u,0,b))}else if(t.kind===dl.RGB_24BPP)for(A=oi,_=s*A,v=0;v<l;v++){for(v>=o&&(A=a,_=s*A),d=0,b=_;b--;)m[d++]=p[h++],m[d++]=p[h++],m[d++]=p[h++],m[d++]=255;g.putImageData(u,0,v*oi)}else throw new Error(`bad image kind: ${t.kind}`)}function cm(g,t){if(t.bitmap){g.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,a=i%oi,o=(i-a)/oi,l=a===0?o:o+1,u=g.createImageData(s,oi);let h=0;const d=t.data,p=u.data;for(let m=0;m<l;m++){const v=m<o?oi:a;({srcPos:h}=zv({src:d,srcPos:h,dest:p,width:s,height:v,nonBlackColor:0})),g.putImageData(u,0,m*oi)}}function pr(g,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)g[s]!==void 0&&(t[s]=g[s]);g.setLineDash!==void 0&&(t.setLineDash(g.getLineDash()),t.lineDashOffset=g.lineDashOffset)}function ol(g){g.strokeStyle=g.fillStyle="#000000",g.fillRule="nonzero",g.globalAlpha=1,g.lineWidth=1,g.lineCap="butt",g.lineJoin="miter",g.miterLimit=10,g.globalCompositeOperation="source-over",g.font="10px sans-serif",g.setLineDash!==void 0&&(g.setLineDash([]),g.lineDashOffset=0);const{filter:t}=g;t!=="none"&&t!==""&&(g.filter="none")}function um(g,t){if(t)return!0;Ct.singularValueDecompose2dScale(g,mi);const i=Math.fround(Ki.pixelRatio*_a.PDF_TO_CSS_UNITS);return mi[0]<=i&&mi[1]<=i}const Uv=["butt","round","square"],Hv=["miter","round","bevel"],jv={},hm={};class ga{constructor(t,i,s,a,o,{optionalContentConfig:l,markedContentStack:u=null},h,d,p){this.ctx=t,this.current=new om(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=a,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new Pv(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:a=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...ge(this.compositeCtx))}this.ctx.save(),ol(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=ge(this.ctx)}executeOperatorList(t,i,s,a,o){const l=t.argsArray,u=t.fnArray;let h=i||0;const d=l.length;if(d===h)return h;const p=d-h>rm&&typeof s=="function",m=p?Date.now()+Iv:0;let v=0;const b=this.commonObjs,A=this.objs;let _,w;for(;;){if(a!==void 0&&h===a.nextBreakPoint)return a.breakIt(h,s),h;if(!o||o(h))if(_=u[h],w=l[h]??null,_!==Er.dependency)w===null?this[_](h):this[_](h,...w);else for(const S of w){this.dependencyTracker?.recordNamedData(S,h);const T=S.startsWith("g_")?b:A;if(!T.has(S))return T.get(S,s),h}if(h++,h===d)return h;if(p&&++v>rm){if(Date.now()>m)return s(),h;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,a=t.height??t.displayHeight;let o=Math.max(Math.hypot(i[0],i[1]),1),l=Math.max(Math.hypot(i[2],i[3]),1),u=s,h=a,d="prescale1",p,m;for(;o>2&&u>1||l>2&&h>1;){let v=u,b=h;o>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/v),l>2&&h>1&&(b=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/b),p=this.cachedCanvases.getCanvas(d,v,b),m=p.context,m.clearRect(0,0,v,b),m.drawImage(t,0,0,u,h,0,0,v,b),t=p.canvas,u=v,h=b,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,i){const s=this.ctx,{width:a,height:o}=i,l=this.current.fillColor,u=this.current.patternFill,h=ge(s);let d,p,m,v;if((i.bitmap||i.data)&&i.count>1){const Z=i.bitmap||i.data.buffer;p=JSON.stringify(u?h:[h.slice(0,4),l]),d=this._cachedBitmapsMap.get(Z),d||(d=new Map,this._cachedBitmapsMap.set(Z,d));const ot=d.get(p);if(ot&&!u){const I=Math.round(Math.min(h[0],h[2])+h[4]),X=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,Oi.transformAndFill),{canvas:ot,offsetX:I,offsetY:X}}m=ot}m||(v=this.cachedCanvases.getCanvas("maskCanvas",a,o),cm(v.context,i));let b=Ct.transform(h,[1/a,0,0,-1/o,0,0]);b=Ct.transform(b,[1,0,0,1,0,-o]);const A=fa.slice();Ct.axialAlignedBoundingBox([0,0,a,o],b,A);const[_,w,S,T]=A,M=Math.round(S-_)||1,k=Math.round(T-w)||1,O=this.cachedCanvases.getCanvas("fillCanvas",M,k),z=O.context,L=_,G=w;z.translate(-L,-G),z.transform(...b),m||(m=this._scaleImage(v.canvas,Vi(z)),m=m.img,d&&u&&d.set(p,m)),z.imageSmoothingEnabled=um(ge(z),i.interpolate),rl(z,m,0,0,m.width,m.height,0,0,a,o),z.globalCompositeOperation="source-in";const j=Ct.transform(Vi(z),[1,0,0,1,-L,-G]);return z.fillStyle=u?l.getPattern(s,this,j,je.FILL,t):l,z.fillRect(0,0,a,o),d&&!u&&(this.cachedCanvases.delete("fillCanvas"),d.set(p,O.canvas)),this.dependencyTracker?.recordDependencies(t,Oi.transformAndFill),{canvas:O.canvas,offsetX:Math.round(L),offsetY:Math.round(G)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=Uv[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=Hv[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(i),a.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,a]of i)switch(s){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(a,i,s);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),pr(this.suspendedCtx,l),Fv(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),pr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,a){const o=a[0],l=a[1],u=a[2]-o,h=a[3]-l;u===0||h===0||(this.genericComposeSMask(i.context,s,u,h,i.subtype,i.backdrop,i.transferMap,o,l,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,a,o,l,u,h,d,p,m){let v=t.canvas,b=h-p,A=d-m;if(l)if(b<0||A<0||b+s>v.width||A+a>v.height){const w=this.cachedCanvases.getCanvas("maskExtension",s,a),S=w.context;S.drawImage(v,-b,-A),S.globalCompositeOperation="destination-atop",S.fillStyle=l,S.fillRect(0,0,s,a),S.globalCompositeOperation="source-over",v=w.canvas,b=A=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(b,A,s,a),t.clip(w),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(b,A,s,a),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const _=new Path2D;_.rect(h,d,s,a),i.clip(_),i.globalCompositeOperation="destination-in",i.drawImage(v,b,A,s,a,h,d,s,a),i.restore()}save(t){this.inSMaskMode&&pr(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&pr(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,a,o,l,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,a,o,l,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,a){let[o]=s;if(!a){o||=s[0]=new Path2D,this[i](t,o);return}if(this.dependencyTracker!==null){const l=i===Er.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-l,a[2]+l,a[1]-l,a[3]+l).recordDependencies(t,["transform"])}if(!(o instanceof Path2D)){const l=s[0]=new Path2D;for(let u=0,h=o.length;u<h;)switch(o[u++]){case tl.moveTo:l.moveTo(o[u++],o[u++]);break;case tl.lineTo:l.lineTo(o[u++],o[u++]);break;case tl.curveTo:l.bezierCurveTo(o[u++],o[u++],o[u++],o[u++],o[u++],o[u++]);break;case tl.closePath:l.closePath();break;default:zt(`Unrecognized drawing path operator: ${o[u-1]}`);break}o=l}Ct.axialAlignedBoundingBox(a,ge(this.ctx),this.current.minMax),this[i](t,o),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const a=this.ctx,o=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const l=o.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=o.getPattern(a,this,Vi(a),je.STROKE,t),l){const u=new Path2D;u.addPath(i,a.getTransform().invertSelf().multiplySelf(l)),i=u}this.rescaleAndStroke(i,!1),a.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,Oi.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(je.STROKE,ge(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const a=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let u=!1;if(l){const d=o.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=o.getPattern(a,this,Vi(a),je.FILL,t),d){const p=new Path2D;p.addPath(i,a.getTransform().invertSelf().multiplySelf(d)),i=p}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(a.fill(i,"evenodd"),this.pendingEOFill=!1):a.fill(i)),this.dependencyTracker?.recordDependencies(t,Oi.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,h)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,Oi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=jv}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=hm}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;i!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(i!==void 0){const a=new Path2D,o=s.getTransform().invertSelf();for(const{transform:l,x:u,y:h,fontSize:d,path:p}of i)p&&a.addPath(p,new DOMMatrix(l).preMultiplySelf(o).translate(u,h).scale(d,-d));s.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const a=this.commonObjs.get(i),o=this.current;if(!a)throw new Error(`Can't find font for ${i}`);if(o.fontMatrix=a.fontMatrix||nh,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&zt("Invalid font matrix for font "+i),s<0?(s=-s,o.fontDirection=-1):o.fontDirection=1,this.current.font=a,this.current.fontSize=s,a.isType3Font)return;const l=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${l}", ${a.fallbackName}`;let h="normal";a.black?h="900":a.bold&&(h="bold");const d=a.italic?"italic":"normal";let p=s;s<sm?p=sm:s>am&&(p=am),this.current.fontSizeScale=s/p,this.ctx.font=`${d} ${h} ${p}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const a=new Path2D;return a.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),a}paintChar(t,i,s,a,o,l){const u=this.ctx,h=this.current,d=h.font,p=h.textRenderingMode,m=h.fontSize/h.fontSizeScale,v=p&Ue.FILL_STROKE_MASK,b=!!(p&Ue.ADD_TO_PATH_FLAG),A=h.patternFill&&!d.missingFile,_=h.patternStroke&&!d.missingFile;let w;if((d.disableFontFace||b||A||_)&&!d.missingFile&&(w=d.getPathGenerator(this.commonObjs,i)),w&&(d.disableFontFace||A||_)){u.save(),u.translate(s,a),u.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(t,u,d);let S;if(v===Ue.FILL||v===Ue.FILL_STROKE)if(o){S=u.getTransform(),u.setTransform(...o);const T=this.#n(w,S,o);u.fill(T)}else u.fill(w);if(v===Ue.STROKE||v===Ue.FILL_STROKE)if(l){S||=u.getTransform(),u.setTransform(...l);const{a:T,b:M,c:k,d:O}=S,z=Ct.inverseTransform(l),L=Ct.transform([T,M,k,O,0,0],z);Ct.singularValueDecompose2dScale(L,mi),u.lineWidth*=Math.max(mi[0],mi[1])/m,u.stroke(this.#n(w,S,l))}else u.lineWidth/=m,u.stroke(w);u.restore()}else(v===Ue.FILL||v===Ue.FILL_STROKE)&&(u.fillText(i,s,a),this.dependencyTracker?.recordCharacterBBox(t,u,d,m,s,a,()=>u.measureText(i))),(v===Ue.STROKE||v===Ue.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,d,m,s,a,()=>u.measureText(i)).recordDependencies(t,Oi.stroke),u.strokeText(i,s,a));b&&((this.pendingTextPaths||=[]).push({transform:ge(u),x:s,y:a,fontSize:m,path:w}),this.dependencyTracker?.recordCharacterBBox(t,u,d,m,s,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let a=3;a<i.length;a+=4)if(i[a]>0&&i[a]<255){s=!0;break}return Ht(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Oi.showText).resetBBox(t),this.current.textRenderingMode&Ue.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,a=s.font;if(a.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const o=s.fontSize;if(o===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,u=s.fontSizeScale,h=s.charSpacing,d=s.wordSpacing,p=s.fontDirection,m=s.textHScale*p,v=i.length,b=a.vertical,A=b?1:-1,_=a.defaultVMetrics,w=o*s.fontMatrix[0],S=s.textRenderingMode===Ue.FILL&&!a.disableFontFace&&!s.patternFill;l.save(),s.textMatrix&&l.transform(...s.textMatrix),l.translate(s.x,s.y+s.textRise),p>0?l.scale(m,-1):l.scale(m,1);let T,M;if(s.patternFill){l.save();const G=s.fillColor.getPattern(l,this,Vi(l),je.FILL,t);T=ge(l),l.restore(),l.fillStyle=G}if(s.patternStroke){l.save();const G=s.strokeColor.getPattern(l,this,Vi(l),je.STROKE,t);M=ge(l),l.restore(),l.strokeStyle=G}let k=s.lineWidth;const O=s.textMatrixScale;if(O===0||k===0){const G=s.textRenderingMode&Ue.FILL_STROKE_MASK;(G===Ue.STROKE||G===Ue.FILL_STROKE)&&(k=this.getSinglePixelWidth())}else k/=O;if(u!==1&&(l.scale(u,u),k/=u),l.lineWidth=k,a.isInvalidPDFjsFont){const G=[];let j=0;for(const ot of i)G.push(ot.unicode),j+=ot.width;const Z=G.join("");if(l.fillText(Z,0,0),this.dependencyTracker!==null){const ot=l.measureText(Z);this.dependencyTracker.recordBBox(t,this.ctx,-ot.actualBoundingBoxLeft,ot.actualBoundingBoxRight,-ot.actualBoundingBoxAscent,ot.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=j*w*m,l.restore(),this.compose();return}let z=0,L;for(L=0;L<v;++L){const G=i[L];if(typeof G=="number"){z+=A*G*o/1e3;continue}let j=!1;const Z=(G.isSpace?d:0)+h,ot=G.fontChar,I=G.accent;let X,x,tt=G.width;if(b){const ct=G.vmetric||_,st=-(G.vmetric?ct[1]:tt*.5)*w,mt=ct[2]*w;tt=ct?-ct[0]:tt,X=st/u,x=(z+mt)/u}else X=z/u,x=0;let U;if(a.remeasure&&tt>0){U=l.measureText(ot);const ct=U.width*1e3/o*u;if(tt<ct&&this.isFontSubpixelAAEnabled){const st=tt/ct;j=!0,l.save(),l.scale(st,1),X/=st}else tt!==ct&&(X+=(tt-ct)/2e3*o/u)}if(this.contentVisible&&(G.isInFont||a.missingFile)){if(S&&!I)l.fillText(ot,X,x),this.dependencyTracker?.recordCharacterBBox(t,l,U?{bbox:null}:a,o/u,X,x,()=>U??l.measureText(ot));else if(this.paintChar(t,ot,X,x,T,M),I){const ct=X+o*I.offset.x/u,st=x-o*I.offset.y/u;this.paintChar(t,I.fontChar,ct,st,T,M)}}const H=b?tt*w-Z*p:tt*w+Z*p;z+=H,j&&l.restore()}b?s.y-=z:s.x+=z*m,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,a=this.current,o=a.font,l=a.fontSize,u=a.fontDirection,h=o.vertical?1:-1,d=a.charSpacing,p=a.wordSpacing,m=a.textHScale*u,v=a.fontMatrix||nh,b=i.length,A=a.textRenderingMode===Ue.INVISIBLE;let _,w,S,T;if(A||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),a.textMatrix&&s.transform(...a.textMatrix),s.translate(a.x,a.y+a.textRise),s.scale(m,u);const M=this.dependencyTracker;for(this.dependencyTracker=M?new yl(M,t):null,_=0;_<b;++_){if(w=i[_],typeof w=="number"){T=h*w*l/1e3,this.ctx.translate(T,0),a.x+=T*m;continue}const k=(w.isSpace?p:0)+d,O=o.charProcOperatorList[w.operatorListId];O?this.contentVisible&&(this.save(),s.scale(l,l),s.transform(...v),this.executeOperatorList(O),this.restore()):zt(`Type3 character "${w.operatorListId}" is not available.`);const z=[w.width,0];Ct.applyTransform(z,v),S=z[0]*l+k,s.translate(S,0),a.x+=S*m}s.restore(),M&&(this.dependencyTracker=M)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,a,o,l,u){const h=new Path2D;h.rect(a,o,l-a,u-o),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,a,l,o,u).recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const a=this.baseTransform||ge(this.ctx),o={createCanvasGraphics:(l,u)=>new ga(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new yl(this.dependencyTracker,u,!0):null)};s=new Ch(i,this.ctx,o,a)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let a;return this.cachedPatterns.has(i)?a=this.cachedPatterns.get(i):(a=Bv(this.getObject(t,i)),this.cachedPatterns.set(i,a)),s&&(a.matrix=s),a}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const a=this._getPattern(t,i);s.fillStyle=a.getPattern(s,this,Vi(s),je.SHADING,t);const o=Vi(s);if(o){const{width:l,height:u}=s.canvas,h=fa.slice();Ct.axialAlignedBoundingBox([0,0,l,u],o,h);const[d,p,m,v]=h;this.ctx.fillRect(d,p,m-d,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Oi.transform).recordDependencies(t,Oi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){le("Should not call beginInlineImage")}beginImageData(){le("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=ge(this.ctx),s)){Ct.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[a,o,l,u]=s,h=new Path2D;h.rect(a,o,l-a,u-o),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||Sl("TODO: Support non-isolated groups."),i.knockout&&zt("Knockout groups not supported.");const a=ge(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let o=fa.slice();Ct.axialAlignedBoundingBox(i.bbox,ge(s),o);const l=[0,0,s.canvas.width,s.canvas.height];o=Ct.intersect(o,l)||[0,0,0,0];const u=Math.floor(o[0]),h=Math.floor(o[1]),d=Math.max(Math.ceil(o[2])-u,1),p=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,p]);let m="groupAt"+this.groupLevel;i.smask&&(m+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(m,d,p),b=v.context;b.translate(-u,-h),b.transform(...a);let A=new Path2D;const[_,w,S,T]=i.bbox;if(A.rect(_,w,S-_,T-w),i.matrix){const M=new Path2D;M.addPath(A,new DOMMatrix(i.matrix)),A=M}b.clip(A),i.smask&&this.smaskStack.push({canvas:v.canvas,context:b,offsetX:u,offsetY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,h),s.save()),pr(s,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=ge(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...o);const l=fa.slice();Ct.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,i,s,a,o,l){if(this.#t(),ol(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],h=s[3]-s[1];if(l&&this.annotationCanvasMap){a=a.slice(),a[4]-=s[0],a[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=h,Ct.singularValueDecompose2dScale(ge(this.ctx),mi);const{viewportScale:d}=this,p=Math.ceil(u*this.outputScaleX*d),m=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(p,m);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(i,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(mi[0],0,0,-mi[1],0,h*mi[1]),ol(this.ctx)}else{ol(this.ctx),this.endPath(t);const d=new Path2D;d.rect(s[0],s[1],u,h),this.ctx.clip(d)}}this.current=new om(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...o)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const a=this.ctx,o=this._createMaskCanvas(t,i),l=o.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(l,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,a=0,o=0,l,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const h=this.ctx;h.save();const d=ge(h);h.transform(s,a,o,l,0,0);const p=this._createMaskCanvas(t,i);h.setTransform(1,0,0,1,p.offsetX-d[4],p.offsetY-d[5]),this.dependencyTracker?.resetBBox(t);for(let m=0,v=u.length;m<v;m+=2){const b=Ct.transform(d,[s,a,o,l,u[m],u[m+1]]);h.drawImage(p.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(t,this.ctx,b[4],b[4]+p.canvas.width,b[5],b[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,a=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Oi.transformAndFill);for(const l of i){const{data:u,width:h,height:d,transform:p}=l,m=this.cachedCanvases.getCanvas("maskCanvas",h,d),v=m.context;v.save();const b=this.getObject(t,u,l);cm(v,b),v.globalCompositeOperation="source-in",v.fillStyle=o?a.getPattern(v,this,Vi(s),je.FILL,t):a,v.fillRect(0,0,h,d),v.restore(),s.save(),s.transform(...p),s.scale(1,-1),rl(s,m.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,h,0,d),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){zt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,a,o){if(!this.contentVisible)return;const l=this.getObject(t,i);if(!l){zt("Dependent image isn't ready yet");return}const u=l.width,h=l.height,d=[];for(let p=0,m=o.length;p<m;p+=2)d.push({transform:[s,0,0,a,o[p],o[p+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,l,d)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:a}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,a),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(i,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,a=i.height,o=this.ctx;this.save(t);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/s,-1/a);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const p=this.cachedCanvases.getCanvas("inlineImage",s,a).context;lm(p,i),u=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(u,Vi(o));o.imageSmoothingEnabled=um(ge(o),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,o,0,s,-a,0).recordDependencies(t,Oi.imageXObject).recordOperation(t),rl(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-a,s,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const a=this.ctx;let o;if(i.bitmap)o=i.bitmap;else{const l=i.width,u=i.height,d=this.cachedCanvases.getCanvas("inlineImage",l,u).context;lm(d,i),o=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(t);for(const l of s)a.save(),a.transform(...l.transform),a.scale(1,-1),rl(a,o,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Oi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const o=this.ctx;this.pendingClip?(a||(this.pendingClip===hm?o.clip(i,"evenodd"):o.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ge(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,a)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:a,d:o}=this.ctx.getTransform();let l,u;if(s===0&&a===0){const h=Math.abs(i),d=Math.abs(o);if(h===d)if(t===0)l=u=1/h;else{const p=h*t;l=u=p<1?1/p:1}else if(t===0)l=1/h,u=1/d;else{const p=h*t,m=d*t;l=p<1?1/p:1,u=m<1?1/m:1}}else{const h=Math.abs(i*o-s*a),d=Math.hypot(i,s),p=Math.hypot(a,o);if(t===0)l=p/h,u=d/h;else{const m=t*h;l=p>m?p/m:1,u=d>m?d/m:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:a}}=this,[o,l]=this.getScaleForStroking();if(o===l){s.lineWidth=(a||1)*o,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(o,l),Ju.a=1/o,Ju.d=1/l;const h=new Path2D;if(h.addPath(t,Ju),u.length>0){const d=Math.max(o,l);s.setLineDash(u.map(p=>p/d)),s.lineDashOffset/=d}s.lineWidth=a||1,s.stroke(h),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const g in Er)ga.prototype[g]!==void 0&&(ga.prototype[Er[g]]=ga.prototype[g]);class ma{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let a=0;for(const d of ma.strings){const p=i.encode(t[d]);s[d]=p,a+=4+p.length}const o=new ArrayBuffer(a),l=new Uint8Array(o),u=new DataView(o);let h=0;for(const d of ma.strings){const p=s[d],m=p.length;u.setUint32(h,m),l.set(p,h+4),h+=4+m}return Kt(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Kt(t<ma.strings.length,"Invalid string index");let i=0;for(let a=0;a<t;a++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ya{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let a=0;for(const v of ya.strings){const b=i.encode(t[v]);s[v]=b,a+=4+b.length}a+=4;let o,l,u=1+a;t.style&&(o=i.encode(t.style.style),l=i.encode(t.style.weight),u+=4+o.length+4+l.length);const h=new ArrayBuffer(u),d=new Uint8Array(h),p=new DataView(h);let m=0;p.setUint8(m++,t.guessFallback?1:0),p.setUint32(m,0),m+=4,a=0;for(const v of ya.strings){const b=s[v],A=b.length;a+=4+A,p.setUint32(m,A),d.set(b,m+4),m+=4+A}return p.setUint32(m-a-4,a),t.style&&(p.setUint32(m,o.length),d.set(o,m+4),m+=4+o.length,p.setUint32(m,l.length),d.set(l,m+4),m+=4+l.length),Kt(m<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(m)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Kt(t<ya.strings.length,"Invalid string index");let i=5;for(let a=0;a<t;a++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const a=this.#e.getUint32(t),o=this.#n.decode(new Uint8Array(this.#t,t+4,a));return{style:s,weight:o}}}class ae{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#r=this.#i+1+6;#s;#a;#o;constructor({data:t,extra:i}){this.#s=t,this.#a=new TextDecoder,this.#o=new DataView(this.#s),i&&Object.assign(this,i)}#c(t){Kt(t<ae.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,a=this.#o.getUint8(i)>>s&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Kt(t<ae.numbers.length,"Invalid number index"),this.#o.getFloat64(ae.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=ae.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<4;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=ae.#n;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<6;a++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=ae.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<3;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){Kt(t<ae.strings.length,"Invalid string index");let i=ae.#r+4;for(let o=0;o<t;o++)i+=this.#o.getUint32(i)+4;const s=this.#o.getUint32(i),a=new Uint8Array(s);return a.set(new Uint8Array(this.#s,i+4,s)),this.#a.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=ae.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);if(o!==0)return new Uint8Array(this.#s,t+4,o)}clearData(){let t=ae.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);new Uint8Array(this.#s,t+4,o).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=ae.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a===0)return null;const o=new Uint8Array(a);return o.set(new Uint8Array(this.#s,t+4,a)),new ma(o.buffer)}get systemFontInfo(){let t=ae.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#s,t+4,s)),new ya(a.buffer)}static write(t){const i=t.systemFontInfo?ya.write(t.systemFontInfo):null,s=t.cssFontInfo?ma.write(t.cssFontInfo):null,a=new TextEncoder,o={};let l=0;for(const _ of ae.strings)o[_]=a.encode(t[_]),l+=4+o[_].length;const u=ae.#r+4+l+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),d=new Uint8Array(h),p=new DataView(h);let m=0;const v=ae.bools.length;let b=0,A=0;for(let _=0;_<v;_++){const w=t[ae.bools[_]];b|=(w===void 0?0:w?2:1)<<A,A+=2,(A===8||_===v-1)&&(p.setUint8(m++,b),b=0,A=0)}Kt(m===ae.#t,"FontInfo.write: Boolean properties offset mismatch");for(const _ of ae.numbers)p.setFloat64(m,t[_]),m+=8;if(Kt(m===ae.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(m++,4);for(const _ of t.bbox)p.setInt16(m,_,!0),m+=2}else p.setUint8(m++,0),m+=8;if(Kt(m===ae.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(m++,6);for(const _ of t.fontMatrix)p.setFloat64(m,_,!0),m+=8}else p.setUint8(m++,0),m+=48;if(Kt(m===ae.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(m++,1);for(const _ of t.defaultVMetrics)p.setInt16(m,_,!0),m+=2}else p.setUint8(m++,0),m+=6;Kt(m===ae.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(ae.#r,0),m+=4;for(const _ of ae.strings){const w=o[_],S=w.length;p.setUint32(m,S),d.set(w,m+4),m+=4+S}if(p.setUint32(ae.#r,m-ae.#r-4),!i)p.setUint32(m,0),m+=4;else{const _=i.byteLength;p.setUint32(m,_),Kt(m+4+_<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(i),m+4),m+=4+_}if(!s)p.setUint32(m,0),m+=4;else{const _=s.byteLength;p.setUint32(m,_),Kt(m+4+_<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(s),m+4),m+=4+_}return t.data===void 0?(p.setUint32(m,0),m+=4):(p.setUint32(m,t.data.length),d.set(t.data,m+4),m+=4+t.data.length),Kt(m<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(m)}}class ba{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class Gv{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const ha=Symbol("INTERNAL");class qv{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:a,rbGroups:o}){this.#t=!!(t&gi.DISPLAY),this.#e=!!(t&gi.PRINT),this.name=i,this.intent=s,this.usage=a,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==ha&&le("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class Vv{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=gi.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new qv(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(ha,!1);for(const s of t.on)this.#e.get(s)._setVisible(ha,!0);for(const s of t.off)this.#e.get(s)._setVisible(ha,!1);this.#n=this.getHash()}}#r(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let a=1;a<i;a++){const o=t[a];let l;if(Array.isArray(o))l=this.#r(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return zt(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Sl("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(zt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return zt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return zt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return zt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return zt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return zt(`Unknown optional content policy ${t.policy}.`),!0}return zt(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const a=this.#e.get(t);if(!a){zt(`Optional content group not found: ${t}`);return}if(s&&i&&a.rbGroups.length)for(const o of a.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(ha,!1,!0);a._setVisible(ha,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":s=a;continue}const o=this.#e.get(a);if(o)switch(s){case"ON":this.setVisibility(a,!0,i);break;case"OFF":this.setVisibility(a,!1,i);break;case"Toggle":this.setVisibility(a,!o.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Gm;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Yv{constructor(t,{disableRange:i=!1,disableStream:s=!1}){Kt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:a,initialData:o,progressiveDone:l,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=a,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),t.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const s=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const a=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(s),!0)});Kt(a,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){Kt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Xv(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new $v(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class Xv{constructor(t,i,s=!1,a=null){this._stream=t,this._done=s||!1,this._filename=vh(a)?a:null,this._queuedChunks=i||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class $v{constructor(t,i,s){this._stream=t,this._begin=i,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Kv(g){let t=!0,i=s("filename\\*","i").exec(g);if(i){i=i[1];let p=u(i);return p=unescape(p),p=h(p),p=d(p),o(p)}if(i=l(g),i){const p=d(i);return o(p)}if(i=s("filename","i").exec(g),i){i=i[1];let p=u(i);return p=d(p),o(p)}function s(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function a(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const v=new TextDecoder(p,{fatal:!0}),b=Dr(m);m=v.decode(b),t=!1}catch{}}return m}function o(p){return t&&/[\x80-\xff]/.test(p)&&(p=a("utf-8",p),t&&(p=a("iso-8859-1",p))),p}function l(p){const m=[];let v;const b=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=b.exec(p))!==null;){let[,_,w,S]=v;if(_=parseInt(_,10),_ in m){if(_===0)break;continue}m[_]=[w,S]}const A=[];for(let _=0;_<m.length&&_ in m;++_){let[w,S]=m[_];S=u(S),w&&(S=unescape(S),_===0&&(S=h(S))),A.push(S)}return A.join("")}function u(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let v=0;v<m.length;++v){const b=m[v].indexOf('"');b!==-1&&(m[v]=m[v].slice(0,b),m.length=v+1),m[v]=m[v].replaceAll(/\\(.)/g,"$1")}p=m.join('"')}return p}function h(p){const m=p.indexOf("'");if(m===-1)return p;const v=p.slice(0,m),A=p.slice(m+1).replace(/^[^']*'/,"");return a(v,A)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,v,b,A){if(b==="q"||b==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,w){return String.fromCharCode(parseInt(w,16))}),a(v,A);try{A=atob(A)}catch{}return a(v,A)})}return""}function Zm(g,t){const i=new Headers;if(!g||!t||typeof t!="object")return i;for(const s in t){const a=t[s];a!==void 0&&i.append(s,a)}return i}function Cl(g){return URL.parse(g)?.origin??null}function Wm({responseHeaders:g,isHttp:t,rangeChunkSize:i,disableRange:s}){const a={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(g.get("Content-Length"),10);return!Number.isInteger(o)||(a.suggestedLength=o,o<=2*i)||s||!t||g.get("Accept-Ranges")!=="bytes"||(g.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function Qm(g){const t=g.get("Content-Disposition");if(t){let i=Kv(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(vh(i))return i}return null}function Br(g,t){return new ml(`Unexpected server response (${g}) while retrieving PDF "${t}".`,g,g===404||g===0&&t.startsWith("file:"))}function Jm(g){return g===200||g===206}function t0(g,t,i){return{method:"GET",headers:g,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function e0(g){return g instanceof Uint8Array?g.buffer:g instanceof ArrayBuffer?g:(zt(`getArrayBuffer - unexpected data format: ${g}`),new Uint8Array(g).buffer)}class Zv{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Zm(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Kt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Wv(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new Qv(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Wv{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const s=new Headers(t.headers),a=i.url;fetch(a,t0(s,this._withCredentials,this._abortController)).then(o=>{if(t._responseOrigin=Cl(o.url),!Jm(o.status))throw Br(o.status,a);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:u,suggestedLength:h}=Wm({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=Qm(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Xn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:e0(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Qv{constructor(t,i,s){this._stream=t,this._reader=null,this._loaded=0;const a=t.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${i}-${s-1}`);const l=a.url;fetch(l,t0(o,this._withCredentials,this._abortController)).then(u=>{const h=Cl(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!Jm(u.status))throw Br(u.status,l);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:e0(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const th=200,eh=206;function Jv(g){const t=g.response;return typeof t!="string"?t:Dr(t).buffer}class t_{_responseOrigin=null;constructor({url:t,httpHeaders:i,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Zm(this.isHttp,i),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,s=this.currXhrId++,a=this.pendingRequests[s]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[o,l]of this.headers)i.setRequestHeader(o,l);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),a.expectedStatus=eh):a.expectedStatus=th,i.responseType="arraybuffer",Kt(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,s),i.onprogress=this.onProgress.bind(this,s),a.onHeadersReceived=t.onHeadersReceived,a.onDone=t.onDone,a.onError=t.onError,a.onProgress=t.onProgress,i.send(null),s}onProgress(t,i){const s=this.pendingRequests[t];s&&s.onProgress?.(i)}onStateChange(t,i){const s=this.pendingRequests[t];if(!s)return;const a=s.xhr;if(a.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),a.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],a.status===0&&this.isHttp){s.onError(a.status);return}const o=a.status||th;if(!(o===th&&s.expectedStatus===eh)&&o!==s.expectedStatus){s.onError(a.status);return}const u=Jv(a);if(o===eh){const h=a.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?s.onDone({begin:parseInt(d[1],10),chunk:u}):(zt('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(a.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class e_{constructor(t){this._source=t,this._manager=new t_(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return Kt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new i_(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const s=new n_(this._manager,t,i);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class i_{constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=Cl(i.responseURL);const s=i.getAllResponseHeaders(),a=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...d]=u.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=Wm({responseHeaders:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=Qm(a),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Br(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class n_{constructor(t,i,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Cl(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Br(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const s_=/^[a-z][a-z0-9\-+.]+:/i;function a_(g){if(s_.test(g))return new URL(g);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(g))}class r_{constructor(t){this.source=t,this.url=a_(t.url),Kt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Kt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new o_(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new l_(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class o_{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(a=>{this._contentLength=a.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},a=>{a.code==="ENOENT"&&(a=Br(0,this._url.href)),this._storedError=a,this._headersCapability.reject(a)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Xn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class l_{constructor(t,i,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const a=t.source;this._isStreamingSupported=!a.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:i,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const gr=Symbol("INITIAL_DATA");class i0{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:gr}}get(t,i=null){if(i){const a=this.#e(t);return a.promise.then(()=>i(a.data)),null}const s=this.#t[t];if(!s||s.data===gr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==gr}delete(t){const i=this.#t[t];return!i||i.data===gr?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==gr&&(yield[t,i])}}}const c_=1e5,dm=30;class Xe{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#a=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#p=null;#u=[];#g=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#C=new WeakMap;static#w=null;static#_=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=i,this.#h=s.scale*Ki.pixelRatio,this.#d=s.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:o,pageX:l,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-l,u+o],this.#o=a,this.#a=o,Xe.#R(),bs(i,s),this.#t.promise.finally(()=>{Xe.#_.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=Ge.platform;return Ht(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#r??=i.lang,Object.assign(this.#f,i.styles),this.#x(i.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),Xe.#_.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*Ki.pixelRatio,a=t.rotation;if(a!==this.#d&&(i?.(),this.#d=a,bs(this.#l,{rotation:a})),s!==this.#h){i?.(),this.#h=s;const o={div:null,properties:null,ctx:Xe.#D(this.#r)};for(const l of this.#u)o.properties=this.#g.get(l),o.div=l,this.#E(o)}}cancel(){const t=new Xn("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#x(t){if(this.#n)return;this.#s.ctx??=Xe.#D(this.#r);const i=this.#u,s=this.#m;for(const a of t){if(i.length>c_){zt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),o.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(a.str),this.#S(a)}}#S(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const a=Ct.transform(this.#y,t.transform);let o=Math.atan2(a[1],a[0]);const l=this.#f[t.fontName];l.vertical&&(o+=Math.PI/2);let u=this.#i&&l.fontSubstitution||l.fontFamily;u=Xe.fontFamilyMap.get(u)||u;const h=Math.hypot(a[2],a[3]),d=h*Xe.#I(u,l,this.#r);let p,m;o===0?(p=a[4],m=a[5]-d):(p=a[4]+d*Math.sin(o),m=a[5]-d*Math.cos(o));const v="calc(var(--total-scale-factor) *",b=i.style;this.#e===this.#l?(b.left=`${(100*p/this.#o).toFixed(2)}%`,b.top=`${(100*m/this.#a).toFixed(2)}%`):(b.left=`${v}${p.toFixed(2)}px)`,b.top=`${v}${m.toFixed(2)}px)`),b.fontSize=`${v}${(Xe.#w*h).toFixed(2)}px)`,b.fontFamily=u,s.fontSize=h,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),w=Math.abs(t.transform[3]);_!==w&&Math.max(_,w)/Math.min(_,w)>1.5&&(A=!0)}if(A&&(s.canvasWidth=l.vertical?t.height:t.width),this.#g.set(i,s),this.#s.div=i,this.#s.properties=s,this.#E(this.#s),s.hasText&&this.#e.append(i),s.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#E(t){const{div:i,properties:s,ctx:a}=t,{style:o}=i;let l="";if(Xe.#w>1&&(l=`scale(${1/Xe.#w})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=o,{canvasWidth:h,fontSize:d}=s;Xe.#M(a,d*this.#h,u);const{width:p}=a.measureText(i.textContent);p>0&&(l=`scaleX(${h*this.#h/p}) ${l}`)}s.angle!==0&&(l=`rotate(${s.angle}deg) ${l}`),l.length>0&&(o.transform=l)}static cleanup(){if(!(this.#_.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#D(t=null){let i=this.#b.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,i),this.#C.set(i,{size:0,family:""})}return i}static#M(t,i,s){const a=this.#C.get(t);i===a.size&&s===a.family||(t.font=`${i}px ${s}`,a.size=i,a.family=s)}static#R(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#I(t,i,s){const a=this.#v.get(t);if(a)return a;const o=this.#D(s);o.canvas.width=o.canvas.height=dm,this.#M(o,dm,t);const l=o.measureText(""),u=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let d=.8;return u?d=u/(u+h):(Ge.platform.isFirefox&&zt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?d=i.ascent:i.descent&&(d=1+i.descent)),this.#v.set(t,d),d}}const u_=100;function n0(g={}){typeof g=="string"||g instanceof URL?g={url:g}:(g instanceof ArrayBuffer||ArrayBuffer.isView(g))&&(g={data:g});const t=new Th,{docId:i}=t,s=g.url?yv(g.url):null,a=g.data?bv(g.data):null,o=g.httpHeaders||null,l=g.withCredentials===!0,u=g.password??null,h=g.range instanceof s0?g.range:null,d=Number.isInteger(g.rangeChunkSize)&&g.rangeChunkSize>0?g.rangeChunkSize:2**16;let p=g.worker instanceof Tr?g.worker:null;const m=g.verbosity,v=typeof g.docBaseUrl=="string"&&!wl(g.docBaseUrl)?g.docBaseUrl:null,b=il(g.cMapUrl),A=g.cMapPacked!==!1,_=g.CMapReaderFactory||($e?Tv:Qg),w=il(g.iccUrl),S=il(g.standardFontDataUrl),T=g.StandardFontDataFactory||($e?xv:Jg),M=il(g.wasmUrl),k=g.WasmFactory||($e?Mv:tm),O=g.stopAtErrors!==!0,z=Number.isInteger(g.maxImageSize)&&g.maxImageSize>-1?g.maxImageSize:-1,L=g.isEvalSupported!==!1,G=typeof g.isOffscreenCanvasSupported=="boolean"?g.isOffscreenCanvasSupported:!$e,j=typeof g.isImageDecoderSupported=="boolean"?g.isImageDecoderSupported:!$e&&(Ge.platform.isFirefox||!globalThis.chrome),Z=Number.isInteger(g.canvasMaxAreaInBytes)?g.canvasMaxAreaInBytes:-1,ot=typeof g.disableFontFace=="boolean"?g.disableFontFace:$e,I=g.fontExtraProperties===!0,X=g.enableXfa===!0,x=g.ownerDocument||globalThis.document,tt=g.disableRange===!0,U=g.disableStream===!0,H=g.disableAutoFetch===!0,ct=g.pdfBug===!0,st=g.CanvasFactory||($e?Cv:Sv),mt=g.FilterFactory||($e?Ev:wv),D=g.enableHWA===!0,B=g.useWasm!==!1,J=h?h.length:g.length??NaN,it=typeof g.useSystemFonts=="boolean"?g.useSystemFonts:!$e&&!ot,at=typeof g.useWorkerFetch=="boolean"?g.useWorkerFetch:!!(_===Qg&&T===Jg&&k===tm&&b&&S&&M&&br(b,document.baseURI)&&br(S,document.baseURI)&&br(M,document.baseURI)),At=null;Vb(m);const St={canvasFactory:new st({ownerDocument:x,enableHWA:D}),filterFactory:new mt({docId:i,ownerDocument:x}),cMapReaderFactory:at?null:new _({baseUrl:b,isCompressed:A}),standardFontDataFactory:at?null:new T({baseUrl:S}),wasmFactory:at?null:new k({baseUrl:M})};p||(p=Tr.create({verbosity:m,port:ba.workerPort}),t._worker=p);const Mt={docId:i,apiVersion:"5.4.296",data:a,password:u,disableAutoFetch:H,rangeChunkSize:d,length:J,docBaseUrl:v,enableXfa:X,evaluatorOptions:{maxImageSize:z,disableFontFace:ot,ignoreErrors:O,isEvalSupported:L,isOffscreenCanvasSupported:G,isImageDecoderSupported:j,canvasMaxAreaInBytes:Z,fontExtraProperties:I,useSystemFonts:it,useWasm:B,useWorkerFetch:at,cMapUrl:b,iccUrl:w,standardFontDataUrl:S,wasmUrl:M}},xt={ownerDocument:x,pdfBug:ct,styleElement:At,loadingParams:{disableAutoFetch:H,enableXfa:X}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const pt=p.messageHandler.sendWithPromise("GetDocRequest",Mt,a?[a.buffer]:null);let _t;if(h)_t=new Yv(h,{disableRange:tt,disableStream:U});else if(!a){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Ut=br(s)?Zv:$e?r_:e_;_t=new Ut({url:s,length:J,httpHeaders:o,withCredentials:l,rangeChunkSize:d,disableRange:tt,disableStream:U})}return pt.then(Ut=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Lt=new vr(i,Ut,p.port),C=new f_(Lt,t,_t,xt,St,D);t._transport=C,Lt.send("Ready",null)})}).catch(t._capability.reject),t}class Th{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Th.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class s0{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#r=[];constructor(t,i,s=!1,a=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=a}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#r)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){le("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class h_{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ht(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class d_{#t=!1;constructor(t,i,s,a=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=a?new Vg:null,this._pdfBug=a,this.commonObjs=s.commonObjs,this.objs=new i0,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}={}){return new kr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:a,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ht(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:a="display",annotationMode:o=qn.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:v=!1,recordOperations:b=!1,operationsFilter:A=null}){this._stats?.time("Overall");const _=this._transport.getRenderingIntent(a,o,m,v),{renderingIntent:w,cacheKey:S}=_;this.#t=!1,h||=this._transport.getOptionalContentConfig(w);let T=this._intentStates.get(S);T||(T=Object.create(null),this._intentStates.set(S,T)),T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null);const M=!!(w&gi.PRINT);T.displayReadyCapability||(T.displayReadyCapability=Promise.withResolvers(),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(_));const k=!!(this._pdfBug&&globalThis.StepperManager?.enabled),O=!this.recordedBBoxes&&(b||k),z=j=>{if(T.renderTasks.delete(L),O){const Z=L.gfx?.dependencyTracker.take();Z&&(L.stepper&&L.stepper.setOperatorBBoxes(Z,L.gfx.dependencyTracker.takeDebugMetadata()),b&&(this.recordedBBoxes=Z))}M&&(this.#t=!0),this.#e(),j?(L.capability.reject(j),this._abortOperatorList({intentState:T,reason:j instanceof Error?j:new Error(j)})):L.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},L=new pa({callback:z,params:{canvas:i,canvasContext:t,dependencyTracker:O?new Dv(i,T.operatorList.length,k):null,viewport:s,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:T.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!M,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:A});(T.renderTasks||=new Set).add(L);const G=L.task;return Promise.all([T.displayReadyCapability.promise,h]).then(([j,Z])=>{if(this.destroyed){z();return}if(this._stats?.time("Rendering"),!(Z.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");L.initializeGraphics({transparency:j,optionalContentConfig:Z}),L.operatorListChanged()}).catch(z),G}getOperatorList({intent:t="display",annotationMode:i=qn.ENABLE,printAnnotationStorage:s=null,isEditing:a=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,i,s,a,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Cr.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,a){function o(){l.read().then(function({value:h,done:d}){if(d){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),o()},a)}const l=i.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#e();return t&&i&&(this._stats&&=new Vg),i}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,a=t.length;s<a;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:a}){const{map:o,transfer:l}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:o,modifiedIds:a},l).getReader(),d=this._intentStates.get(i);d.streamReader=h;const p=()=>{h.read().then(({value:m,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,d),p())},m=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();this.#e()}if(d.displayReadyCapability)d.displayReadyCapability.reject(m);else if(d.opListReadCapability)d.opListReadCapability.reject(m);else throw m}})};p()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof bh){let a=u_;i.extraDelay>0&&i.extraDelay<1e3&&(a+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},a);return}}if(t.streamReader.cancel(new Xn(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,o]of this._intentStates)if(o===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var Vn,Ii,yn,gs,vl,ms,ys,Ze,fl,a0,r0,_r,va,pl;const fe=class fe{constructor({name:t=null,port:i=null,verbosity:s=Yb()}={}){Gi(this,Ze);Gi(this,Vn,Promise.withResolvers());Gi(this,Ii,null);Gi(this,yn,null);Gi(this,gs,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(de(fe,ys).has(i))throw new Error("Cannot use more than one PDFWorker per port.");de(fe,ys).set(i,this),qi(this,Ze,a0).call(this,i)}else qi(this,Ze,r0).call(this)}get promise(){return de(this,Vn).promise}get port(){return de(this,yn)}get messageHandler(){return de(this,Ii)}destroy(){this.destroyed=!0,de(this,gs)?.terminate(),ai(this,gs,null),de(fe,ys).delete(de(this,yn)),ai(this,yn,null),de(this,Ii)?.destroy(),ai(this,Ii,null)}static create(t){const i=de(this,ys).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new fe(t)}static get workerSrc(){if(ba.workerSrc)return ba.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ht(this,"_setupFakeWorkerGlobal",(async()=>de(this,va,pl)?de(this,va,pl):(await import(this.workerSrc)).WorkerMessageHandler)())}};Vn=new WeakMap,Ii=new WeakMap,yn=new WeakMap,gs=new WeakMap,vl=new WeakMap,ms=new WeakMap,ys=new WeakMap,Ze=new WeakSet,fl=function(){de(this,Vn).resolve(),de(this,Ii).send("configure",{verbosity:this.verbosity})},a0=function(t){ai(this,yn,t),ai(this,Ii,new vr("main","worker",t)),de(this,Ii).on("ready",()=>{}),qi(this,Ze,fl).call(this)},r0=function(){if(de(fe,ms)||de(fe,va,pl)){qi(this,Ze,_r).call(this);return}let{workerSrc:t}=fe;try{fe._isSameOrigin(window.location,t)||(t=fe._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new vr("main","worker",i),a=()=>{o.abort(),s.destroy(),i.terminate(),this.destroyed?de(this,Vn).reject(new Error("Worker was destroyed")):qi(this,Ze,_r).call(this)},o=new AbortController;i.addEventListener("error",()=>{de(this,gs)||a()},{signal:o.signal}),s.on("test",u=>{if(o.abort(),this.destroyed||!u){a();return}ai(this,Ii,s),ai(this,yn,i),ai(this,gs,i),qi(this,Ze,fl).call(this)}),s.on("ready",u=>{if(o.abort(),this.destroyed){a();return}try{l()}catch{qi(this,Ze,_r).call(this)}});const l=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};l();return}catch{Sl("The worker has been disabled.")}qi(this,Ze,_r).call(this)},_r=function(){de(fe,ms)||(zt("Setting up fake worker."),ai(fe,ms,!0)),fe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){de(this,Vn).reject(new Error("Worker was destroyed"));return}const i=new Av;ai(this,yn,i);const s=`fake${kg(fe,vl)._++}`,a=new vr(s+"_worker",s,i);t.setup(a,i),ai(this,Ii,new vr(s,s+"_worker",i)),qi(this,Ze,fl).call(this)}).catch(t=>{de(this,Vn).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},va=new WeakSet,pl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Gi(fe,va),Gi(fe,vl,0),Gi(fe,ms,!1),Gi(fe,ys,new WeakMap),$e&&(ai(fe,ms,!0),ba.workerSrc||="./pdf.worker.mjs"),fe._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const a=new URL(i,s);return s.origin===a.origin},fe._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},fe.fromPort=t=>{if(sv("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return fe.create(t)};let Tr=fe;class f_{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,i,s,a,o,l){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new i0,this.fontLoader=new gv({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#s(t,i=null){const s=this.#t.get(t);if(s)return s;const a=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,a),a}get annotationStorage(){return Ht(this,"annotationStorage",new Sh)}getRenderingIntent(t,i=qn.ENABLE,s=null,a=!1,o=!1){let l=gi.DISPLAY,u=lh;switch(t){case"any":l=gi.ANY;break;case"display":break;case"print":l=gi.PRINT;break;default:zt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&gi.PRINT&&s instanceof qm?s:this.annotationStorage;switch(i){case qn.DISABLE:l+=gi.ANNOTATIONS_DISABLE;break;case qn.ENABLE:break;case qn.ENABLE_FORMS:l+=gi.ANNOTATIONS_FORMS;break;case qn.ENABLE_STORAGE:l+=gi.ANNOTATIONS_STORAGE,u=h.serializable;break;default:zt(`getRenderingIntent - invalid annotationMode: ${i}`)}a&&(l+=gi.IS_EDITING),o&&(l+=gi.OPLIST);const{ids:d,hash:p}=h.modifiedIds,m=[l,u.hash,p];return{renderingIntent:l,cacheKey:m.join("_"),annotationStorageSerializable:u,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Xe.cleanup(),this._networkStream?.cancelAllRequests(new Xn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,a)=>{Kt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},a.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){a.close();return}Kt(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{a.error(o)})},a.onCancel=o=>{this._fullReader.cancel(o),a.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:a,isRangeSupported:o,contentLength:l}=this._fullReader;return(!a||!o)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{i.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:a,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(s,a)=>{Kt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(s.begin,s.end);if(!o){a.close();return}a.onPull=()=>{o.read().then(function({value:l,done:u}){if(u){a.close();return}Kt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{o.cancel(l),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new h_(s,this))}),t.on("DocException",s=>{i._capability.reject(ri(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!i.onPassword)throw ri(s);const a=o=>{o instanceof Error?this.#r.reject(o):this.#r.resolve({password:o})};i.onPassword(a,s.code)}catch(a){this.#r.reject(a)}return this.#r.promise}),t.on("DataLoaded",s=>{i.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,a,o])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(a){case"Font":if("error"in o){const p=o.error;zt(`Error during font loading: ${p}`),this.commonObjs.resolve(s,p);break}const l=new ae(o),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(p,m)=>globalThis.FontInspector.fontAdded(p,m):null,h=new mv(l,u,o.extra,o.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:d}=o;Kt(d,"The imageRef must be defined.");for(const p of this.#e.values())for(const[,m]of p.objs)if(m?.ref===d)return m.dataLen?(this.commonObjs.resolve(s,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,o);break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([s,a,o,l])=>{if(this.destroyed)return;const u=this.#e.get(a);if(!u.objs.has(s)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":case"Pattern":u.objs.resolve(s,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{this.destroyed||i.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[s.type];if(!a)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&zt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#n.get(i);if(s)return s;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#i.set(o.refStr,t);const l=new d_(i,o,this,this._params.pdfBug);return this.#e.set(i,l),l});return this.#n.set(i,a),a}getPageIndex(t){return ch(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(i=>new Vv(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new Gv(a[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Xe.cleanup()}}cachedPageNumber(t){if(!ch(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(i)??null}}class p_{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class pa{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:a,annotationCanvasMap:o,operatorList:l,pageIndex:u,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:m=!1,pageColors:v=null,enableHWA:b=!1,operationsFilter:A=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=a,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=m,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new p_(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=b,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=A}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(pa.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");pa.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:a,background:o,dependencyTracker:l}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ga(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:a,viewport:s,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),pa.#e.delete(this._canvas),t||=new bh(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),pa.#e.delete(this._canvas),this.callback())))}}const g_="5.4.296",m_="f56dc8601";class ki{#t=null;#e=null;#n;#i=null;#r=!1;#s=!1;#a=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Ht(this,"_keyboardManager",new Lr([[["Escape","mac+Escape"],ki.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ki.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ki.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ki.prototype._moveToPrevious],[["Home","mac+Home"],ki.prototype._moveToBeginning],[["End","mac+End"],ki.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#s=!1,this.#a=t):this.#s=!0,this.#l=t?._uiManager||i,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",ki.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const i=this.#l._signal;t.addEventListener("click",this.#p.bind(this),{signal:i}),t.addEventListener("keydown",this.#m.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#l._signal;t.addEventListener("contextmenu",Ni,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[s,a]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",a),o.title=s,o.setAttribute("data-l10n-id",ki.#d[s]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=a,o.ariaSelected=a===this.#n,o.addEventListener("click",this.#f.bind(this,a),{signal:i}),t.append(o)}return t.addEventListener("keydown",this.#m.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:$t.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#g){this.#p(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#g){this.#p(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#g){this.#p(t);return}this.#i.lastChild?.focus()}#m(t){ki._keyboardManager.exec(this,t)}#p(t){if(this.#g){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#g){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#l.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class xr{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,xr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,colorValue:s}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=s||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",xr.#i[t]),a.addEventListener("input",()=>{this.#n.updateParams(i,a.value)},{signal:this.#n._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function fm(g){return Math.floor(Math.max(0,Math.min(1,g))*255).toString(16).padStart(2,"0")}function mr(g){return Math.max(0,Math.min(255,255*g))}class pm{static CMYK_G([t,i,s,a]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=mr(t),[t,t,t]}static G_HTML([t]){const i=fm(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(mr)}static RGB_HTML(t){return`#${t.map(fm).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,s+a),1-Math.min(1,i+a)]}static CMYK_rgb([t,i,s,a]){return[mr(1-Math.min(1,t+a)),mr(1-Math.min(1,s+a)),mr(1-Math.min(1,i+a))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const a=1-t,o=1-i,l=1-s,u=Math.min(a,o,l);return["CMYK",a,o,l,u]}}class y_{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),s||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${i}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${i}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){le("Abstract method `_createSVG` called.")}}class bl extends y_{_createSVG(t){return document.createElementNS(gn,t)}}const b_=9,vs=new WeakSet,v_=new Date().getTimezoneOffset()*60*1e3;class gm{static create(t){switch(t.data.annotationType){case Me.LINK:return new xh(t);case Me.TEXT:return new A_(t);case Me.WIDGET:switch(t.data.fieldType){case"Tx":return new S_(t);case"Btn":return t.data.radioButton?new o0(t):t.data.checkBox?new E_(t):new C_(t);case"Ch":return new T_(t);case"Sig":return new w_(t)}return new Ss(t);case Me.POPUP:return new dh(t);case Me.FREETEXT:return new l0(t);case Me.LINE:return new M_(t);case Me.SQUARE:return new R_(t);case Me.CIRCLE:return new D_(t);case Me.POLYLINE:return new c0(t);case Me.CARET:return new k_(t);case Me.INK:return new Mh(t);case Me.POLYGON:return new O_(t);case Me.HIGHLIGHT:return new u0(t);case Me.UNDERLINE:return new N_(t);case Me.SQUIGGLY:return new L_(t);case Me.STRIKEOUT:return new B_(t);case Me.STAMP:return new h0(t);case Me.FILEATTACHMENT:return new z_(t);default:return new me(t)}}}class me{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,i&&(this.container=this._createContainer(s)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return me._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:a}=this.data;let o=-1/0,l=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>l?(l=i[u+1],o=i[u+2]):i[u+1]===l&&(o=Math.max(o,i[u+2]));return[o,l]}if(s?.length>=1){for(const u of s)for(let h=0,d=u.length;h<d;h+=2)u[h+1]>l?(l=u[h+1],o=u[h]):u[h+1]===l&&(o=Math.max(o,u[h]));if(o!==1/0)return[o,l]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-o)/s,t[1]=100*(t[1]-l)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${wr}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${wr}${i.id}`,{id:i.id,annotationType:i.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let a=this.#n?.popup||this.popup;!a&&s?.text&&(this._createPopup(s),a=this.#n.popup),a&&(a.updateEdited(t),s?.deleted&&(a.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:a},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/o}%`,i.top=`${100*(l-t[3]+h)/l}%`,a===0?(i.width=`${100*(t[2]-t[0])/o}%`,i.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(a)}_createContainer(t){const{data:i,parent:{page:s,viewport:a}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",i.id),!(this instanceof Ss)&&!(this instanceof xh)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(o.title=i.alternativeText),i.noRotate&&o.classList.add("norotate"),!i.rect||this instanceof dh){const{rotation:_}=i;return!i.hasOwnCanvas&&_!==0&&this.setRotation(_,o),o}const{width:u,height:h}=this;if(!t&&i.borderStyle.width>0){l.borderWidth=`${i.borderStyle.width}px`;const _=i.borderStyle.horizontalCornerRadius,w=i.borderStyle.verticalCornerRadius;if(_>0||w>0){const T=`calc(${_}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;l.borderRadius=T}else if(this instanceof o0){const T=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=T}switch(i.borderStyle.style){case ua.SOLID:l.borderStyle="solid";break;case ua.DASHED:l.borderStyle="dashed";break;case ua.BEVELED:zt("Unimplemented border style: beveled");break;case ua.INSET:zt("Unimplemented border style: inset");break;case ua.UNDERLINE:l.borderBottomStyle="solid";break}const S=i.borderColor||null;S?(this.#e=!0,l.borderColor=Ct.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):l.borderWidth=0}const d=Ct.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:m,pageX:v,pageY:b}=a.rawDims;l.left=`${100*(d[0]-v)/p}%`,l.top=`${100*(d[1]-b)/m}%`;const{rotation:A}=i;return i.hasOwnCanvas||A===0?(l.width=`${100*u/p}%`,l.height=`${100*h/m}%`):this.setRotation(A,o),o}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:a}=this.parent.viewport.rawDims;let{width:o,height:l}=this;t%180!==0&&([o,l]=[l,o]),i.style.width=`${100*o/s}%`,i.style.height=`${100*l/a}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,a)=>{const o=a.detail[i],l=o[0],u=o.slice(1);a.target.style[s]=pm[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:pm[`${l}_rgb`](u)})};return Ht(this,"_commonActions",{display:i=>{const{display:s}=i.detail,a=s%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const a of Object.keys(i.detail))(t[a]||s[a])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[a,o]of Object.entries(i)){const l=s[a];if(l){const u={detail:{[a]:o},target:t};l(u),delete i[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,a,o]=this.data.rect.map(_=>Math.fround(_));if(t.length===8){const[_,w,S,T]=t.subarray(2,6);if(a===_&&o===w&&i===S&&s===T)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:_,borderWidth:w}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const h=a-i,d=o-s,{svgFactory:p}=this,m=p.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const v=p.createElement("defs");m.append(v);const b=p.createElement("clipPath"),A=`clippath_${this.data.id}`;b.setAttribute("id",A),b.setAttribute("clipPathUnits","objectBoundingBox"),v.append(b);for(let _=2,w=t.length;_<w;_+=8){const S=t[_],T=t[_+1],M=t[_+2],k=t[_+3],O=p.createElement("rect"),z=(M-i)/h,L=(o-T)/d,G=(S-M)/h,j=(T-k)/d;O.setAttribute("x",z),O.setAttribute("y",L),O.setAttribute("width",G),O.setAttribute("height",j),b.append(O),u?.push(`<rect vector-effect="non-scaling-stroke" x="${z}" y="${L}" width="${G}" height="${j}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(m),this.container.style.clipPath=`url(#${A})`}_createPopup(t=null){const{data:i}=this;let s,a;t?(s={str:t.text},a=t.date):(s=i.contentsObj,a=i.modificationDate);const o=this.#n=new dh({data:{color:i.color,titleObj:i.titleObj,modificationDate:a,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(o.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){le("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:o,id:l,exportValues:u}of a){if(o===-1||l===i)continue;const h=typeof u=="string"?u:null,d=document.querySelector(`[data-element-id="${l}"]`);if(d&&!vs.has(d)){zt(`_getElementsByName - element not allowed: ${l}`);continue}s.push({id:l,exportValue:h,domElement:d})}return s}for(const a of document.getElementsByName(t)){const{exportValue:o}=a,l=a.getAttribute("data-element-id");l!==i&&vs.has(a)&&s.push({id:l,exportValue:o,domElement:a})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class __ extends me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class xh extends me{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let a=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),a=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(s,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&this.container.append(s),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",a=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,a),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(i.actions)){const o=s.get(a);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:a}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){zt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:a,refs:o,include:l}=i,u=[];if(a.length!==0||o.length!==0){const p=new Set(o);for(const m of a){const v=this._fieldObjects[m]||[];for(const{id:b}of v)p.add(b)}for(const m of Object.values(this._fieldObjects))for(const v of m)p.has(v.id)===l&&u.push(v)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const h=this.annotationStorage,d=[];for(const p of u){const{id:m}=p;switch(d.push(m),p.type){case"text":{const b=p.defaultValue||"";h.setValue(m,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;h.setValue(m,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";h.setValue(m,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${m}"]`);if(v){if(!vs.has(v)){zt(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class A_ extends me{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Ss extends me{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Ge.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,a,o){s.includes("mouse")?t.addEventListener(s,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(s,l=>{if(s==="blur"){if(!i.focused||!l.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l)}})})}_setEventListeners(t,i,s,a){for(const[o,l]of s)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,o,l,a),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":Ct.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||b_,o=t.style;let l;const u=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(d/($u*a))||1,m=d/p;l=Math.min(a,h(m/$u))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(a,h(d/$u))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=Ct.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class S_ extends Ss{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,a){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[i]=s),o.setValue(l.id,{[a]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=t.getValue(i,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),vs.add(s),s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:d,datetimeType:p,timeStep:m}=this.data,v=!!p&&this.enableScripting;d&&(s.title=d),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",A=>{t.setValue(i,{value:A.target.value}),this.setPropertyOnSiblings(s,"value",A.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",A=>{const _=this.data.defaultFieldValue??"";s.value=h.userValue=_,h.formattedValue=null});let b=A=>{const{formattedValue:_}=h;_!=null&&(A.target.value=_),A.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",_=>{if(h.focused)return;const{target:w}=_;if(v&&(w.type=p,m&&(w.step=m)),h.userValue){const S=h.userValue;if(v)if(p==="time"){const T=new Date(S),M=[T.getHours(),T.getMinutes(),T.getSeconds()];w.value=M.map(k=>k.toString().padStart(2,"0")).join(":")}else w.value=new Date(S-v_).toISOString().split(p==="date"?"T":".",1)[0];else w.value=S}h.lastCommittedValue=w.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const w={value(S){h.userValue=S.detail.value??"",v||t.setValue(i,{value:h.userValue.toString()}),S.target.value=h.userValue},formattedValue(S){const{formattedValue:T}=S.detail;h.formattedValue=T,T!=null&&S.target!==document.activeElement&&(S.target.value=T);const M={formattedValue:T};v&&(M.value=T),t.setValue(i,M)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{const{charLimit:T}=S.detail,{target:M}=S;if(T===0){M.removeAttribute("maxLength");return}M.setAttribute("maxLength",T);let k=h.userValue;!k||k.length<=T||(k=k.slice(0,T),M.value=h.userValue=k,t.setValue(i,{value:k}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:M.selectionStart,selEnd:M.selectionEnd}}))}};this._dispatchEventFromSandbox(w,_)}),s.addEventListener("keydown",_=>{h.commitKey=1;let w=-1;if(_.key==="Escape"?w=0:_.key==="Enter"&&!this.data.multiLine?w=2:_.key==="Tab"&&(h.commitKey=3),w===-1)return;const{value:S}=_.target;h.lastCommittedValue!==S&&(h.lastCommittedValue=S,h.userValue=S,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:S,willCommit:!0,commitKey:w,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const A=b;b=null,s.addEventListener("blur",_=>{if(!h.focused||!_.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:w}=_;let{value:S}=w;if(v){if(S&&p==="time"){const T=S.split(":").map(M=>parseInt(M,10));S=new Date(2e3,0,1,T[0],T[1],T[2]||0).valueOf(),w.step=""}else S.includes("T")||(S=`${S}T00:00`),S=new Date(S).valueOf();w.type="text"}h.userValue=S,h.lastCommittedValue!==S&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:S,willCommit:!0,commitKey:h.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}),A(_)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",_=>{h.lastCommittedValue=null;const{data:w,target:S}=_,{value:T,selectionStart:M,selectionEnd:k}=S;let O=M,z=k;switch(_.inputType){case"deleteWordBackward":{const L=T.substring(0,M).match(/\w*[^\w]*$/);L&&(O-=L[0].length);break}case"deleteWordForward":{const L=T.substring(M).match(/^[^\w]*\w*/);L&&(z+=L[0].length);break}case"deleteContentBackward":M===k&&(O-=1);break;case"deleteContentForward":M===k&&(z+=1);break}_.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:T,change:w||"",willCommit:!1,selStart:O,selEnd:z}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(b&&s.addEventListener("blur",b),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class w_ extends Ss{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class E_ extends Ss{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let a=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(s,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return vs.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=i.fieldName,a&&o.setAttribute("checked",!0),o.setAttribute("exportValue",i.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const d of this._getElementsByName(u,s)){const p=h&&d.exportValue===i.exportValue;d.domElement&&(d.domElement.checked=p),t.setValue(d.id,{value:p})}t.setValue(s,{value:h})}),o.addEventListener("resetform",l=>{const u=i.defaultFieldValue||"Off";l.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class o0 extends Ss{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let a=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof a=="string"&&(a=a!==i.buttonValue,t.setValue(s,{value:a})),a)for(const l of this._getElementsByName(i.fieldName,s))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(vs.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=i.fieldName,a&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const d of this._getElementsByName(u,s))t.setValue(d.id,{value:!1});t.setValue(s,{value:h})}),o.addEventListener("resetform",l=>{const u=i.defaultFieldValue;l.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const l=i.buttonValue;o.addEventListener("updatefromsandbox",u=>{const h={value:d=>{const p=l===d.detail.value;for(const m of this._getElementsByName(d.target.name)){const v=p&&m.id===s;m.domElement&&(m.domElement.checked=v),t.setValue(m.id,{value:v})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class C_ extends xh{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class T_ extends Ss{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),a=document.createElement("select");vs.add(a),a.setAttribute("data-element-id",i),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue;for(const v of a.options)v.selected=v.value===m});for(const p of this.data.options){const m=document.createElement("option");m.textContent=p.displayValue,m.value=p.exportValue,s.value.includes(p.exportValue)&&(m.setAttribute("selected",!0),o=!1),a.append(m)}let l=null;if(o){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),a.prepend(p),l=()=>{p.remove(),a.removeEventListener("input",l),l=null},a.addEventListener("input",l)}const u=p=>{const m=p?"value":"textContent",{options:v,multiple:b}=a;return b?Array.prototype.filter.call(v,A=>A.selected).map(A=>A[m]):v.selectedIndex===-1?null:v[v.selectedIndex][m]};let h=u(!1);const d=p=>{const m=p.target.options;return Array.prototype.map.call(m,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",p=>{const m={value(v){l?.();const b=v.detail.value,A=new Set(Array.isArray(b)?b:[b]);for(const _ of a.options)_.selected=A.has(_.value);t.setValue(i,{value:u(!0)}),h=u(!1)},multipleSelection(v){a.multiple=!0},remove(v){const b=a.options,A=v.detail.remove;b[A].selected=!1,a.remove(A),b.length>0&&Array.prototype.findIndex.call(b,w=>w.selected)===-1&&(b[0].selected=!0),t.setValue(i,{value:u(!0),items:d(v)}),h=u(!1)},clear(v){for(;a.length!==0;)a.remove(0);t.setValue(i,{value:null,items:[]}),h=u(!1)},insert(v){const{index:b,displayValue:A,exportValue:_}=v.detail.insert,w=a.children[b],S=document.createElement("option");S.textContent=A,S.value=_,w?w.before(S):a.append(S),t.setValue(i,{value:u(!0),items:d(v)}),h=u(!1)},items(v){const{items:b}=v.detail;for(;a.length!==0;)a.remove(0);for(const A of b){const{displayValue:_,exportValue:w}=A,S=document.createElement("option");S.textContent=_,S.value=w,a.append(S)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(i,{value:u(!0),items:d(v)}),h=u(!1)},indices(v){const b=new Set(v.detail.indices);for(const A of v.target.options)A.selected=b.has(A.index);t.setValue(i,{value:u(!0)}),h=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(m,p)}),a.addEventListener("input",p=>{const m=u(!0),v=u(!1);t.setValue(i,{value:m}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:h,change:v,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):a.addEventListener("input",function(p){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class dh extends me{constructor(t){const{data:i,elements:s,parent:a}=t,o=!!a._commentManager;if(super(t,{isRenderable:!o&&me._hasPopupData(i)}),this.elements=s,o&&me._hasPopupData(i)){const l=this.popup=this.#t();for(const u of s)u.popup=l}else this.popup=null}#t(){return new x_({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const a of this.elements)a.popup=i,a.container.ariaHasPopup="dialog",s.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(a=>`${yh}${a}`).join(",")),this.container}}class x_{#t=null;#e=this.#q.bind(this);#n=this.#P.bind(this);#i=this.#N.bind(this);#r=this.#A.bind(this);#s=null;#a=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#p=null;#u=null;#g=null;#y=null;#v=null;#b=null;#C=null;#w=null;#_=null;#x=!1;#S=null;#E=null;constructor({container:t,color:i,elements:s,titleObj:a,modificationDate:o,contentsObj:l,richText:u,parent:h,rect:d,parentRect:p,open:m,commentManager:v=null}){this.#a=t,this.#w=a,this.#o=l,this.#C=u,this.#d=h,this.#s=i,this.#b=d,this.#h=p,this.#l=s,this.#t=v,this.#S=s[0],this.#c=ah.toDateObject(o),this.trigger=s.flatMap(b=>b.getElementsToTriggerPopup()),v?this.renderCommentButton():(this.#D(),this.#a.hidden=!0,m&&this.#A())}#D(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const i of this.trigger)i.addEventListener("click",this.#r,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#l)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#l.find(i=>i.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#g||(this.#y||this.#M(),!this.#y))return;const{signal:t}=this.#p=new AbortController,i=!!this.#S.extraPopupElement,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},o=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#g=this.#S.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=this.#g=document.createElement("button");l.className="annotationCommentButton";const u=this.#S.container;l.style.zIndex=u.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#I(),this.#R(),l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),u.after(l)}}#R(){if(this.#S.extraPopupElement&&!this.#S.editor)return;this.renderCommentButton();const[t,i]=this.#y,{style:s}=this.#g;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#I(){this.#S.extraPopupElement||(this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#S.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:a,modificationDate:o}=this.#S.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:a,modificationDate:o}}get elementBeforePopup(){return this.#g}get comment(){return this.#E||=this.#S.commentText,this.#E}set comment(t){t!==this.comment&&(this.#S.commentText=this.#E=t)}get parentBoundingClientRect(){return this.#S.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#g&&(this.#g.classList.toggle("selected",t),this.#g.ariaExpanded=i)}setSelectedCommentButton(t){this.#g.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#g.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#S.layer.getBoundingClientRect();return[(t-a)/l,(i+s-o)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(d=>d/100),a=this.parentBoundingClientRect,{x:o,y:l,width:u,height:h}=a;this.#t.showDialog(null,this,o+i*u,l+s*h,{...t,parentDimensions:a})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#s){const s=t.style.outlineColor=Ct.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#w?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#w}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}Hm({html:this.#k||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#a.append(t)}get#k(){const t=this.#C,i=this.#o;return t?.str&&(!i?.str||i.str===t.str)&&this.#C.html||null}get#L(){return this.#k?.attributes?.style?.fontSize||0}get#F(){return this.#k?.attributes?.style?.color||null}#B(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},a={style:{color:this.#F,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))i.push({name:"span",value:o,attributes:a});return s}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#A()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#E=null):i&&(i.deleted?this.remove():(this.#I(),this.#E=i.text)),t&&(this.#y=null,this.#M(),this.#R());return}if(s||i?.deleted){this.remove();return}this.#D(),this.#_||={contentsObj:this.#o,richText:this.#C},t&&(this.#u=null),i&&i.text&&(this.#C=this.#B(i.text),this.#c=ah.toDateObject(i.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#_&&({contentsObj:this.#o,richText:this.#C}=this.#_,this.#_=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#x=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:o}}}=this.#d;let l=!!this.#h,u=l?this.#h:this.#b;for(const A of this.#l)if(!u||Ct.intersect(A.data.rect,u)!==null){u=A.data.rect,l=!0;break}const h=Ct.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=l?u[2]-u[0]+5:0,m=h[0]+p,v=h[1];this.#u=[100*(m-a)/i,100*(v-o)/s];const{style:b}=this.#a;b.left=`${this.#u[0]}%`,b.top=`${this.#u[1]}%`}#A(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#N(),this.#a.addEventListener("click",this.#r),this.#a.addEventListener("keydown",this.#e)):(this.#P(),this.#a.removeEventListener("click",this.#r),this.#a.removeEventListener("keydown",this.#e))}#N(){this.#m||this.render(),this.isVisible?this.#f&&this.#a.classList.add("focused"):(this.#T(),this.#a.hidden=!1,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)+1e3)}#P(){this.#a.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#a.hidden=!0,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#a.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#x&&(this.#m||this.#N(),this.#x=!1,this.#a.hidden=!1))}get isVisible(){return this.#t?!1:this.#a.hidden===!1}}class l0 extends me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=It.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class M_ extends me{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),a.append(o),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class R_ extends me{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",i-o),l.setAttribute("height",s-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class D_ extends me{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",i/2),l.setAttribute("cy",s/2),l.setAttribute("rx",i/2-o/2),l.setAttribute("ry",s/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class c0 extends me{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:a},width:o,height:l}=this;if(!i)return this.container;const u=this.svgFactory.create(o,l,!0);let h=[];for(let p=0,m=i.length;p<m;p+=2){const v=i[p]-t[0],b=t[3]-i[p+1];h.push(`${v},${b}`)}h=h.join(" ");const d=this.#t=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),u.append(d),this.container.append(u),!a&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class O_ extends c0{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class k_ extends me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Mh extends me{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?It.HIGHLIGHT:It.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:a,popupRef:o}}=this,{transform:l,width:u,height:h}=this.#n(i,t),d=this.svgFactory.create(u,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");d.append(p),p.setAttribute("stroke-width",a.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let m=0,v=s.length;m<v;m++){const b=this.svgFactory.createElement(this.svgElementName);this.#e.push(b),b.setAttribute("points",s[m].join(",")),p.append(b)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:a}=t,o=this.#t;if(i>=0&&o.setAttribute("stroke-width",i||1),s)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",s[l].join(","));if(a){const{transform:l,width:u,height:h}=this.#n(this.data.rotation,a);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class u0 extends me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=It.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class N_ extends me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class L_ extends me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class B_ extends me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class h0 extends me{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=It.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class z_ extends me{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:a}=Ge.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(a?o.metaKey:o.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Rh{#t=null;#e=null;#n=null;#i=new Map;#r=null;#s=null;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:a,page:o,viewport:l,structTreeLayer:u,commentManager:h,linkService:d,annotationStorage:p}){this.div=t,this.#t=i,this.#e=s,this.#r=u||null,this.#s=d||null,this.#n=p||new Sh,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async#a(t,i,s){const a=t.firstChild||t,o=a.id=`${yh}${i}`,l=await this.#r?.getAriaAttributes(o);if(l)for(const[u,h]of l)a.setAttribute(u,h);s?s.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,a,!1))}async render(t){const{annotations:i}=t,s=this.div;bs(s,this.viewport);const a=new Map,o={data:null,layer:s,linkService:this.#s,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new bl,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of i){if(l.noHTML)continue;const u=l.annotationType===Me.POPUP;if(u){const p=a.get(l.id);if(!p)continue;o.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;o.data=l;const h=gm.create(o);if(!h.isRenderable)continue;if(!u&&l.popupRef){const p=a.get(l.popupRef);p?p.push(h):a.set(l.popupRef,[h])}const d=h.render();l.hidden&&(d.style.visibility="hidden"),await this.#a(d,l.id,o.elements),h.extraPopupElement?.popup?.renderCommentButton(),h._isEditable&&(this.#i.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#o()}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#s,svgFactory:new bl,parent:this};for(const s of t){s.borderStyle||=Rh._defaultBorderStyle,i.data=s;const a=gm.create(i);if(!a.isRenderable)continue;const o=a.render();await this.#a(o,s.id,null)}}update({viewport:t}){const i=this.div;this.viewport=t,bs(i,{rotation:t.rotation}),this.#o(),i.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const a=t.querySelector(`[data-annotation-id="${i}"]`);if(!a)continue;s.className="annotationContent";const{firstChild:o}=a;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):a.append(s);const l=this.#i.get(i);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,a.id,s),l._hasNoCanvas=!1):l.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:a}=t,o=new __({data:{id:s,rect:t.getPDFRect(),rotation:a},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#s,annotationStorage:this.#n}),l=o.render();return i.append(l),this.#t?.moveElementInDOM(i,l,l,!1),o.createOrUpdatePopup(),o}static get _defaultBorderStyle(){return Ht(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ua.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const ll=/\r\n?|\n/g;class Le extends Ot{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Le.prototype,i=o=>o.isEmpty(),s=$n.TRANSLATE_SMALL,a=$n.TRANSLATE_BIG;return Ht(this,"_keyboardManager",new Lr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:i}]]))}static _type="freetext";static _editorType=It.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Le._defaultColor||Ot._defaultLineColor,this.#i=t.fontSize||Le._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,i){Ot.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case $t.FREETEXT_SIZE:Le._defaultFontSize=i;break;case $t.FREETEXT_COLOR:Le._defaultColor=i;break}}updateParams(t,i){switch(t){case $t.FREETEXT_SIZE:this.#r(i);break;case $t.FREETEXT_COLOR:this.#s(i);break}}static get defaultPropertiesToUpdate(){return[[$t.FREETEXT_SIZE,Le._defaultFontSize],[$t.FREETEXT_COLOR,Le._defaultColor||Ot._defaultLineColor]]}get propertiesToUpdate(){return[[$t.FREETEXT_SIZE,this.#i],[$t.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new xr(this),[["colorPicker",this._colorPicker]]}get colorType(){return $t.FREETEXT_COLOR}#r(t){const i=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#i)*this.parentScale),this.#i=a,this.#o()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$t.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#s(t){const i=a=>{this.color=a,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$t.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-Le._internalPadding*t,-(Le._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(Le.#c(s)),i=s);return t.join(`
`)}#o(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:a,div:o}=this,l=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",a.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#a().trimEnd();if(t===i)return;const s=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Le._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[d,p]=this.pageDimensions,[m,v]=this.pageTranslation;let b,A;switch(this.rotation){case 0:b=t+(l[0]-m)/d,A=i+this.height-(l[1]-v)/p;break;case 90:b=t+(l[0]-m)/d,A=i-(l[1]-v)/p,[u,h]=[h,-u];break;case 180:b=t-this.width+(l[0]-m)/d,A=i-(l[1]-v)/p,[u,h]=[-u,-h];break;case 270:b=t+(l[0]-m-this.height*p)/d,A=i+(l[1]-v-this.width*d)/p,[u,h]=[-h,u];break}this.setAt(b*a,A*o,u,h)}else this._moveAfterPaste(t,i);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ll,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const a=Le.#h(i.getData("text")||"").replaceAll(ll,`
`);if(!a)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!a.includes(`
`)){l.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:h}=l,d=[],p=[];if(u.nodeType===Node.TEXT_NODE){const b=u.parentElement;if(p.push(u.nodeValue.slice(h).replaceAll(ll,"")),b!==this.editorDiv){let A=d;for(const _ of this.editorDiv.childNodes){if(_===b){A=p;continue}A.push(Le.#c(_))}}d.push(u.nodeValue.slice(0,h).replaceAll(ll,""))}else if(u===this.editorDiv){let b=d,A=0;for(const _ of this.editorDiv.childNodes)A++===h&&(b=p),b.push(Le.#c(_))}this.#t=`${d.join(`
`)}${a}${p.join(`
`)}`,this.#l();const m=new Range;let v=Math.sumPrecise(d.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const A=b.nodeValue.length;if(v<=A){m.setStart(b,v),m.setEnd(b,v);break}v-=A}o.removeAllRanges(),o.addRange(m)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(" "," ")}static#h(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Le._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let a=null;if(t instanceof l0){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:d,id:p,popupRef:m,richText:v,contentsObj:b,creationDate:A,modificationDate:_},textContent:w,textPosition:S,parent:{page:{pageNumber:T}}}=t;if(!w||w.length===0)return null;a=t={annotationType:It.FREETEXT,color:Array.from(u),fontSize:l,value:w.join(`
`),position:S,pageIndex:T-1,rect:h.slice(0),rotation:d,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:b?.str||null,richText:v,creationDate:A,modificationDate:_}}const o=await super.deserialize(t,i,s);return o.#i=t.fontSize,o.color=Ct.makeHexColor(...t.color),o.#t=Le.#h(t.value),o._initialData=a,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Ot._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((l,u)=>l!==a[u])||t.pageIndex!==o}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const a of this.#t.split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class wt{static PRECISION=1e-4;toSVGPath(){le("Abstract method `toSVGPath` must be implemented.")}get box(){le("Abstract getter `box` must be implemented.")}serialize(t,i){le("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=i+t[u]*a,l[u+1]=s+t[u+1]*o;return l}static _rescaleAndSwap(t,i,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=i+t[u+1]*a,l[u+1]=s+t[u]*o;return l}static _translate(t,i,s,a){a||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=i+t[o],a[o+1]=s+t[o+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,a,o){switch(o){case 90:return[1-i/s,t/a];case 180:return[1-t/s,1-i/a];case 270:return[i/s,1-t/a];default:return[t/s,i/a]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,a,o,l){return[(t+5*s)/6,(i+5*a)/6,(5*s+o)/6,(5*a+l)/6,(s+o)/2,(a+l)/2]}}class ps{#t;#e=[];#n;#i;#r=[];#s=new Float32Array(18);#a;#o;#c;#l;#d;#h;#f=[];static#m=8;static#p=2;static#u=ps.#m+ps.#p;constructor({x:t,y:i},s,a,o,l,u=0){this.#t=s,this.#h=o*a,this.#i=l,this.#s.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#l=ps.#m*a,this.#c=ps.#u*a,this.#d=a,this.#f.push(t,i)}isEmpty(){return isNaN(this.#s[8])}#g(){const t=this.#s.subarray(4,6),i=this.#s.subarray(16,18),[s,a,o,l]=this.#t;return[(this.#a+(t[0]-i[0])/2-s)/o,(this.#o+(t[1]-i[1])/2-a)/l,(this.#a+(i[0]-t[0])/2-s)/o,(this.#o+(i[1]-t[1])/2-a)/l]}add({x:t,y:i}){this.#a=t,this.#o=i;const[s,a,o,l]=this.#t;let[u,h,d,p]=this.#s.subarray(8,12);const m=t-d,v=i-p,b=Math.hypot(m,v);if(b<this.#c)return!1;const A=b-this.#l,_=A/b,w=_*m,S=_*v;let T=u,M=h;u=d,h=p,d+=w,p+=S,this.#f?.push(t,i);const k=-S/A,O=w/A,z=k*this.#h,L=O*this.#h;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([d+z,p+L],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([d-z,p-L],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([u+z,h+L],2),this.#r.push(NaN,NaN,NaN,NaN,(u+z-s)/o,(h+L-a)/l),this.#s.set([u-z,h-L],14),this.#e.push(NaN,NaN,NaN,NaN,(u-z-s)/o,(h-L-a)/l)),this.#s.set([T,M,u,h,d,p],6),!this.isEmpty()):(this.#s.set([T,M,u,h,d,p],6),Math.abs(Math.atan2(M-h,T-u)-Math.atan2(S,w))<Math.PI/2?([u,h,d,p]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+d)/2-s)/o,((h+p)/2-a)/l),[u,h,T,M]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((T+u)/2-s)/o,((M+h)/2-a)/l),!0):([T,M,u,h,d,p]=this.#s.subarray(0,6),this.#r.push(((T+5*u)/6-s)/o,((M+5*h)/6-a)/l,((5*u+d)/6-s)/o,((5*h+p)/6-a)/l,((u+d)/2-s)/o,((h+p)/2-a)/l),[d,p,u,h,T,M]=this.#s.subarray(12,18),this.#e.push(((T+5*u)/6-s)/o,((M+5*h)/6-a)/l,((5*u+d)/6-s)/o,((5*h+p)/6-a)/l,((u+d)/2-s)/o,((h+p)/2-a)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,i=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?s.push(`L${t[a+4]} ${t[a+5]}`):s.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#b(s);for(let a=i.length-6;a>=6;a-=6)isNaN(i[a])?s.push(`L${i[a+4]} ${i[a+5]}`):s.push(`C${i[a]} ${i[a+1]} ${i[a+2]} ${i[a+3]} ${i[a+4]} ${i[a+5]}`);return this.#v(s),s.join(" ")}#y(){const[t,i,s,a]=this.#t,[o,l,u,h]=this.#g();return`M${(this.#s[2]-t)/s} ${(this.#s[3]-i)/a} L${(this.#s[4]-t)/s} ${(this.#s[5]-i)/a} L${o} ${l} L${u} ${h} L${(this.#s[16]-t)/s} ${(this.#s[17]-i)/a} L${(this.#s[14]-t)/s} ${(this.#s[15]-i)/a} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#b(t){const[i,s,a,o]=this.#t,l=this.#s.subarray(4,6),u=this.#s.subarray(16,18),[h,d,p,m]=this.#g();t.push(`L${(l[0]-i)/a} ${(l[1]-s)/o} L${h} ${d} L${p} ${m} L${(u[0]-i)/a} ${(u[1]-s)/o}`)}newFreeDrawOutline(t,i,s,a,o,l){return new d0(t,i,s,a,o,l)}getOutlines(){const t=this.#r,i=this.#e,s=this.#s,[a,o,l,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let m=0,v=h.length-2;m<v;m+=2)h[m]=(this.#f[m]-a)/l,h[m+1]=(this.#f[m+1]-o)/u;if(h[h.length-2]=(this.#a-a)/l,h[h.length-1]=(this.#o-o)/u,isNaN(s[6])&&!this.isEmpty())return this.#C(h);const d=new Float32Array(this.#r.length+24+this.#e.length);let p=t.length;for(let m=0;m<p;m+=2){if(isNaN(t[m])){d[m]=d[m+1]=NaN;continue}d[m]=t[m],d[m+1]=t[m+1]}p=this.#_(d,p);for(let m=i.length-6;m>=6;m-=6)for(let v=0;v<6;v+=2){if(isNaN(i[m+v])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=i[m+v],d[p+1]=i[m+v+1],p+=2}return this.#w(d,p),this.newFreeDrawOutline(d,h,this.#t,this.#d,this.#n,this.#i)}#C(t){const i=this.#s,[s,a,o,l]=this.#t,[u,h,d,p]=this.#g(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(i[2]-s)/o,(i[3]-a)/l,NaN,NaN,NaN,NaN,(i[4]-s)/o,(i[5]-a)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(i[16]-s)/o,(i[17]-a)/l,NaN,NaN,NaN,NaN,(i[14]-s)/o,(i[15]-a)/l],0),this.newFreeDrawOutline(m,t,this.#t,this.#d,this.#n,this.#i)}#w(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#_(t,i){const s=this.#s.subarray(4,6),a=this.#s.subarray(16,18),[o,l,u,h]=this.#t,[d,p,m,v]=this.#g();return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/u,(s[1]-l)/h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(a[0]-o)/u,(a[1]-l)/h],i),i+=24}}class d0 extends wt{#t;#e=new Float32Array(4);#n;#i;#r;#s;#a;constructor(t,i,s,a,o,l){super(),this.#a=t,this.#r=i,this.#t=s,this.#s=a,this.#n=o,this.#i=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[u,h,d,p]=this.#e;for(let m=0,v=t.length;m<v;m+=2)t[m]=(t[m]-u)/d,t[m+1]=(t[m+1]-h)/p;for(let m=0,v=i.length;m<v;m+=2)i[m]=(i[m]-u)/d,i[m+1]=(i[m+1]-h)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let i=6,s=this.#a.length;i<s;i+=6){if(isNaN(this.#a[i])){t.push(`L${this.#a[i+4]} ${this.#a[i+5]}`);continue}t.push(`C${this.#a[i]} ${this.#a[i+1]} ${this.#a[i+2]} ${this.#a[i+3]} ${this.#a[i+4]} ${this.#a[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,a],o){const l=s-t,u=a-i;let h,d;switch(o){case 0:h=wt._rescale(this.#a,t,a,l,-u),d=wt._rescale(this.#r,t,a,l,-u);break;case 90:h=wt._rescaleAndSwap(this.#a,t,i,l,u),d=wt._rescaleAndSwap(this.#r,t,i,l,u);break;case 180:h=wt._rescale(this.#a,s,i,-l,u),d=wt._rescale(this.#r,s,i,-l,u);break;case 270:h=wt._rescaleAndSwap(this.#a,s,a,-l,-u),d=wt._rescaleAndSwap(this.#r,s,a,-l,-u);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(t){const i=this.#a;let s=i[4],a=i[5];const o=[s,a,s,a];let l=s,u=a,h=s,d=a;const p=t?Math.max:Math.min,m=new Float32Array(4);for(let b=6,A=i.length;b<A;b+=6){const _=i[b+4],w=i[b+5];isNaN(i[b])?(Ct.pointBoundingBox(_,w,o),u>w?(l=_,u=w):u===w&&(l=p(l,_)),d<w?(h=_,d=w):d===w&&(h=p(h,_))):(m[0]=m[1]=1/0,m[2]=m[3]=-1/0,Ct.bezierBoundingBox(s,a,...i.slice(b,b+6),m),Ct.rectBoundingBox(m[0],m[1],m[2],m[3],o),u>m[1]?(l=m[0],u=m[1]):u===m[1]&&(l=p(l,m[0])),d<m[3]?(h=m[2],d=m[3]):d===m[3]&&(h=p(h,m[2]))),s=_,a=w}const v=this.#e;v[0]=o[0]-this.#n,v[1]=o[1]-this.#n,v[2]=o[2]-o[0]+2*this.#n,v[3]=o[3]-o[1]+2*this.#n,this.firstPoint=[l,u],this.lastPoint=[h,d]}get box(){return this.#e}newOutliner(t,i,s,a,o,l=0){return new ps(t,i,s,a,o,l)}getNewOutline(t,i){const[s,a,o,l]=this.#e,[u,h,d,p]=this.#t,m=o*d,v=l*p,b=s*d+u,A=a*p+h,_=this.newOutliner({x:this.#r[0]*m+b,y:this.#r[1]*v+A},this.#t,this.#s,t,this.#i,i??this.#n);for(let w=2;w<this.#r.length;w+=2)_.add({x:this.#r[w]*m+b,y:this.#r[w+1]*v+A});return _.getOutlines()}}class fh{#t;#e;#n;#i=[];#r=[];constructor(t,i=0,s=0,a=!0){const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:_,y:w,width:S,height:T}of t){const M=Math.floor((_-i)/l)*l,k=Math.ceil((_+S+i)/l)*l,O=Math.floor((w-i)/l)*l,z=Math.ceil((w+T+i)/l)*l,L=[M,O,z,!0],G=[k,O,z,!1];this.#i.push(L,G),Ct.rectBoundingBox(M,O,k,z,o)}const u=o[2]-o[0]+2*s,h=o[3]-o[1]+2*s,d=o[0]-s,p=o[1]-s;let m=a?-1/0:1/0,v=1/0;const b=this.#i.at(a?-1:-2),A=[b[0],b[2]];for(const _ of this.#i){const[w,S,T,M]=_;!M&&a?S<v?(v=S,m=w):S===v&&(m=Math.max(m,w)):M&&!a&&(S<v?(v=S,m=w):S===v&&(m=Math.min(m,w))),_[0]=(w-d)/u,_[1]=(S-p)/h,_[2]=(T-p)/h}this.#t=new Float32Array([d,p,u,h]),this.#e=[m,v],this.#n=A}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#l(i)),this.#o(i)):(this.#c(i),t.push(...this.#l(i)));return this.#s(t)}#s(t){const i=[],s=new Set;for(const l of t){const[u,h,d]=l;i.push([u,h,l],[u,d,l])}i.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=i.length;l<u;l+=2){const h=i[l][2],d=i[l+1][2];h.push(d),d.push(h),s.add(h),s.add(d)}const a=[];let o;for(;s.size>0;){const l=s.values().next().value;let[u,h,d,p,m]=l;s.delete(l);let v=u,b=h;for(o=[u,d],a.push(o);;){let A;if(s.has(p))A=p;else if(s.has(m))A=m;else break;s.delete(A),[u,h,d,p,m]=A,v!==u&&(o.push(v,b,u,b===h?h:d),v=u),b=b===h?d:h}o.push(v,b)}return new I_(a,this.#t,this.#e,this.#n)}#a(t){const i=this.#r;let s=0,a=i.length-1;for(;s<=a;){const o=s+a>>1,l=i[o][0];if(l===t)return o;l<t?s=o+1:a=o-1}return a+1}#o([,t,i]){const s=this.#a(t);this.#r.splice(s,0,[t,i])}#c([,t,i]){const s=this.#a(t);for(let a=s;a<this.#r.length;a++){const[o,l]=this.#r[a];if(o!==t)break;if(o===t&&l===i){this.#r.splice(a,1);return}}for(let a=s-1;a>=0;a--){const[o,l]=this.#r[a];if(o!==t)break;if(o===t&&l===i){this.#r.splice(a,1);return}}}#l(t){const[i,s,a]=t,o=[[i,s,a]],l=this.#a(a);for(let u=0;u<l;u++){const[h,d]=this.#r[u];for(let p=0,m=o.length;p<m;p++){const[,v,b]=o[p];if(!(d<=v||b<=h)){if(v>=h){if(b>d)o[p][1]=d;else{if(m===1)return[];o.splice(p,1),p--,m--}continue}o[p][2]=h,b>d&&o.push([i,d,b])}}}return o}}class I_ extends wt{#t;#e;constructor(t,i,s,a){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=a}toSVGPath(){const t=[];for(const i of this.#e){let[s,a]=i;t.push(`M${s} ${a}`);for(let o=2;o<i.length;o+=2){const l=i[o],u=i[o+1];l===s?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${l}`),s=l)}t.push("Z")}return t.join(" ")}serialize([t,i,s,a],o){const l=[],u=s-t,h=a-i;for(const d of this.#e){const p=new Array(d.length);for(let m=0;m<d.length;m+=2)p[m]=t+d[m]*u,p[m+1]=a-d[m+1]*h;l.push(p)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class ph extends ps{newFreeDrawOutline(t,i,s,a,o,l){return new F_(t,i,s,a,o,l)}}class F_ extends d0{newOutliner(t,i,s,a,o,l=0){return new ph(t,i,s,a,o,l)}}class Se extends Ot{#t=null;#e=0;#n;#i=null;#r=null;#s=null;#a=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#p=null;#u="";#g;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=It.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Se.prototype;return Ht(this,"_keyboardManager",new Lr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Se._defaultColor,this.#g=t.thickness||Se._defaultThickness,this.opacity=t.opacity||Se._defaultOpacity,this.#n=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#S()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#S(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new fh(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const i=new fh(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=i.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:a}=this.#s;this.#m=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#l=t;const a=1.5;if(this.#s=t.getNewOutline(this.#g/2+a,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Se.#E(this.#l.box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Se.#E(this.#s.box,m),path:{d:this.#s.toSVGPath()}})}const[o,l,u,h]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=u,this.height=h;break;case 90:{const[m,v]=this.parentDimensions;this.x=l,this.y=1-o,this.width=u*v/m,this.height=h*m/v;break}case 180:this.x=1-o,this.y=1-l,this.width=u,this.height=h;break;case 270:{const[m,v]=this.parentDimensions;this.x=1-l,this.y=o,this.width=u*v/m,this.height=h*m/v;break}}const{firstPoint:d}=t;this.#f=[(d[0]-o)/u,(d[1]-l)/h];const{lastPoint:p}=this.#s;this.#m=[(p[0]-o)/u,(p[1]-l)/h]}static initialize(t,i){Ot.initialize(t,i),Se._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case $t.HIGHLIGHT_COLOR:Se._defaultColor=i;break;case $t.HIGHLIGHT_THICKNESS:Se._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case $t.HIGHLIGHT_COLOR:this.#C(i);break;case $t.HIGHLIGHT_THICKNESS:this.#w(i);break}}static get defaultPropertiesToUpdate(){return[[$t.HIGHLIGHT_COLOR,Se._defaultColor],[$t.HIGHLIGHT_THICKNESS,Se._defaultThickness]]}get propertiesToUpdate(){return[[$t.HIGHLIGHT_COLOR,this.color||Se._defaultColor],[$t.HIGHLIGHT_THICKNESS,this.#g||Se._defaultThickness],[$t.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#C(t){const i=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},s=this.color,a=this.opacity;this.addCommands({cmd:i.bind(this,t,Se._defaultOpacity),undo:i.bind(this,s,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$t.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#w(t){const i=this.#g,s=a=>{this.#g=a,this.#_(a)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$t.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new ki({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#R())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#x(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#S(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#x():t&&(this.#S(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#_(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#x(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#S(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#E([t,i,s,a],o){switch(o){case 90:return[1-i-a,t,a,s];case 180:return[1-t-s,1-i-a,s,a];case 270:return[i,1-t-s,a,s]}return[t,i,s,a]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=Se.#E(this.#l.box,t)):s=Se.#E([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#p,{bbox:Se.#E(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(this.width,this.height),jm(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#D(t){Se._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#a,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#R(){return this.#h?this.rotation:0}#I(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,a]=this.pageTranslation,o=this.#n,l=new Float32Array(o.length*8);let u=0;for(const{x:h,y:d,width:p,height:m}of o){const v=h*t+s,b=(1-d)*i+a;l[u]=l[u+4]=v,l[u+1]=l[u+3]=b,l[u+2]=l[u+6]=v+p*t,l[u+5]=l[u+7]=b-m*i,u+=8}return l}#k(t){return this.#l.serialize(t,this.#R())}static startHighlighting(t,i,{target:s,x:a,y:o}){const{x:l,y:u,width:h,height:d}=s.getBoundingClientRect(),p=new AbortController,m=t.combinedSignal(p),v=b=>{p.abort(),this.#F(t,b)};window.addEventListener("blur",v,{signal:m}),window.addEventListener("pointerup",v,{signal:m}),window.addEventListener("pointerdown",ve,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Ni,{signal:m}),s.addEventListener("pointermove",this.#L.bind(this,t),{signal:m}),this._freeHighlight=new ph({x:a,y:o},[l,u,h,d],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let a=null;if(t instanceof u0){const{data:{quadPoints:A,rect:_,rotation:w,id:S,color:T,opacity:M,popupRef:k,richText:O,contentsObj:z,creationDate:L,modificationDate:G},parent:{page:{pageNumber:j}}}=t;a=t={annotationType:It.HIGHLIGHT,color:Array.from(T),opacity:M,quadPoints:A,boxes:null,pageIndex:j-1,rect:_.slice(0),rotation:w,annotationElementId:S,id:S,deleted:!1,popupRef:k,richText:O,comment:z?.str||null,creationDate:L,modificationDate:G}}else if(t instanceof Mh){const{data:{inkLists:A,rect:_,rotation:w,id:S,color:T,borderStyle:{rawWidth:M},popupRef:k,richText:O,contentsObj:z,creationDate:L,modificationDate:G},parent:{page:{pageNumber:j}}}=t;a=t={annotationType:It.HIGHLIGHT,color:Array.from(T),thickness:M,inkLists:A,boxes:null,pageIndex:j-1,rect:_.slice(0),rotation:w,annotationElementId:S,id:S,deleted:!1,popupRef:k,richText:O,comment:z?.str||null,creationDate:L,modificationDate:G}}const{color:o,quadPoints:l,inkLists:u,opacity:h}=t,d=await super.deserialize(t,i,s);d.color=Ct.makeHexColor(...o),d.opacity=h||1,u&&(d.#g=t.thickness),d._initialData=a,t.comment&&d.setCommentData(t);const[p,m]=d.pageDimensions,[v,b]=d.pageTranslation;if(l){const A=d.#n=[];for(let _=0;_<l.length;_+=8)A.push({x:(l[_]-v)/p,y:1-(l[_+1]-b)/m,width:(l[_+2]-l[_])/p,height:(l[_+1]-l[_+5])/m});d.#v(),d.#S(),d.rotate(d.rotation)}else if(u){d.#h=!0;const A=u[0],_={x:A[0]-v,y:m-(A[1]-b)},w=new ph(_,[0,0,p,m],1,d.#g/2,!0,.001);for(let M=0,k=A.length;M<k;M+=2)_.x=A[M]-v,_.y=m-(A[M+1]-b),w.add(_);const{id:S,clipPathId:T}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:w.toSVGPath()}},!0,!0);d.#b({highlightOutlines:w.getOutlines(),highlightId:S,clipPathId:T}),d.#S(),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=Ot._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#g,quadPoints:this.#I(),outlines:this.#k(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,a)=>s!==i[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class f0{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){le("Not implemented")}}class Nt extends Ot{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static#s=NaN;static#a=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#f())}#l({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#u(t.box)}#d(t,i){const{id:s}=i.drawLayer.draw(Nt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[a,o]of Object.entries(i))s.has(a)?Object.assign(t[a],o):t[a]=o;return t}static getDefaultDrawingOptions(t){le("Not implemented")}static get typesMap(){le("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(Nt.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,a]of this.typesMap)t.push([s,i[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,a]of this.constructor.typesMap)t.push([s,i[a]]);return t}_updateProperty(t,i,s){const a=this._drawingOptions,o=a[i],l=u=>{a.updateProperty(i,u);const h=this.#t.updateProperty(i,u);h&&this.#u(h),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,s),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#u(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#h()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#m([t,i,s,a]){const{parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(l/o),a*(o/l)];case 180:return[1-t,1-i,s,a];case 270:return[1-i,t,s*(l/o),a*(o/l)];default:return[t,i,s,a]}}#p(){const{x:t,y:i,width:s,height:a,parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(o/l),a*(l/o)];case 180:return[1-t,1-i,s,a];case 270:return[i,1-t,s*(o/l),a*(l/o)];default:return[t,i,s,a]}}#u(t){[this.x,this.y,this.width,this.height]=this.#m(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#g(){const{x:t,y:i,width:s,height:a,rotation:o,parentRotation:l,parentDimensions:[u,h]}=this;switch((o*4+l)/90){case 1:return[1-i-a,t,a,s];case 2:return[1-t-s,1-i-a,s,a];case 3:return[i,1-t-s,a,s];case 4:return[t,i-s*(u/h),a*(h/u),s*(u/h)];case 5:return[1-i,t,s*(u/h),a*(h/u)];case 6:return[1-t-a*(h/u),1-i,a*(h/u),s*(u/h)];case 7:return[i-s*(u/h),1-t-a*(h/u),s*(u/h),a*(h/u)];case 8:return[t-s,i-a,s,a];case 9:return[1-i,t-s,a,s];case 10:return[1-t,1-i,s,a];case 11:return[i-a,1-t,a,s];case 12:return[t-a*(h/u),i,a*(h/u),s*(u/h)];case 13:return[1-i-s*(u/h),t-a*(h/u),s*(u/h),a*(h/u)];case 14:return[1-t,1-i-s*(u/h),a*(h/u),s*(u/h)];case 15:return[i,1-t,s*(u/h),a*(h/u)];default:return[t,i,s,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const a=document.createElement("div");return s.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,a,o){le("Not implemented")}static startDrawing(t,i,s,a){const{target:o,offsetX:l,offsetY:u,pointerId:h,pointerType:d}=a;if(Nt.#a&&Nt.#a!==d)return;const{viewport:{rotation:p}}=t,{width:m,height:v}=o.getBoundingClientRect(),b=Nt.#i=new AbortController,A=t.combinedSignal(b);if(Nt.#s||=h,Nt.#a??=d,window.addEventListener("pointerup",_=>{Nt.#s===_.pointerId?this._endDraw(_):Nt.#o?.delete(_.pointerId)},{signal:A}),window.addEventListener("pointercancel",_=>{Nt.#s===_.pointerId?this._currentParent.endDrawingSession():Nt.#o?.delete(_.pointerId)},{signal:A}),window.addEventListener("pointerdown",_=>{Nt.#a===_.pointerType&&((Nt.#o||=new Set).add(_.pointerId),Nt.#n.isCancellable()&&(Nt.#n.removeLastElement(),Nt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Ni,{signal:A}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),o.addEventListener("touchmove",_=>{_.timeStamp===Nt.#c&&ve(_)},{signal:A}),t.toggleDrawing(),i._editorUndoBar?.hide(),Nt.#n){t.drawLayer.updateProperties(this._currentDrawId,Nt.#n.startNew(l,u,m,v,p));return}i.updateUIForDefaultProperties(this),Nt.#n=this.createDrawerInstance(l,u,m,v,p),Nt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Nt.#r.toSVGProperties(),Nt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Nt.#c=-1,!Nt.#n)return;const{offsetX:i,offsetY:s,pointerId:a}=t;if(Nt.#s===a){if(Nt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Nt.#n.add(i,s)),Nt.#c=t.timeStamp,ve(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Nt.#n=null,Nt.#r=null,Nt.#a=null,Nt.#c=NaN),Nt.#i&&(Nt.#i.abort(),Nt.#i=null,Nt.#s=NaN,Nt.#o=null)}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,Nt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=Nt.#n,a=this._currentDrawId,o=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(a,s.setLastElement(o))},undo:()=>{i.drawLayer.updateProperties(a,s.removeLastElement())},mustExec:!1,type:$t.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack($t.DRAW_STEP),!Nt.#n.isEmpty()){const{pageDimensions:[s,a],scale:o}=i,l=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Nt.#n.getOutlines(s*o,a*o,o,this._INNER_MARGIN),drawingOptions:Nt.#r,mustBeCommitted:!t});return this._cleanup(!0),l}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,a,o,l){le("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:a,pageHeight:o,pageX:l,pageY:u}}=i.viewport,h=this.deserializeDraw(l,u,a,o,this._INNER_MARGIN,t),d=await super.deserialize(t,i,s);return d.createDrawingOptions(t),d.#l({drawOutlines:h}),d.#f(),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[i,s]=this.pageTranslation,[a,o]=this.pageDimensions;return this.#t.serialize([i,s,a,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class P_{#t=new Float64Array(6);#e;#n;#i;#r;#s;#a="";#o=0;#c=new zr;#l;#d;constructor(t,i,s,a,o,l){this.#l=s,this.#d=a,this.#i=o,this.#r=l,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#s=[t,i],this.#n=[{line:u,points:this.#s}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#r=i)}#h(t,i){return wt._normalizePoint(t,i,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,a,o,l]=this.#t.subarray(2,6),u=t-o,h=i-l;return Math.hypot(this.#l*u,this.#d*h)<=2?null:(this.#s.push(t,i),isNaN(s)?(this.#t.set([o,l,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,a,o,l,t,i],0),this.#e.push(...wt.createBezierPoints(s,a,o,l,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,a,o){this.#l=s,this.#d=a,this.#i=o,[t,i]=this.#h(t,i);const l=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#s=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:l,points:this.#s}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#a="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:a}=this.#n[t];this.#e=s,this.#s=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=wt.svgRound(this.#e[4]),i=wt.svgRound(this.#e[5]);if(this.#s.length===2)return this.#a=`${this.#a} M ${t} ${i} Z`,this.#a;if(this.#s.length<=6){const a=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,a)} M ${t} ${i}`,this.#o=6}if(this.#s.length===4){const a=wt.svgRound(this.#e[10]),o=wt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${a} ${o}`,this.#o=12,this.#a}const s=[];this.#o===0&&(s.push(`M ${t} ${i}`),this.#o=6);for(let a=this.#o,o=this.#e.length;a<o;a+=6){const[l,u,h,d,p,m]=this.#e.slice(a,a+6).map(wt.svgRound);s.push(`C${l} ${u} ${h} ${d} ${p} ${m}`)}return this.#a+=s.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,i,s,a){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#n,t,i,s,this.#i,this.#r,a),this.#t=null,this.#e=null,this.#n=null,this.#a=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class zr extends wt{#t;#e=0;#n;#i;#r;#s;#a;#o;#c;build(t,i,s,a,o,l,u){this.#r=i,this.#s=s,this.#a=a,this.#o=o,this.#c=l,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${wt.svgRound(i[4])} ${wt.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${wt.svgRound(i[10])} ${wt.svgRound(i[11])}`);continue}for(let s=6,a=i.length;s<a;s+=6){const[o,l,u,h,d,p]=i.subarray(s,s+6).map(wt.svgRound);t.push(`C${o} ${l} ${u} ${h} ${d} ${p}`)}}return t.join("")}serialize([t,i,s,a],o){const l=[],u=[],[h,d,p,m]=this.#d();let v,b,A,_,w,S,T,M,k;switch(this.#o){case 0:k=wt._rescale,v=t,b=i+a,A=s,_=-a,w=t+h*s,S=i+(1-d-m)*a,T=t+(h+p)*s,M=i+(1-d)*a;break;case 90:k=wt._rescaleAndSwap,v=t,b=i,A=s,_=a,w=t+d*s,S=i+h*a,T=t+(d+m)*s,M=i+(h+p)*a;break;case 180:k=wt._rescale,v=t+s,b=i,A=-s,_=a,w=t+(1-h-p)*s,S=i+d*a,T=t+(1-h)*s,M=i+(d+m)*a;break;case 270:k=wt._rescaleAndSwap,v=t+s,b=i+a,A=-s,_=-a,w=t+(1-d-m)*s,S=i+(1-h-p)*a,T=t+(1-d)*s,M=i+(1-h)*a;break}for(const{line:O,points:z}of this.#i)l.push(k(O,v,b,A,_,o?new Array(O.length):null)),u.push(k(z,v,b,A,_,o?new Array(z.length):null));return{lines:l,points:u,rect:[w,S,T,M]}}static deserialize(t,i,s,a,o,{paths:{lines:l,points:u},rotation:h,thickness:d}){const p=[];let m,v,b,A,_;switch(h){case 0:_=wt._rescale,m=-t/s,v=i/a+1,b=1/s,A=-1/a;break;case 90:_=wt._rescaleAndSwap,m=-i/a,v=-t/s,b=1/a,A=1/s;break;case 180:_=wt._rescale,m=t/s+1,v=-i/a,b=-1/s,A=1/a;break;case 270:_=wt._rescaleAndSwap,m=i/a+1,v=t/s+1,b=-1/a,A=-1/s;break}if(!l){l=[];for(const S of u){const T=S.length;if(T===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1]]));continue}if(T===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1],NaN,NaN,NaN,NaN,S[2],S[3]]));continue}const M=new Float32Array(3*(T-2));l.push(M);let[k,O,z,L]=S.subarray(0,4);M.set([NaN,NaN,NaN,NaN,k,O],0);for(let G=4;G<T;G+=2){const j=S[G],Z=S[G+1];M.set(wt.createBezierPoints(k,O,z,L,j,Z),(G-2)*3),[k,O,z,L]=[z,L,j,Z]}}}for(let S=0,T=l.length;S<T;S++)p.push({line:_(l[S].map(M=>M??NaN),m,v,b,A),points:_(u[S].map(M=>M??NaN),m,v,b,A)});const w=new this.prototype.constructor;return w.build(p,s,a,1,h,d,o),w}#l(t=this.#c){const i=this.#n+t/2*this.#a;return this.#o%180===0?[i/this.#r,i/this.#s]:[i/this.#s,i/this.#r]}#d(){const[t,i,s,a]=this.#t,[o,l]=this.#l(0);return[t+o,i+l,s-2*o,a-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#i){if(a.length<=12){for(let u=4,h=a.length;u<h;u+=6)Ct.pointBoundingBox(a[u],a[u+1],t);continue}let o=a[4],l=a[5];for(let u=6,h=a.length;u<h;u+=6){const[d,p,m,v,b,A]=a.subarray(u,u+6);Ct.bezierBoundingBox(o,l,d,p,m,v,b,A,t),o=b,l=A}}const[i,s]=this.#l();t[0]=Ke(t[0]-i,0,1),t[1]=Ke(t[1]-s,0,1),t[2]=Ke(t[2]+i,0,1),t[3]=Ke(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#l();this.#c=t;const[a,o]=this.#l(),[l,u]=[a-i,o-s],h=this.#t;return h[0]-=l,h[1]-=u,h[2]+=2*l,h[3]+=2*u,h}updateParentDimensions([t,i],s){const[a,o]=this.#l();this.#r=t,this.#s=i,this.#a=s;const[l,u]=this.#l(),h=l-a,d=u-o,p=this.#t;return p[0]-=h,p[1]-=d,p[2]+=2*h,p[3]+=2*d,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(wt.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,a=0,o=0,l=0,u=0,h=0;switch(this.#e){case 90:a=i/t,o=-t/i,u=t;break;case 180:s=-1,l=-1,u=t,h=i;break;case 270:a=-i/t,o=t/i,h=i;break;default:return""}return`matrix(${s} ${a} ${o} ${l} ${wt.svgRound(u)} ${wt.svgRound(h)})`}getPathResizingSVGProperties([t,i,s,a]){const[o,l]=this.#l(),[u,h,d,p]=this.#t;if(Math.abs(d-o)<=wt.PRECISION||Math.abs(p-l)<=wt.PRECISION){const _=t+s/2-(u+d/2),w=i+a/2-(h+p/2);return{path:{"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(i)}`,transform:`${this.rotationTransform} translate(${_} ${w})`}}}const m=(s-2*o)/(d-2*o),v=(a-2*l)/(p-2*l),b=d/s,A=p/a;return{path:{"transform-origin":`${wt.svgRound(u)} ${wt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${b} ${A}) translate(${wt.svgRound(o)} ${wt.svgRound(l)}) scale(${m} ${v}) translate(${wt.svgRound(-o)} ${wt.svgRound(-l)})`}}}getPathResizedSVGProperties([t,i,s,a]){const[o,l]=this.#l(),u=this.#t,[h,d,p,m]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=a,Math.abs(p-o)<=wt.PRECISION||Math.abs(m-l)<=wt.PRECISION){const w=t+s/2-(h+p/2),S=i+a/2-(d+m/2);for(const{line:T,points:M}of this.#i)wt._translate(T,w,S,T),wt._translate(M,w,S,M);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(s-2*o)/(p-2*o),b=(a-2*l)/(m-2*l),A=-v*(h+o)+t+o,_=-b*(d+l)+i+l;if(v!==1||b!==1||A!==0||_!==0)for(const{line:w,points:S}of this.#i)wt._rescale(w,A,_,v,b,w),wt._rescale(S,A,_,v,b,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[a,o]=s,l=this.#t,u=t-l[0],h=i-l[1];if(this.#r===a&&this.#s===o)for(const{line:d,points:p}of this.#i)wt._translate(d,u,h,d),wt._translate(p,u,h,p);else{const d=this.#r/a,p=this.#s/o;this.#r=a,this.#s=o;for(const{line:m,points:v}of this.#i)wt._rescale(m,u,h,d,p,m),wt._rescale(v,u,h,d,p,v);l[2]*=d,l[3]*=p}return l[0]=t,l[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${wt.svgRound(t)} ${wt.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${wt.svgRound(t[0])} ${wt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Tl extends f0{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Ot._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new Tl(this._viewParameters);return t.updateAll(this),t}}class Dh extends Nt{static _type="ink";static _editorType=It.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){Ot.initialize(t,i),this._defaultDrawingOptions=new Tl(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ht(this,"typesMap",new Map([[$t.INK_THICKNESS,"stroke-width"],[$t.INK_COLOR,"stroke"],[$t.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,a,o){return new P_(t,i,s,a,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,a,o,l){return zr.deserialize(t,i,s,a,o,l)}static async deserialize(t,i,s){let a=null;if(t instanceof Mh){const{data:{inkLists:l,rect:u,rotation:h,id:d,color:p,opacity:m,borderStyle:{rawWidth:v},popupRef:b,richText:A,contentsObj:_,creationDate:w,modificationDate:S},parent:{page:{pageNumber:T}}}=t;a=t={annotationType:It.INK,color:Array.from(p),thickness:v,opacity:m,paths:{points:l},boxes:null,pageIndex:T-1,rect:u.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:b,richText:A,comment:_?.str||null,creationDate:w,modificationDate:S}}const o=await super.deserialize(t,i,s);return o._initialData=a,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||=new xr(this),[["colorPicker",this._colorPicker]]}get colorType(){return $t.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=Dh.getDefaultDrawingOptions({stroke:Ct.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,u=Object.assign(super.serialize(t),{color:Ot._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==i[u])||t.thickness!==s||t.opacity!==a||t.pageIndex!==o}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class gh extends zr{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const cl=8,yr=3;class da{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,a){return s-=t,a-=i,s===0?a>0?0:4:s===1?a+6:2-a}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,a,o,l,u){const h=this.#e(s,a,o,l);for(let d=0;d<8;d++){const p=(-d+h-u+16)%8,m=this.#n[2*p],v=this.#n[2*p+1];if(t[(s+m)*i+(a+v)]!==0)return p}return-1}static#r(t,i,s,a,o,l,u){const h=this.#e(s,a,o,l);for(let d=0;d<8;d++){const p=(d+h+u+16)%8,m=this.#n[2*p],v=this.#n[2*p+1];if(t[(s+m)*i+(a+v)]!==0)return p}return-1}static#s(t,i,s,a){const o=t.length,l=new Int32Array(o);for(let p=0;p<o;p++)l[p]=t[p]<=a?1:0;for(let p=1;p<s-1;p++)l[p*i]=l[p*i+i-1]=0;for(let p=0;p<i;p++)l[p]=l[i*s-1-p]=0;let u=1,h;const d=[];for(let p=1;p<s-1;p++){h=1;for(let m=1;m<i-1;m++){const v=p*i+m,b=l[v];if(b===0)continue;let A=p,_=m;if(b===1&&l[v-1]===0)u+=1,_-=1;else if(b>=1&&l[v+1]===0)u+=1,_+=1,b>1&&(h=b);else{b!==1&&(h=Math.abs(b));continue}const w=[m,p],S=_===m+1,T={isHole:S,points:w,id:u,parent:0};d.push(T);let M;for(const ot of d)if(ot.id===h){M=ot;break}M?M.isHole?T.parent=S?M.parent:h:T.parent=S?h:M.parent:T.parent=S?h:0;const k=this.#i(l,i,p,m,A,_,0);if(k===-1){l[v]=-u,l[v]!==1&&(h=Math.abs(l[v]));continue}let O=this.#n[2*k],z=this.#n[2*k+1];const L=p+O,G=m+z;A=L,_=G;let j=p,Z=m;for(;;){const ot=this.#r(l,i,j,Z,A,_,1);O=this.#n[2*ot],z=this.#n[2*ot+1];const I=j+O,X=Z+z;w.push(X,I);const x=j*i+Z;if(l[x+1]===0?l[x]=-u:l[x]===1&&(l[x]=u),I===p&&X===m&&j===L&&Z===G){l[v]!==1&&(h=Math.abs(l[v]));break}else A=j,_=Z,j=I,Z=X}}}return d}static#a(t,i,s,a){if(s-i<=4){for(let L=i;L<s-2;L+=2)a.push(t[L],t[L+1]);return}const o=t[i],l=t[i+1],u=t[s-4]-o,h=t[s-3]-l,d=Math.hypot(u,h),p=u/d,m=h/d,v=p*l-m*o,b=h/u,A=1/d,_=Math.atan(b),w=Math.cos(_),S=Math.sin(_),T=A*(Math.abs(w)+Math.abs(S)),M=A*(1-T+T**2),k=Math.max(Math.atan(Math.abs(S+w)*M),Math.atan(Math.abs(S-w)*M));let O=0,z=i;for(let L=i+2;L<s-2;L+=2){const G=Math.abs(v-p*t[L+1]+m*t[L]);G>O&&(z=L,O=G)}O>(d*k)**2?(this.#a(t,i,z+2,a),this.#a(t,z,s,a)):a.push(o,l)}static#o(t){const i=[],s=t.length;return this.#a(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,a,o,l){const u=new Float32Array(l**2),h=-2*a**2,d=l>>1;for(let _=0;_<l;_++){const w=(_-d)**2;for(let S=0;S<l;S++)u[_*l+S]=Math.exp((w+(S-d)**2)/h)}const p=new Float32Array(256),m=-2*o**2;for(let _=0;_<256;_++)p[_]=Math.exp(_**2/m);const v=t.length,b=new Uint8Array(v),A=new Uint32Array(256);for(let _=0;_<s;_++)for(let w=0;w<i;w++){const S=_*i+w,T=t[S];let M=0,k=0;for(let z=0;z<l;z++){const L=_+z-d;if(!(L<0||L>=s))for(let G=0;G<l;G++){const j=w+G-d;if(j<0||j>=i)continue;const Z=t[L*i+j],ot=u[z*l+G]*p[Math.abs(Z-T)];M+=Z*ot,k+=ot}}const O=b[S]=Math.round(M/k);A[O]++}return[b,A]}static#l(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let a=-1/0,o=1/0;for(let u=0,h=s.length;u<h;u++){const d=s[u]=t[u<<2];a=Math.max(a,d),o=Math.min(o,d)}const l=255/(a-o);for(let u=0,h=s.length;u<h;u++)s[u]=(s[u]-o)*l;return s}static#h(t){let i,s=-1/0,a=-1/0;const o=t.findIndex(h=>h!==0);let l=o,u=o;for(i=o;i<256;i++){const h=t[i];h>s&&(i-l>a&&(a=i-l,u=i-1),s=h,l=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:a}=t,{maxDim:o}=this.#t;let l=s,u=a;if(s>o||a>o){let v=s,b=a,A=Math.log2(Math.max(s,a)/o);const _=Math.floor(A);A=A===_?_-1:_;for(let S=0;S<A;S++){l=Math.ceil(v/2),u=Math.ceil(b/2);const T=new OffscreenCanvas(l,u);T.getContext("2d").drawImage(t,0,0,v,b,0,0,l,u),v=l,b=u,t!==i&&t.close(),t=T.transferToImageBitmap()}const w=Math.min(o/l,o/u);l=Math.round(l*w),u=Math.round(u*w)}const d=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,l,u),d.filter="grayscale(1)",d.drawImage(t,0,0,t.width,t.height,0,0,l,u);const p=d.getImageData(0,0,l,u).data;return[this.#d(p),l,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:a},o,l,u,h){let d=new OffscreenCanvas(1,1),p=d.getContext("2d",{alpha:!1});const m=200,v=p.font=`${s} ${a} ${m}px ${i}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:A,actualBoundingBoxAscent:_,actualBoundingBoxDescent:w,fontBoundingBoxAscent:S,fontBoundingBoxDescent:T,width:M}=p.measureText(t),k=1.5,O=Math.ceil(Math.max(Math.abs(b)+Math.abs(A)||0,M)*k),z=Math.ceil(Math.max(Math.abs(_)+Math.abs(w)||m,Math.abs(S)+Math.abs(T)||m)*k);d=new OffscreenCanvas(O,z),p=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,O,z),p.fillStyle="black",p.fillText(t,O*(k-1)/2,z*(3-k)/2);const L=this.#d(p.getImageData(0,0,O,z).data),G=this.#l(L),j=this.#h(G),Z=this.#s(L,O,z,j);return this.processDrawnLines({lines:{curves:Z,width:O,height:z},pageWidth:o,pageHeight:l,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,i,s,a,o){const[l,u,h]=this.#f(t),[d,p]=this.#c(l,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),m=this.#h(p),v=this.#s(d,u,h,m);return this.processDrawnLines({lines:{curves:v,width:u,height:h},pageWidth:i,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:l,areContours:u}){a%180!==0&&([i,s]=[s,i]);const{curves:h,width:d,height:p}=t,m=t.thickness??0,v=[],b=Math.min(i/d,s/p),A=b/i,_=b/s,w=[];for(const{points:T}of h){const M=l?this.#o(T):T;if(!M)continue;w.push(M);const k=M.length,O=new Float32Array(k),z=new Float32Array(3*(k===2?2:k-2));if(v.push({line:z,points:O}),k===2){O[0]=M[0]*A,O[1]=M[1]*_,z.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[L,G,j,Z]=M;L*=A,G*=_,j*=A,Z*=_,O.set([L,G,j,Z],0),z.set([NaN,NaN,NaN,NaN,L,G],0);for(let ot=4;ot<k;ot+=2){const I=O[ot]=M[ot]*A,X=O[ot+1]=M[ot+1]*_;z.set(wt.createBezierPoints(L,G,j,Z,I,X),(ot-2)*3),[L,G,j,Z]=[j,Z,I,X]}}if(v.length===0)return null;const S=u?new gh:new zr;return S.build(v,i,s,1,a,u?0:m,o),{outline:S,newCurves:w,areContours:u,thickness:m,width:d,height:p}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:a,height:o}){let l=1/0,u=-1/0,h=0;for(const M of t){h+=M.length;for(let k=2,O=M.length;k<O;k++){const z=M[k]-M[k-2];l=Math.min(l,z),u=Math.max(u,z)}}let d;l>=-128&&u<=127?d=Int8Array:l>=-32768&&u<=32767?d=Int16Array:d=Int32Array;const p=t.length,m=cl+yr*p,v=new Uint32Array(m);let b=0;v[b++]=m*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*d.BYTES_PER_ELEMENT,v[b++]=0,v[b++]=a,v[b++]=o,v[b++]=i?0:1,v[b++]=Math.max(0,Math.floor(s??0)),v[b++]=p,v[b++]=d.BYTES_PER_ELEMENT;for(const M of t)v[b++]=M.length-2,v[b++]=M[0],v[b++]=M[1];const A=new CompressionStream("deflate-raw"),_=A.writable.getWriter();await _.ready,_.write(v);const w=d.prototype.constructor;for(const M of t){const k=new w(M.length-2);for(let O=2,z=M.length;O<z;O++)k[O-2]=M[O]-M[O-2];_.write(k)}_.close();const S=await new Response(A.readable).arrayBuffer(),T=new Uint8Array(S);return Pm(T)}static async decompressSignature(t){try{const i=ev(t),{readable:s,writable:a}=new DecompressionStream("deflate-raw"),o=a.getWriter();await o.ready,o.write(i).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,u=0;for await(const M of s)l||=new Uint8Array(new Uint32Array(M.buffer,0,4)[0]),l.set(M,u),u+=M.length;const h=new Uint32Array(l.buffer,0,l.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const p=h[2],m=h[3],v=h[4]===0,b=h[5],A=h[6],_=h[7],w=[],S=(cl+yr*A)*Uint32Array.BYTES_PER_ELEMENT;let T;switch(_){case Int8Array.BYTES_PER_ELEMENT:T=new Int8Array(l.buffer,S);break;case Int16Array.BYTES_PER_ELEMENT:T=new Int16Array(l.buffer,S);break;case Int32Array.BYTES_PER_ELEMENT:T=new Int32Array(l.buffer,S);break}u=0;for(let M=0;M<A;M++){const k=h[yr*M+cl],O=new Float32Array(k+2);w.push(O);for(let z=0;z<yr-1;z++)O[z]=h[yr*M+cl+z+1];for(let z=0;z<k;z++)O[z+2]=O[z]+T[u++]}return{areContours:v,thickness:b,outlines:w,width:p,height:m}}catch(i){return zt(`decompressSignature: ${i}`),null}}}class Oh extends f0{constructor(){super(),super.updateProperties({fill:Ot._defaultLineColor,"stroke-width":0})}clone(){const t=new Oh;return t.updateAll(this),t}}class kh extends Tl{constructor(t){super(t),super.updateProperties({stroke:Ot._defaultLineColor,"stroke-width":1})}clone(){const t=new kh(this._viewParameters);return t.updateAll(this),t}}class Xi extends Nt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=It.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){Ot.initialize(t,i),this._defaultDrawingOptions=new Oh,this._defaultDrawnSignatureOptions=new kh(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ht(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:a,mustSmooth:o,areContours:l,description:u,uuid:h,heightInPage:d}=this.#n,{rawDims:{pageWidth:p,pageHeight:m},rotation:v}=this.parent.viewport,b=da.processDrawnLines({lines:a,pageWidth:p,pageHeight:m,rotation:v,innerMargin:Xi._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(b,d,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:a,height:o}=this.#n,l=Math.max(a,o),u=da.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:s,width:a,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,a){const{x:o,y:l}=this,{outline:u}=this.#n=t;this.#t=u instanceof gh,this.description=s;let h;this.#t?h=Xi.getDefaultDrawingOptions():(h=Xi._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,d]=this.pageDimensions;let p=i/d;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return da.process(t,i,s,a,Xi._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:a},rotation:o}=this.parent.viewport;return da.extractContoursFromText(t,i,s,a,o,Xi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return da.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:a,innerMargin:Xi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=Xi.getDefaultDrawingOptions():(this._drawingOptions=Xi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(o),t?(o.paths={lines:i,points:s},o.uuid=this.#i,o.isCopy=!0):o.lines=i,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,i,s,a,o,l){return l.areContours?gh.deserialize(t,i,s,a,o,l):zr.deserialize(t,i,s,a,o,l)}static async deserialize(t,i,s){const a=await super.deserialize(t,i,s);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#i=t.uuid,a}}class U_ extends Ot{#t=null;#e=null;#n=null;#i=null;#r=null;#s="";#a=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=It.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){Ot.initialize(t,i)}static isHandlingMimeForPasting(t){return rh.includes(t)}static paste(t,i){i.pasteEditor({mode:It.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#s=t.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:a,width:o,height:l,channels:a.length/(o*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=rh.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,a&&(this.#t=a),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},t)}#p(){const{div:t}=this;let{width:i,height:s}=this.#t;const[a,o]=this.pageDimensions,l=.75;if(this.width)i=this.width*a,s=this.height*o;else if(i>l*a||s>l*o){const h=Math.min(l*a/i,l*o/s);i*=h,s*=h}this._uiManager.enableWaiting(!1);const u=this.#a=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/a,this.height=s/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:a,height:o}=this.#t,l=new Ki;let u=this.#t,h=a,d=o,p=null;if(i){if(a>i||o>i){const z=Math.min(i/a,i/o);h=Math.floor(a*z),d=Math.floor(o*z)}p=document.createElement("canvas");const v=p.width=Math.ceil(h*l.sx),b=p.height=Math.ceil(d*l.sy);this.#l||(u=this.#u(v,b));const A=p.getContext("2d");A.filter=this._uiManager.hcmFilter;let _="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":ov.isDarkMode&&(_="#8f8f9d",w="#42414d");const S=15,T=S*l.sx,M=S*l.sy,k=new OffscreenCanvas(T*2,M*2),O=k.getContext("2d");O.fillStyle=_,O.fillRect(0,0,T*2,M*2),O.fillStyle=w,O.fillRect(0,0,T,M),O.fillRect(T,M,T,M),A.fillStyle=A.createPattern(k,"repeat"),A.fillRect(0,0,v,b),A.drawImage(u,0,0,u.width,u.height,0,0,v,b)}let m=null;if(s){let v,b;if(l.symmetric&&u.width<t&&u.height<t)v=u.width,b=u.height;else if(u=this.#t,a>t||o>t){const w=Math.min(t/a,t/o);v=Math.floor(a*w),b=Math.floor(o*w),this.#l||(u=this.#u(v,b))}const _=new OffscreenCanvas(v,b).getContext("2d",{willReadFrequently:!0});_.drawImage(u,0,0,u.width,u.height,0,0,v,b),m={width:v,height:b,data:_.getImageData(0,0,v,b).data}}return{canvas:p,width:h,height:d,imageData:m}}#u(t,i){const{width:s,height:a}=this.#t;let o=s,l=a,u=this.#t;for(;o>2*t||l>2*i;){const h=o,d=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*i&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(o,l);p.getContext("2d").drawImage(u,0,0,h,d,0,0,o,l),u=p.transferToImageBitmap()}return u}#g(){const[t,i]=this.parentDimensions,{width:s,height:a}=this,o=new Ki,l=Math.ceil(s*t*o.sx),u=Math.ceil(a*i*o.sy),h=this.#a;if(!h||h.width===l&&h.height===u)return;h.width=l,h.height=u;const d=this.#l?this.#t:this.#u(l,u),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(d,0,0,d.width,d.height,0,0,l,u)}#y(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#l){const[i,s]=this.pageDimensions,a=Math.round(this.width*i*_a.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*_a.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(a,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let a=null,o=!1;if(t instanceof h0){const{data:{rect:_,rotation:w,id:S,structParent:T,popupRef:M,richText:k,contentsObj:O,creationDate:z,modificationDate:L},container:G,parent:{page:{pageNumber:j}},canvas:Z}=t;let ot,I;Z?(delete t.canvas,{id:ot,bitmap:I}=s.imageManager.getFromCanvas(G.id,Z),Z.remove()):(o=!0,t._hasNoCanvas=!0);const X=(await i._structTree.getAriaAttributes(`${yh}${S}`))?.get("aria-label")||"";a=t={annotationType:It.STAMP,bitmapId:ot,bitmap:I,pageIndex:j-1,rect:_.slice(0),rotation:w,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:X},isSvg:!1,structParent:T,popupRef:M,richText:k,comment:O?.str||null,creationDate:z,modificationDate:L}}const l=await super.deserialize(t,i,s),{rect:u,bitmap:h,bitmapUrl:d,bitmapId:p,isSvg:m,accessibilityData:v}=t;o?(s.addMissingCanvas(t.id,l),l.#o=!0):p&&s.imageManager.isValidId(p)?(l.#e=p,h&&(l.#t=h)):l.#i=d,l.#l=m;const[b,A]=l.pageDimensions;return l.width=(u[2]-u[0])/b,l.height=(u[3]-u[1])/A,v&&(l.altTextData=v),l._initialData=a,t.comment&&l.setCommentData(t),l.#d=!!a,l}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:a,altText:o}=this.serializeAltText(!1);if(!a&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const l=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:l,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const u=i.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,a=t.pageIndex===i,o=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&o,isSameAltText:o}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class mn{#t;#e=!1;#n=null;#i=null;#r=null;#s=new Map;#a=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#p=-1;#u;static _initialized=!1;static#g=new Map([Le,Dh,U_,Se,Xi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:a,accessibilityManager:o,annotationLayer:l,drawLayer:u,textLayer:h,viewport:d,l10n:p}){const m=[...mn.#g.values()];if(!mn._initialized){mn._initialized=!0;for(const v of m)v.initialize(p,t)}t.registerEditorTypes(m),this.#u=t,this.pageIndex=i,this.div=s,this.#t=o,this.#n=l,this.viewport=d,this.#h=h,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===It.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#_(),t){case It.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case It.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case It.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===It.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of mn.#g.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}get#y(){return this.#s.size!==0?this.#s.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const a=await this.deserialize(s);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const s=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:u,timeStamp:h}=a,d=this.#p;if(h-d>500){this.#p=h;return}this.#p=-1;const{classList:p}=this.div;p.toggle("getElements",!0);const m=document.elementsFromPoint(l,u);if(p.toggle("getElements",!1),!this.div.contains(m[0]))return;let v;const b=new RegExp(`^${wr}[0-9]+$`);for(const _ of m)if(b.test(_.id)){v=_.id;break}if(!v)return;const A=this.#s.get(v);A?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),A.dblclick(a))},{signal:s,capture:!0})}const t=this.#n;if(t){const s=new Map,a=new Map;for(const l of this.#y){if(l.disableEditing(),!l.annotationElementId){l.updateFakeAnnotationElement(t);continue}if(l.serialize()!==null){s.set(l.annotationElementId,l);continue}else a.set(l.annotationElementId,l);this.getEditableAnnotation(l.annotationElementId)?.show(),l.remove()}const o=t.getEditableAnnotations();for(const l of o){const{id:u}=l.data;if(this.#u.isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let h=a.get(u);if(h){h.resetAnnotationElement(l),h.show(!1),l.show();continue}h=s.get(u),h&&(this.#u.addChangedExistingAnnotation(h),h.renderAnnotationElement(l)&&h.show(!1)),l.show()}}this.#_(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of mn.#g.values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=Ge.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),Se.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t.annotationElementId),Ot.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#s.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#b(){return mn.#g.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#C(t){const i=this.#b;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:a}=this.#w(),o=this.getNextId(),l=this.#C({parent:this,id:o,x:s,y:a,uiManager:this.#u,isCentered:!0,...i});l&&this.add(l)}async deserialize(t){return await mn.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const a=this.getNextId(),o=this.#C({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:t,y:i,width:s,height:a}=this.boundingClientRect,o=Math.max(0,t),l=Math.max(0,i),u=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,i+a),d=(o+u)/2-t,p=(l+h)/2-i,[m,v]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:m,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#w(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=Ge.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#a||(this.#a=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===It.STAMP||s===It.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===It.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:i}=Ge.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#a=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const i=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,i,s){const a=this.#u.findParent(i,s);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#u.removeLayer(this)}#_(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,bs(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#_();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,bs(this.div,{rotation:s}),i!==s)for(const a of this.#s.values())a.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class He{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return Ht(this,"_svgFactory",new bl)}static#r(t,[i,s,a,o]){const{style:l}=t;l.top=`${100*s}%`,l.left=`${100*i}%`,l.width=`${100*a}%`,l.height=`${100*o}%`}#s(){const t=He._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,i){const s=He._svgFactory.createElement("clipPath");t.append(s);const a=`clip_${i}`;s.setAttribute("id",a),s.setAttribute("clipPathUnits","objectBoundingBox");const o=He._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${i}`),o.classList.add("clip"),a}#o(t,i){for(const[s,a]of Object.entries(i))a===null?t.removeAttribute(s):t.setAttribute(s,a)}draw(t,i=!1,s=!1){const a=He.#i++,o=this.#s(),l=He._svgFactory.createElement("defs");o.append(l);const u=He._svgFactory.createElement("path");l.append(u);const h=`path_p${this.pageIndex}_${a}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(a,u);const d=s?this.#a(l,h):null,p=He._svgFactory.createElement("use");return o.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(o,t),this.#e.set(a,o),{id:a,clipPathId:`url(#${d})`}}drawOutline(t,i){const s=He.#i++,a=this.#s(),o=He._svgFactory.createElement("defs");a.append(o);const l=He._svgFactory.createElement("path");o.append(l);const u=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(i){const m=He._svgFactory.createElement("mask");o.append(m),h=`mask_p${this.pageIndex}_${s}`,m.setAttribute("id",h),m.setAttribute("maskUnits","objectBoundingBox");const v=He._svgFactory.createElement("rect");m.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const b=He._svgFactory.createElement("use");m.append(b),b.setAttribute("href",`#${u}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const d=He._svgFactory.createElement("use");a.append(d),d.setAttribute("href",`#${u}`),h&&d.setAttribute("mask",`url(#${h})`);const p=d.cloneNode();return a.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(s,a),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:a,rootClass:o,path:l}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),a&&He.#r(u,a),o){const{classList:h}=u;for(const[d,p]of Object.entries(o))h.toggle(d,p)}if(l){const d=u.firstChild.firstChild;this.#o(d,l)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:fh};globalThis.pdfjsLib={AbortException:Xn,AnnotationEditorLayer:mn,AnnotationEditorParamsType:$t,AnnotationEditorType:It,AnnotationEditorUIManager:$n,AnnotationLayer:Rh,AnnotationMode:qn,AnnotationType:Me,applyOpacity:cv,build:m_,ColorPicker:ki,createValidAbsoluteUrl:Bm,CSSConstants:lv,DOMSVGFactory:bl,DrawLayer:He,FeatureTest:Ge,fetchData:Or,findContrastColor:uv,getDocument:n0,getFilenameFromUrl:iv,getPdfFilenameFromUrl:nv,getRGB:Nr,getUuid:Fm,getXfaPageViewport:av,GlobalWorkerOptions:ba,ImageKind:dl,InvalidPDFException:sh,isDataScheme:wl,isPdfFile:vh,isValidExplicitDest:_v,MathClamp:Ke,noContextMenu:Ni,normalizeUnicode:Jb,OPS:Er,OutputScale:Ki,PasswordResponses:qb,PDFDataRangeTransport:s0,PDFDateString:ah,PDFWorker:Tr,PermissionFlag:Gb,PixelsPerInch:_a,RenderingCancelledException:bh,renderRichText:Hm,ResponseException:ml,setLayerDimensions:bs,shadow:Ht,SignatureExtractor:da,stopEvent:ve,SupportedImageMimeTypes:rh,TextLayer:Xe,TouchManager:El,updateUrlHash:zm,Util:Ct,VerbosityLevel:_l,version:g_,XfaLayer:Um};var mm;(function(g){g.STRING="string",g.NUMBER="number",g.INTEGER="integer",g.BOOLEAN="boolean",g.ARRAY="array",g.OBJECT="object"})(mm||(mm={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ym;(function(g){g.LANGUAGE_UNSPECIFIED="language_unspecified",g.PYTHON="python"})(ym||(ym={}));var bm;(function(g){g.OUTCOME_UNSPECIFIED="outcome_unspecified",g.OUTCOME_OK="outcome_ok",g.OUTCOME_FAILED="outcome_failed",g.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(bm||(bm={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm=["user","model","function","system"];var _m;(function(g){g.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",g.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",g.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",g.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",g.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",g.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(_m||(_m={}));var Am;(function(g){g.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",g.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",g.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",g.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",g.BLOCK_NONE="BLOCK_NONE"})(Am||(Am={}));var Sm;(function(g){g.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",g.NEGLIGIBLE="NEGLIGIBLE",g.LOW="LOW",g.MEDIUM="MEDIUM",g.HIGH="HIGH"})(Sm||(Sm={}));var wm;(function(g){g.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",g.SAFETY="SAFETY",g.OTHER="OTHER"})(wm||(wm={}));var Sr;(function(g){g.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",g.STOP="STOP",g.MAX_TOKENS="MAX_TOKENS",g.SAFETY="SAFETY",g.RECITATION="RECITATION",g.LANGUAGE="LANGUAGE",g.BLOCKLIST="BLOCKLIST",g.PROHIBITED_CONTENT="PROHIBITED_CONTENT",g.SPII="SPII",g.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",g.OTHER="OTHER"})(Sr||(Sr={}));var Em;(function(g){g.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",g.RETRIEVAL_QUERY="RETRIEVAL_QUERY",g.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",g.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",g.CLASSIFICATION="CLASSIFICATION",g.CLUSTERING="CLUSTERING"})(Em||(Em={}));var Cm;(function(g){g.MODE_UNSPECIFIED="MODE_UNSPECIFIED",g.AUTO="AUTO",g.ANY="ANY",g.NONE="NONE"})(Cm||(Cm={}));var Tm;(function(g){g.MODE_UNSPECIFIED="MODE_UNSPECIFIED",g.MODE_DYNAMIC="MODE_DYNAMIC"})(Tm||(Tm={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class ca extends Ve{constructor(t,i){super(t),this.response=i}}class p0 extends Ve{constructor(t,i,s,a){super(t),this.status=i,this.statusText=s,this.errorDetails=a}}class Yn extends Ve{}class g0 extends Ve{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H_="https://generativelanguage.googleapis.com",j_="v1beta",G_="0.24.1",q_="genai-js";var _s;(function(g){g.GENERATE_CONTENT="generateContent",g.STREAM_GENERATE_CONTENT="streamGenerateContent",g.COUNT_TOKENS="countTokens",g.EMBED_CONTENT="embedContent",g.BATCH_EMBED_CONTENTS="batchEmbedContents"})(_s||(_s={}));class V_{constructor(t,i,s,a,o){this.model=t,this.task=i,this.apiKey=s,this.stream=a,this.requestOptions=o}toString(){var t,i;const s=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||j_;let o=`${((i=this.requestOptions)===null||i===void 0?void 0:i.baseUrl)||H_}/${s}/${this.model}:${this.task}`;return this.stream&&(o+="?alt=sse"),o}}function Y_(g){const t=[];return g?.apiClient&&t.push(g.apiClient),t.push(`${q_}/${G_}`),t.join(" ")}async function X_(g){var t;const i=new Headers;i.append("Content-Type","application/json"),i.append("x-goog-api-client",Y_(g.requestOptions)),i.append("x-goog-api-key",g.apiKey);let s=(t=g.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(s){if(!(s instanceof Headers))try{s=new Headers(s)}catch(a){throw new Yn(`unable to convert customHeaders value ${JSON.stringify(s)} to Headers: ${a.message}`)}for(const[a,o]of s.entries()){if(a==="x-goog-api-key")throw new Yn(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new Yn(`Header name ${a} can only be set using the apiClient field`);i.append(a,o)}}return i}async function $_(g,t,i,s,a,o){const l=new V_(g,t,i,s,o);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},Q_(o)),{method:"POST",headers:await X_(l),body:a})}}async function Ir(g,t,i,s,a,o={},l=fetch){const{url:u,fetchOptions:h}=await $_(g,t,i,s,a,o);return K_(u,h,l)}async function K_(g,t,i=fetch){let s;try{s=await i(g,t)}catch(a){Z_(a,g)}return s.ok||await W_(s,g),s}function Z_(g,t){let i=g;throw i.name==="AbortError"?(i=new g0(`Request aborted when fetching ${t.toString()}: ${g.message}`),i.stack=g.stack):g instanceof p0||g instanceof Yn||(i=new Ve(`Error fetching from ${t.toString()}: ${g.message}`),i.stack=g.stack),i}async function W_(g,t){let i="",s;try{const a=await g.json();i=a.error.message,a.error.details&&(i+=` ${JSON.stringify(a.error.details)}`,s=a.error.details)}catch{}throw new p0(`Error fetching from ${t.toString()}: [${g.status} ${g.statusText}] ${i}`,g.status,g.statusText,s)}function Q_(g){const t={};if(g?.signal!==void 0||g?.timeout>=0){const i=new AbortController;g?.timeout>=0&&setTimeout(()=>i.abort(),g.timeout),g?.signal&&g.signal.addEventListener("abort",()=>{i.abort()}),t.signal=i.signal}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(g){return g.text=()=>{if(g.candidates&&g.candidates.length>0){if(g.candidates.length>1&&console.warn(`This response had ${g.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),gl(g.candidates[0]))throw new ca(`${Gn(g)}`,g);return J_(g)}else if(g.promptFeedback)throw new ca(`Text not available. ${Gn(g)}`,g);return""},g.functionCall=()=>{if(g.candidates&&g.candidates.length>0){if(g.candidates.length>1&&console.warn(`This response had ${g.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),gl(g.candidates[0]))throw new ca(`${Gn(g)}`,g);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),xm(g)[0]}else if(g.promptFeedback)throw new ca(`Function call not available. ${Gn(g)}`,g)},g.functionCalls=()=>{if(g.candidates&&g.candidates.length>0){if(g.candidates.length>1&&console.warn(`This response had ${g.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),gl(g.candidates[0]))throw new ca(`${Gn(g)}`,g);return xm(g)}else if(g.promptFeedback)throw new ca(`Function call not available. ${Gn(g)}`,g)},g}function J_(g){var t,i,s,a;const o=[];if(!((i=(t=g.candidates)===null||t===void 0?void 0:t[0].content)===null||i===void 0)&&i.parts)for(const l of(a=(s=g.candidates)===null||s===void 0?void 0:s[0].content)===null||a===void 0?void 0:a.parts)l.text&&o.push(l.text),l.executableCode&&o.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&o.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return o.length>0?o.join(""):""}function xm(g){var t,i,s,a;const o=[];if(!((i=(t=g.candidates)===null||t===void 0?void 0:t[0].content)===null||i===void 0)&&i.parts)for(const l of(a=(s=g.candidates)===null||s===void 0?void 0:s[0].content)===null||a===void 0?void 0:a.parts)l.functionCall&&o.push(l.functionCall);if(o.length>0)return o}const t1=[Sr.RECITATION,Sr.SAFETY,Sr.LANGUAGE];function gl(g){return!!g.finishReason&&t1.includes(g.finishReason)}function Gn(g){var t,i,s;let a="";if((!g.candidates||g.candidates.length===0)&&g.promptFeedback)a+="Response was blocked",!((t=g.promptFeedback)===null||t===void 0)&&t.blockReason&&(a+=` due to ${g.promptFeedback.blockReason}`),!((i=g.promptFeedback)===null||i===void 0)&&i.blockReasonMessage&&(a+=`: ${g.promptFeedback.blockReasonMessage}`);else if(!((s=g.candidates)===null||s===void 0)&&s[0]){const o=g.candidates[0];gl(o)&&(a+=`Candidate was blocked due to ${o.finishReason}`,o.finishMessage&&(a+=`: ${o.finishMessage}`))}return a}function Mr(g){return this instanceof Mr?(this.v=g,this):new Mr(g)}function e1(g,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=i.apply(g,t||[]),a,o=[];return a={},l("next"),l("throw"),l("return"),a[Symbol.asyncIterator]=function(){return this},a;function l(v){s[v]&&(a[v]=function(b){return new Promise(function(A,_){o.push([v,b,A,_])>1||u(v,b)})})}function u(v,b){try{h(s[v](b))}catch(A){m(o[0][3],A)}}function h(v){v.value instanceof Mr?Promise.resolve(v.value.v).then(d,p):m(o[0][2],v)}function d(v){u("next",v)}function p(v){u("throw",v)}function m(v,b){v(b),o.shift(),o.length&&u(o[0][0],o[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function i1(g){const t=g.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),i=a1(t),[s,a]=i.tee();return{stream:s1(s),response:n1(a)}}async function n1(g){const t=[],i=g.getReader();for(;;){const{done:s,value:a}=await i.read();if(s)return Nh(r1(t));t.push(a)}}function s1(g){return e1(this,arguments,function*(){const i=g.getReader();for(;;){const{value:s,done:a}=yield Mr(i.read());if(a)break;yield yield Mr(Nh(s))}})}function a1(g){const t=g.getReader();return new ReadableStream({start(s){let a="";return o();function o(){return t.read().then(({value:l,done:u})=>{if(u){if(a.trim()){s.error(new Ve("Failed to parse stream"));return}s.close();return}a+=l;let h=a.match(Mm),d;for(;h;){try{d=JSON.parse(h[1])}catch{s.error(new Ve(`Error parsing JSON response: "${h[1]}"`));return}s.enqueue(d),a=a.substring(h[0].length),h=a.match(Mm)}return o()}).catch(l=>{let u=l;throw u.stack=l.stack,u.name==="AbortError"?u=new g0("Request aborted when reading from the stream"):u=new Ve("Error reading from the stream"),u})}}})}function r1(g){const t=g[g.length-1],i={promptFeedback:t?.promptFeedback};for(const s of g){if(s.candidates){let a=0;for(const o of s.candidates)if(i.candidates||(i.candidates=[]),i.candidates[a]||(i.candidates[a]={index:a}),i.candidates[a].citationMetadata=o.citationMetadata,i.candidates[a].groundingMetadata=o.groundingMetadata,i.candidates[a].finishReason=o.finishReason,i.candidates[a].finishMessage=o.finishMessage,i.candidates[a].safetyRatings=o.safetyRatings,o.content&&o.content.parts){i.candidates[a].content||(i.candidates[a].content={role:o.content.role||"user",parts:[]});const l={};for(const u of o.content.parts)u.text&&(l.text=u.text),u.functionCall&&(l.functionCall=u.functionCall),u.executableCode&&(l.executableCode=u.executableCode),u.codeExecutionResult&&(l.codeExecutionResult=u.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),i.candidates[a].content.parts.push(l)}a++}s.usageMetadata&&(i.usageMetadata=s.usageMetadata)}return i}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m0(g,t,i,s){const a=await Ir(t,_s.STREAM_GENERATE_CONTENT,g,!0,JSON.stringify(i),s);return i1(a)}async function y0(g,t,i,s){const o=await(await Ir(t,_s.GENERATE_CONTENT,g,!1,JSON.stringify(i),s)).json();return{response:Nh(o)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(g){if(g!=null){if(typeof g=="string")return{role:"system",parts:[{text:g}]};if(g.text)return{role:"system",parts:[g]};if(g.parts)return g.role?g:{role:"system",parts:g.parts}}}function Rr(g){let t=[];if(typeof g=="string")t=[{text:g}];else for(const i of g)typeof i=="string"?t.push({text:i}):t.push(i);return o1(t)}function o1(g){const t={role:"user",parts:[]},i={role:"function",parts:[]};let s=!1,a=!1;for(const o of g)"functionResponse"in o?(i.parts.push(o),a=!0):(t.parts.push(o),s=!0);if(s&&a)throw new Ve("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!s&&!a)throw new Ve("No content is provided for sending chat message.");return s?t:i}function l1(g,t){var i;let s={model:t?.model,generationConfig:t?.generationConfig,safetySettings:t?.safetySettings,tools:t?.tools,toolConfig:t?.toolConfig,systemInstruction:t?.systemInstruction,cachedContent:(i=t?.cachedContent)===null||i===void 0?void 0:i.name,contents:[]};const a=g.generateContentRequest!=null;if(g.contents){if(a)throw new Yn("CountTokensRequest must have one of contents or generateContentRequest, not both.");s.contents=g.contents}else if(a)s=Object.assign(Object.assign({},s),g.generateContentRequest);else{const o=Rr(g);s.contents=[o]}return{generateContentRequest:s}}function Rm(g){let t;return g.contents?t=g:t={contents:[Rr(g)]},g.systemInstruction&&(t.systemInstruction=b0(g.systemInstruction)),t}function c1(g){return typeof g=="string"||Array.isArray(g)?{content:Rr(g)}:g}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dm=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],u1={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function h1(g){let t=!1;for(const i of g){const{role:s,parts:a}=i;if(!t&&s!=="user")throw new Ve(`First content should be with role 'user', got ${s}`);if(!vm.includes(s))throw new Ve(`Each item should include role field. Got ${s} but valid roles are: ${JSON.stringify(vm)}`);if(!Array.isArray(a))throw new Ve("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new Ve("Each Content should have at least one part");const o={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const u of a)for(const h of Dm)h in u&&(o[h]+=1);const l=u1[s];for(const u of Dm)if(!l.includes(u)&&o[u]>0)throw new Ve(`Content with role '${s}' can't contain '${u}' part`);t=!0}}function Om(g){var t;if(g.candidates===void 0||g.candidates.length===0)return!1;const i=(t=g.candidates[0])===null||t===void 0?void 0:t.content;if(i===void 0||i.parts===void 0||i.parts.length===0)return!1;for(const s of i.parts)if(s===void 0||Object.keys(s).length===0||s.text!==void 0&&s.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const km="SILENT_ERROR";class d1{constructor(t,i,s,a={}){this.model=i,this.params=s,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,s?.history&&(h1(s.history),this._history=s.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,i={}){var s,a,o,l,u,h;await this._sendPromise;const d=Rr(t),p={safetySettings:(s=this.params)===null||s===void 0?void 0:s.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(u=this.params)===null||u===void 0?void 0:u.systemInstruction,cachedContent:(h=this.params)===null||h===void 0?void 0:h.cachedContent,contents:[...this._history,d]},m=Object.assign(Object.assign({},this._requestOptions),i);let v;return this._sendPromise=this._sendPromise.then(()=>y0(this._apiKey,this.model,p,m)).then(b=>{var A;if(Om(b.response)){this._history.push(d);const _=Object.assign({parts:[],role:"model"},(A=b.response.candidates)===null||A===void 0?void 0:A[0].content);this._history.push(_)}else{const _=Gn(b.response);_&&console.warn(`sendMessage() was unsuccessful. ${_}. Inspect response object for details.`)}v=b}).catch(b=>{throw this._sendPromise=Promise.resolve(),b}),await this._sendPromise,v}async sendMessageStream(t,i={}){var s,a,o,l,u,h;await this._sendPromise;const d=Rr(t),p={safetySettings:(s=this.params)===null||s===void 0?void 0:s.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(u=this.params)===null||u===void 0?void 0:u.systemInstruction,cachedContent:(h=this.params)===null||h===void 0?void 0:h.cachedContent,contents:[...this._history,d]},m=Object.assign(Object.assign({},this._requestOptions),i),v=m0(this._apiKey,this.model,p,m);return this._sendPromise=this._sendPromise.then(()=>v).catch(b=>{throw new Error(km)}).then(b=>b.response).then(b=>{if(Om(b)){this._history.push(d);const A=Object.assign({},b.candidates[0].content);A.role||(A.role="model"),this._history.push(A)}else{const A=Gn(b);A&&console.warn(`sendMessageStream() was unsuccessful. ${A}. Inspect response object for details.`)}}).catch(b=>{b.message!==km&&console.error(b)}),v}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f1(g,t,i,s){return(await Ir(t,_s.COUNT_TOKENS,g,!1,JSON.stringify(i),s)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p1(g,t,i,s){return(await Ir(t,_s.EMBED_CONTENT,g,!1,JSON.stringify(i),s)).json()}async function g1(g,t,i,s){const a=i.requests.map(l=>Object.assign(Object.assign({},l),{model:t}));return(await Ir(t,_s.BATCH_EMBED_CONTENTS,g,!1,JSON.stringify({requests:a}),s)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(t,i,s={}){this.apiKey=t,this._requestOptions=s,i.model.includes("/")?this.model=i.model:this.model=`models/${i.model}`,this.generationConfig=i.generationConfig||{},this.safetySettings=i.safetySettings||[],this.tools=i.tools,this.toolConfig=i.toolConfig,this.systemInstruction=b0(i.systemInstruction),this.cachedContent=i.cachedContent}async generateContent(t,i={}){var s;const a=Rm(t),o=Object.assign(Object.assign({},this._requestOptions),i);return y0(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(s=this.cachedContent)===null||s===void 0?void 0:s.name},a),o)}async generateContentStream(t,i={}){var s;const a=Rm(t),o=Object.assign(Object.assign({},this._requestOptions),i);return m0(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(s=this.cachedContent)===null||s===void 0?void 0:s.name},a),o)}startChat(t){var i;return new d1(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},t),this._requestOptions)}async countTokens(t,i={}){const s=l1(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),i);return f1(this.apiKey,this.model,s,a)}async embedContent(t,i={}){const s=c1(t),a=Object.assign(Object.assign({},this._requestOptions),i);return p1(this.apiKey,this.model,s,a)}async batchEmbedContents(t,i={}){const s=Object.assign(Object.assign({},this._requestOptions),i);return g1(this.apiKey,this.model,t,s)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(t){this.apiKey=t}getGenerativeModel(t,i){if(!t.model)throw new Ve("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Nm(this.apiKey,t,i)}getGenerativeModelFromCachedContent(t,i,s){if(!t.name)throw new Yn("Cached content must contain a `name` field.");if(!t.model)throw new Yn("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const l of a)if(i?.[l]&&t[l]&&i?.[l]!==t[l]){if(l==="model"){const u=i.model.startsWith("models/")?i.model.replace("models/",""):i.model,h=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(u===h)continue}throw new Yn(`Different value for "${l}" specified in modelParams (${i[l]}) and cachedContent (${t[l]})`)}const o=Object.assign(Object.assign({},i),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new Nm(this.apiKey,o,s)}}function hl(g){throw new Error('Could not dynamically require "'+g+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ih={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Lm;function m1(){return Lm||(Lm=1,(function(g,t){(function(i){g.exports=i()})(function(){return(function i(s,a,o){function l(d,p){if(!a[d]){if(!s[d]){var m=typeof hl=="function"&&hl;if(!p&&m)return m(d,!0);if(u)return u(d,!0);var v=new Error("Cannot find module '"+d+"'");throw v.code="MODULE_NOT_FOUND",v}var b=a[d]={exports:{}};s[d][0].call(b.exports,function(A){var _=s[d][1][A];return l(_||A)},b,b.exports,i,s,a,o)}return a[d].exports}for(var u=typeof hl=="function"&&hl,h=0;h<o.length;h++)l(o[h]);return l})({1:[function(i,s,a){var o=i("./utils"),l=i("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(h){for(var d,p,m,v,b,A,_,w=[],S=0,T=h.length,M=T,k=o.getTypeOf(h)!=="string";S<h.length;)M=T-S,m=k?(d=h[S++],p=S<T?h[S++]:0,S<T?h[S++]:0):(d=h.charCodeAt(S++),p=S<T?h.charCodeAt(S++):0,S<T?h.charCodeAt(S++):0),v=d>>2,b=(3&d)<<4|p>>4,A=1<M?(15&p)<<2|m>>6:64,_=2<M?63&m:64,w.push(u.charAt(v)+u.charAt(b)+u.charAt(A)+u.charAt(_));return w.join("")},a.decode=function(h){var d,p,m,v,b,A,_=0,w=0,S="data:";if(h.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var T,M=3*(h=h.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(h.charAt(h.length-1)===u.charAt(64)&&M--,h.charAt(h.length-2)===u.charAt(64)&&M--,M%1!=0)throw new Error("Invalid base64 input, bad content length.");for(T=l.uint8array?new Uint8Array(0|M):new Array(0|M);_<h.length;)d=u.indexOf(h.charAt(_++))<<2|(v=u.indexOf(h.charAt(_++)))>>4,p=(15&v)<<4|(b=u.indexOf(h.charAt(_++)))>>2,m=(3&b)<<6|(A=u.indexOf(h.charAt(_++))),T[w++]=d,b!==64&&(T[w++]=p),A!==64&&(T[w++]=m);return T}},{"./support":30,"./utils":32}],2:[function(i,s,a){var o=i("./external"),l=i("./stream/DataWorker"),u=i("./stream/Crc32Probe"),h=i("./stream/DataLengthProbe");function d(p,m,v,b,A){this.compressedSize=p,this.uncompressedSize=m,this.crc32=v,this.compression=b,this.compressedContent=A}d.prototype={getContentWorker:function(){var p=new l(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new h("data_length")),m=this;return p.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new l(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(p,m,v){return p.pipe(new u).pipe(new h("uncompressedSize")).pipe(m.compressWorker(v)).pipe(new h("compressedSize")).withStreamInfo("compression",m)},s.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(i,s,a){var o=i("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},a.DEFLATE=i("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(i,s,a){var o=i("./utils"),l=(function(){for(var u,h=[],d=0;d<256;d++){u=d;for(var p=0;p<8;p++)u=1&u?3988292384^u>>>1:u>>>1;h[d]=u}return h})();s.exports=function(u,h){return u!==void 0&&u.length?o.getTypeOf(u)!=="string"?(function(d,p,m,v){var b=l,A=v+m;d^=-1;for(var _=v;_<A;_++)d=d>>>8^b[255&(d^p[_])];return-1^d})(0|h,u,u.length,0):(function(d,p,m,v){var b=l,A=v+m;d^=-1;for(var _=v;_<A;_++)d=d>>>8^b[255&(d^p.charCodeAt(_))];return-1^d})(0|h,u,u.length,0):0}},{"./utils":32}],5:[function(i,s,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(i,s,a){var o=null;o=typeof Promise<"u"?Promise:i("lie"),s.exports={Promise:o}},{lie:37}],7:[function(i,s,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=i("pako"),u=i("./utils"),h=i("./stream/GenericWorker"),d=o?"uint8array":"array";function p(m,v){h.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=v,this.meta={}}a.magic="\b\0",u.inherits(p,h),p.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(d,m.data),!1)},p.prototype.flush=function(){h.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(v){m.push({data:v,meta:m.meta})}},a.compressWorker=function(m){return new p("Deflate",m)},a.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(i,s,a){function o(b,A){var _,w="";for(_=0;_<A;_++)w+=String.fromCharCode(255&b),b>>>=8;return w}function l(b,A,_,w,S,T){var M,k,O=b.file,z=b.compression,L=T!==d.utf8encode,G=u.transformTo("string",T(O.name)),j=u.transformTo("string",d.utf8encode(O.name)),Z=O.comment,ot=u.transformTo("string",T(Z)),I=u.transformTo("string",d.utf8encode(Z)),X=j.length!==O.name.length,x=I.length!==Z.length,tt="",U="",H="",ct=O.dir,st=O.date,mt={crc32:0,compressedSize:0,uncompressedSize:0};A&&!_||(mt.crc32=b.crc32,mt.compressedSize=b.compressedSize,mt.uncompressedSize=b.uncompressedSize);var D=0;A&&(D|=8),L||!X&&!x||(D|=2048);var B=0,J=0;ct&&(B|=16),S==="UNIX"?(J=798,B|=(function(at,At){var St=at;return at||(St=At?16893:33204),(65535&St)<<16})(O.unixPermissions,ct)):(J=20,B|=(function(at){return 63&(at||0)})(O.dosPermissions)),M=st.getUTCHours(),M<<=6,M|=st.getUTCMinutes(),M<<=5,M|=st.getUTCSeconds()/2,k=st.getUTCFullYear()-1980,k<<=4,k|=st.getUTCMonth()+1,k<<=5,k|=st.getUTCDate(),X&&(U=o(1,1)+o(p(G),4)+j,tt+="up"+o(U.length,2)+U),x&&(H=o(1,1)+o(p(ot),4)+I,tt+="uc"+o(H.length,2)+H);var it="";return it+=`
\0`,it+=o(D,2),it+=z.magic,it+=o(M,2),it+=o(k,2),it+=o(mt.crc32,4),it+=o(mt.compressedSize,4),it+=o(mt.uncompressedSize,4),it+=o(G.length,2),it+=o(tt.length,2),{fileRecord:m.LOCAL_FILE_HEADER+it+G+tt,dirRecord:m.CENTRAL_FILE_HEADER+o(J,2)+it+o(ot.length,2)+"\0\0\0\0"+o(B,4)+o(w,4)+G+tt+ot}}var u=i("../utils"),h=i("../stream/GenericWorker"),d=i("../utf8"),p=i("../crc32"),m=i("../signature");function v(b,A,_,w){h.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=A,this.zipPlatform=_,this.encodeFileName=w,this.streamFiles=b,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(v,h),v.prototype.push=function(b){var A=b.meta.percent||0,_=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(b):(this.bytesWritten+=b.data.length,h.prototype.push.call(this,{data:b.data,meta:{currentFile:this.currentFile,percent:_?(A+100*(_-w-1))/_:100}}))},v.prototype.openedSource=function(b){this.currentSourceOffset=this.bytesWritten,this.currentFile=b.file.name;var A=this.streamFiles&&!b.file.dir;if(A){var _=l(b,A,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},v.prototype.closedSource=function(b){this.accumulate=!1;var A=this.streamFiles&&!b.file.dir,_=l(b,A,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),A)this.push({data:(function(w){return m.DATA_DESCRIPTOR+o(w.crc32,4)+o(w.compressedSize,4)+o(w.uncompressedSize,4)})(b),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},v.prototype.flush=function(){for(var b=this.bytesWritten,A=0;A<this.dirRecords.length;A++)this.push({data:this.dirRecords[A],meta:{percent:100}});var _=this.bytesWritten-b,w=(function(S,T,M,k,O){var z=u.transformTo("string",O(k));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(S,2)+o(S,2)+o(T,4)+o(M,4)+o(z.length,2)+z})(this.dirRecords.length,_,b,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},v.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},v.prototype.registerPrevious=function(b){this._sources.push(b);var A=this;return b.on("data",function(_){A.processChunk(_)}),b.on("end",function(){A.closedSource(A.previous.streamInfo),A._sources.length?A.prepareNextSource():A.end()}),b.on("error",function(_){A.error(_)}),this},v.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},v.prototype.error=function(b){var A=this._sources;if(!h.prototype.error.call(this,b))return!1;for(var _=0;_<A.length;_++)try{A[_].error(b)}catch{}return!0},v.prototype.lock=function(){h.prototype.lock.call(this);for(var b=this._sources,A=0;A<b.length;A++)b[A].lock()},s.exports=v},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(i,s,a){var o=i("../compressions"),l=i("./ZipFileWorker");a.generateWorker=function(u,h,d){var p=new l(h.streamFiles,d,h.platform,h.encodeFileName),m=0;try{u.forEach(function(v,b){m++;var A=(function(T,M){var k=T||M,O=o[k];if(!O)throw new Error(k+" is not a valid compression method !");return O})(b.options.compression,h.compression),_=b.options.compressionOptions||h.compressionOptions||{},w=b.dir,S=b.date;b._compressWorker(A,_).withStreamInfo("file",{name:v,dir:w,date:S,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(p)}),p.entriesCount=m}catch(v){p.error(v)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(i,s,a){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new o;for(var u in this)typeof this[u]!="function"&&(l[u]=this[u]);return l}}(o.prototype=i("./object")).loadAsync=i("./load"),o.support=i("./support"),o.defaults=i("./defaults"),o.version="3.10.1",o.loadAsync=function(l,u){return new o().loadAsync(l,u)},o.external=i("./external"),s.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(i,s,a){var o=i("./utils"),l=i("./external"),u=i("./utf8"),h=i("./zipEntries"),d=i("./stream/Crc32Probe"),p=i("./nodejsUtils");function m(v){return new l.Promise(function(b,A){var _=v.decompressed.getContentWorker().pipe(new d);_.on("error",function(w){A(w)}).on("end",function(){_.streamInfo.crc32!==v.decompressed.crc32?A(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}s.exports=function(v,b){var A=this;return b=o.extend(b||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),p.isNode&&p.isStream(v)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",v,!0,b.optimizedBinaryString,b.base64).then(function(_){var w=new h(b);return w.load(_),w}).then(function(_){var w=[l.Promise.resolve(_)],S=_.files;if(b.checkCRC32)for(var T=0;T<S.length;T++)w.push(m(S[T]));return l.Promise.all(w)}).then(function(_){for(var w=_.shift(),S=w.files,T=0;T<S.length;T++){var M=S[T],k=M.fileNameStr,O=o.resolve(M.fileNameStr);A.file(O,M.decompressed,{binary:!0,optimizedBinaryString:!0,date:M.date,dir:M.dir,comment:M.fileCommentStr.length?M.fileCommentStr:null,unixPermissions:M.unixPermissions,dosPermissions:M.dosPermissions,createFolders:b.createFolders}),M.dir||(A.file(O).unsafeOriginalName=k)}return w.zipComment.length&&(A.comment=w.zipComment),A})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(i,s,a){var o=i("../utils"),l=i("../stream/GenericWorker");function u(h,d){l.call(this,"Nodejs stream input adapter for "+h),this._upstreamEnded=!1,this._bindStream(d)}o.inherits(u,l),u.prototype._bindStream=function(h){var d=this;(this._stream=h).pause(),h.on("data",function(p){d.push({data:p,meta:{percent:0}})}).on("error",function(p){d.isPaused?this.generatedError=p:d.error(p)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},u.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(i,s,a){var o=i("readable-stream").Readable;function l(u,h,d){o.call(this,h),this._helper=u;var p=this;u.on("data",function(m,v){p.push(m)||p._helper.pause(),d&&d(v)}).on("error",function(m){p.emit("error",m)}).on("end",function(){p.push(null)})}i("../utils").inherits(l,o),l.prototype._read=function(){this._helper.resume()},s.exports=l},{"../utils":32,"readable-stream":16}],14:[function(i,s,a){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,l);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,l)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var l=new Buffer(o);return l.fill(0),l},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(i,s,a){function o(O,z,L){var G,j=u.getTypeOf(z),Z=u.extend(L||{},p);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(O=S(O)),Z.createFolders&&(G=w(O))&&T.call(this,G,!0);var ot=j==="string"&&Z.binary===!1&&Z.base64===!1;L&&L.binary!==void 0||(Z.binary=!ot),(z instanceof m&&z.uncompressedSize===0||Z.dir||!z||z.length===0)&&(Z.base64=!1,Z.binary=!0,z="",Z.compression="STORE",j="string");var I=null;I=z instanceof m||z instanceof h?z:A.isNode&&A.isStream(z)?new _(O,z):u.prepareContent(O,z,Z.binary,Z.optimizedBinaryString,Z.base64);var X=new v(O,I,Z);this.files[O]=X}var l=i("./utf8"),u=i("./utils"),h=i("./stream/GenericWorker"),d=i("./stream/StreamHelper"),p=i("./defaults"),m=i("./compressedObject"),v=i("./zipObject"),b=i("./generate"),A=i("./nodejsUtils"),_=i("./nodejs/NodejsStreamInputAdapter"),w=function(O){O.slice(-1)==="/"&&(O=O.substring(0,O.length-1));var z=O.lastIndexOf("/");return 0<z?O.substring(0,z):""},S=function(O){return O.slice(-1)!=="/"&&(O+="/"),O},T=function(O,z){return z=z!==void 0?z:p.createFolders,O=S(O),this.files[O]||o.call(this,O,null,{dir:!0,createFolders:z}),this.files[O]};function M(O){return Object.prototype.toString.call(O)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(O){var z,L,G;for(z in this.files)G=this.files[z],(L=z.slice(this.root.length,z.length))&&z.slice(0,this.root.length)===this.root&&O(L,G)},filter:function(O){var z=[];return this.forEach(function(L,G){O(L,G)&&z.push(G)}),z},file:function(O,z,L){if(arguments.length!==1)return O=this.root+O,o.call(this,O,z,L),this;if(M(O)){var G=O;return this.filter(function(Z,ot){return!ot.dir&&G.test(Z)})}var j=this.files[this.root+O];return j&&!j.dir?j:null},folder:function(O){if(!O)return this;if(M(O))return this.filter(function(j,Z){return Z.dir&&O.test(j)});var z=this.root+O,L=T.call(this,z),G=this.clone();return G.root=L.name,G},remove:function(O){O=this.root+O;var z=this.files[O];if(z||(O.slice(-1)!=="/"&&(O+="/"),z=this.files[O]),z&&!z.dir)delete this.files[O];else for(var L=this.filter(function(j,Z){return Z.name.slice(0,O.length)===O}),G=0;G<L.length;G++)delete this.files[L[G].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(O){var z,L={};try{if((L=u.extend(O||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=L.type.toLowerCase(),L.compression=L.compression.toUpperCase(),L.type==="binarystring"&&(L.type="string"),!L.type)throw new Error("No output type specified.");u.checkSupport(L.type),L.platform!=="darwin"&&L.platform!=="freebsd"&&L.platform!=="linux"&&L.platform!=="sunos"||(L.platform="UNIX"),L.platform==="win32"&&(L.platform="DOS");var G=L.comment||this.comment||"";z=b.generateWorker(this,L,G)}catch(j){(z=new h("error")).error(j)}return new d(z,L.type||"string",L.mimeType)},generateAsync:function(O,z){return this.generateInternalStream(O).accumulate(z)},generateNodeStream:function(O,z){return(O=O||{}).type||(O.type="nodebuffer"),this.generateInternalStream(O).toNodejsStream(z)}};s.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(i,s,a){s.exports=i("stream")},{stream:void 0}],17:[function(i,s,a){var o=i("./DataReader");function l(u){o.call(this,u);for(var h=0;h<this.data.length;h++)u[h]=255&u[h]}i("../utils").inherits(l,o),l.prototype.byteAt=function(u){return this.data[this.zero+u]},l.prototype.lastIndexOfSignature=function(u){for(var h=u.charCodeAt(0),d=u.charCodeAt(1),p=u.charCodeAt(2),m=u.charCodeAt(3),v=this.length-4;0<=v;--v)if(this.data[v]===h&&this.data[v+1]===d&&this.data[v+2]===p&&this.data[v+3]===m)return v-this.zero;return-1},l.prototype.readAndCheckSignature=function(u){var h=u.charCodeAt(0),d=u.charCodeAt(1),p=u.charCodeAt(2),m=u.charCodeAt(3),v=this.readData(4);return h===v[0]&&d===v[1]&&p===v[2]&&m===v[3]},l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var h=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,h},s.exports=l},{"../utils":32,"./DataReader":18}],18:[function(i,s,a){var o=i("../utils");function l(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var h,d=0;for(this.checkOffset(u),h=this.index+u-1;h>=this.index;h--)d=(d<<8)+this.byteAt(h);return this.index+=u,d},readString:function(u){return o.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},s.exports=l},{"../utils":32}],19:[function(i,s,a){var o=i("./Uint8ArrayReader");function l(u){o.call(this,u)}i("../utils").inherits(l,o),l.prototype.readData=function(u){this.checkOffset(u);var h=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,h},s.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(i,s,a){var o=i("./DataReader");function l(u){o.call(this,u)}i("../utils").inherits(l,o),l.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},l.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},l.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},l.prototype.readData=function(u){this.checkOffset(u);var h=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,h},s.exports=l},{"../utils":32,"./DataReader":18}],21:[function(i,s,a){var o=i("./ArrayReader");function l(u){o.call(this,u)}i("../utils").inherits(l,o),l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var h=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,h},s.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(i,s,a){var o=i("../utils"),l=i("../support"),u=i("./ArrayReader"),h=i("./StringReader"),d=i("./NodeBufferReader"),p=i("./Uint8ArrayReader");s.exports=function(m){var v=o.getTypeOf(m);return o.checkSupport(v),v!=="string"||l.uint8array?v==="nodebuffer"?new d(m):l.uint8array?new p(o.transformTo("uint8array",m)):new u(o.transformTo("array",m)):new h(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(i,s,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(i,s,a){var o=i("./GenericWorker"),l=i("../utils");function u(h){o.call(this,"ConvertWorker to "+h),this.destType=h}l.inherits(u,o),u.prototype.processChunk=function(h){this.push({data:l.transformTo(this.destType,h.data),meta:h.meta})},s.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(i,s,a){var o=i("./GenericWorker"),l=i("../crc32");function u(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}i("../utils").inherits(u,o),u.prototype.processChunk=function(h){this.streamInfo.crc32=l(h.data,this.streamInfo.crc32||0),this.push(h)},s.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(i,s,a){var o=i("../utils"),l=i("./GenericWorker");function u(h){l.call(this,"DataLengthProbe for "+h),this.propName=h,this.withStreamInfo(h,0)}o.inherits(u,l),u.prototype.processChunk=function(h){if(h){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+h.data.length}l.prototype.processChunk.call(this,h)},s.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(i,s,a){var o=i("../utils"),l=i("./GenericWorker");function u(h){l.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,h.then(function(p){d.dataIsReady=!0,d.data=p,d.max=p&&p.length||0,d.type=o.getTypeOf(p),d.isPaused||d._tickAndRepeat()},function(p){d.error(p)})}o.inherits(u,l),u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var h=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":h=this.data.substring(this.index,d);break;case"uint8array":h=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":h=this.data.slice(this.index,d)}return this.index=d,this.push({data:h,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(i,s,a){function o(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,u){return this._listeners[l].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,u){if(this._listeners[l])for(var h=0;h<this._listeners[l].length;h++)this._listeners[l][h].call(this,u)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var u=this;return l.on("data",function(h){u.processChunk(h)}),l.on("end",function(){u.end()}),l.on("error",function(h){u.error(h)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,u){return this.extraStreamInfo[l]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},s.exports=o},{}],29:[function(i,s,a){var o=i("../utils"),l=i("./ConvertWorker"),u=i("./GenericWorker"),h=i("../base64"),d=i("../support"),p=i("../external"),m=null;if(d.nodestream)try{m=i("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(A,_){return new p.Promise(function(w,S){var T=[],M=A._internalType,k=A._outputType,O=A._mimeType;A.on("data",function(z,L){T.push(z),_&&_(L)}).on("error",function(z){T=[],S(z)}).on("end",function(){try{var z=(function(L,G,j){switch(L){case"blob":return o.newBlob(o.transformTo("arraybuffer",G),j);case"base64":return h.encode(G);default:return o.transformTo(L,G)}})(k,(function(L,G){var j,Z=0,ot=null,I=0;for(j=0;j<G.length;j++)I+=G[j].length;switch(L){case"string":return G.join("");case"array":return Array.prototype.concat.apply([],G);case"uint8array":for(ot=new Uint8Array(I),j=0;j<G.length;j++)ot.set(G[j],Z),Z+=G[j].length;return ot;case"nodebuffer":return Buffer.concat(G);default:throw new Error("concat : unsupported type '"+L+"'")}})(M,T),O);w(z)}catch(L){S(L)}T=[]}).resume()})}function b(A,_,w){var S=_;switch(_){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=_,this._mimeType=w,o.checkSupport(S),this._worker=A.pipe(new l(S)),A.lock()}catch(T){this._worker=new u("error"),this._worker.error(T)}}b.prototype={accumulate:function(A){return v(this,A)},on:function(A,_){var w=this;return A==="data"?this._worker.on(A,function(S){_.call(w,S.data,S.meta)}):this._worker.on(A,function(){o.delay(_,arguments,w)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(A){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},A)}},s.exports=b},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(i,s,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var o=new ArrayBuffer(0);try{a.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(o),a.blob=l.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!i("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(i,s,a){for(var o=i("./utils"),l=i("./support"),u=i("./nodejsUtils"),h=i("./stream/GenericWorker"),d=new Array(256),p=0;p<256;p++)d[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;d[254]=d[254]=1;function m(){h.call(this,"utf-8 decode"),this.leftOver=null}function v(){h.call(this,"utf-8 encode")}a.utf8encode=function(b){return l.nodebuffer?u.newBufferFrom(b,"utf-8"):(function(A){var _,w,S,T,M,k=A.length,O=0;for(T=0;T<k;T++)(64512&(w=A.charCodeAt(T)))==55296&&T+1<k&&(64512&(S=A.charCodeAt(T+1)))==56320&&(w=65536+(w-55296<<10)+(S-56320),T++),O+=w<128?1:w<2048?2:w<65536?3:4;for(_=l.uint8array?new Uint8Array(O):new Array(O),T=M=0;M<O;T++)(64512&(w=A.charCodeAt(T)))==55296&&T+1<k&&(64512&(S=A.charCodeAt(T+1)))==56320&&(w=65536+(w-55296<<10)+(S-56320),T++),w<128?_[M++]=w:(w<2048?_[M++]=192|w>>>6:(w<65536?_[M++]=224|w>>>12:(_[M++]=240|w>>>18,_[M++]=128|w>>>12&63),_[M++]=128|w>>>6&63),_[M++]=128|63&w);return _})(b)},a.utf8decode=function(b){return l.nodebuffer?o.transformTo("nodebuffer",b).toString("utf-8"):(function(A){var _,w,S,T,M=A.length,k=new Array(2*M);for(_=w=0;_<M;)if((S=A[_++])<128)k[w++]=S;else if(4<(T=d[S]))k[w++]=65533,_+=T-1;else{for(S&=T===2?31:T===3?15:7;1<T&&_<M;)S=S<<6|63&A[_++],T--;1<T?k[w++]=65533:S<65536?k[w++]=S:(S-=65536,k[w++]=55296|S>>10&1023,k[w++]=56320|1023&S)}return k.length!==w&&(k.subarray?k=k.subarray(0,w):k.length=w),o.applyFromCharCode(k)})(b=o.transformTo(l.uint8array?"uint8array":"array",b))},o.inherits(m,h),m.prototype.processChunk=function(b){var A=o.transformTo(l.uint8array?"uint8array":"array",b.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var _=A;(A=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),A.set(_,this.leftOver.length)}else A=this.leftOver.concat(A);this.leftOver=null}var w=(function(T,M){var k;for((M=M||T.length)>T.length&&(M=T.length),k=M-1;0<=k&&(192&T[k])==128;)k--;return k<0||k===0?M:k+d[T[k]]>M?k:M})(A),S=A;w!==A.length&&(l.uint8array?(S=A.subarray(0,w),this.leftOver=A.subarray(w,A.length)):(S=A.slice(0,w),this.leftOver=A.slice(w,A.length))),this.push({data:a.utf8decode(S),meta:b.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=m,o.inherits(v,h),v.prototype.processChunk=function(b){this.push({data:a.utf8encode(b.data),meta:b.meta})},a.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(i,s,a){var o=i("./support"),l=i("./base64"),u=i("./nodejsUtils"),h=i("./external");function d(_){return _}function p(_,w){for(var S=0;S<_.length;++S)w[S]=255&_.charCodeAt(S);return w}i("setimmediate"),a.newBlob=function(_,w){a.checkSupport("blob");try{return new Blob([_],{type:w})}catch{try{var S=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return S.append(_),S.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(_,w,S){var T=[],M=0,k=_.length;if(k<=S)return String.fromCharCode.apply(null,_);for(;M<k;)w==="array"||w==="nodebuffer"?T.push(String.fromCharCode.apply(null,_.slice(M,Math.min(M+S,k)))):T.push(String.fromCharCode.apply(null,_.subarray(M,Math.min(M+S,k)))),M+=S;return T.join("")},stringifyByChar:function(_){for(var w="",S=0;S<_.length;S++)w+=String.fromCharCode(_[S]);return w},applyCanBeUsed:{uint8array:(function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}})()}};function v(_){var w=65536,S=a.getTypeOf(_),T=!0;if(S==="uint8array"?T=m.applyCanBeUsed.uint8array:S==="nodebuffer"&&(T=m.applyCanBeUsed.nodebuffer),T)for(;1<w;)try{return m.stringifyByChunk(_,S,w)}catch{w=Math.floor(w/2)}return m.stringifyByChar(_)}function b(_,w){for(var S=0;S<_.length;S++)w[S]=_[S];return w}a.applyFromCharCode=v;var A={};A.string={string:d,array:function(_){return p(_,new Array(_.length))},arraybuffer:function(_){return A.string.uint8array(_).buffer},uint8array:function(_){return p(_,new Uint8Array(_.length))},nodebuffer:function(_){return p(_,u.allocBuffer(_.length))}},A.array={string:v,array:d,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return u.newBufferFrom(_)}},A.arraybuffer={string:function(_){return v(new Uint8Array(_))},array:function(_){return b(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:d,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return u.newBufferFrom(new Uint8Array(_))}},A.uint8array={string:v,array:function(_){return b(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:d,nodebuffer:function(_){return u.newBufferFrom(_)}},A.nodebuffer={string:v,array:function(_){return b(_,new Array(_.length))},arraybuffer:function(_){return A.nodebuffer.uint8array(_).buffer},uint8array:function(_){return b(_,new Uint8Array(_.length))},nodebuffer:d},a.transformTo=function(_,w){if(w=w||"",!_)return w;a.checkSupport(_);var S=a.getTypeOf(w);return A[S][_](w)},a.resolve=function(_){for(var w=_.split("/"),S=[],T=0;T<w.length;T++){var M=w[T];M==="."||M===""&&T!==0&&T!==w.length-1||(M===".."?S.pop():S.push(M))}return S.join("/")},a.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":o.nodebuffer&&u.isBuffer(_)?"nodebuffer":o.uint8array&&_ instanceof Uint8Array?"uint8array":o.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(_){if(!o[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(_){var w,S,T="";for(S=0;S<(_||"").length;S++)T+="\\x"+((w=_.charCodeAt(S))<16?"0":"")+w.toString(16).toUpperCase();return T},a.delay=function(_,w,S){setImmediate(function(){_.apply(S||null,w||[])})},a.inherits=function(_,w){function S(){}S.prototype=w.prototype,_.prototype=new S},a.extend=function(){var _,w,S={};for(_=0;_<arguments.length;_++)for(w in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],w)&&S[w]===void 0&&(S[w]=arguments[_][w]);return S},a.prepareContent=function(_,w,S,T,M){return h.Promise.resolve(w).then(function(k){return o.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new h.Promise(function(O,z){var L=new FileReader;L.onload=function(G){O(G.target.result)},L.onerror=function(G){z(G.target.error)},L.readAsArrayBuffer(k)}):k}).then(function(k){var O=a.getTypeOf(k);return O?(O==="arraybuffer"?k=a.transformTo("uint8array",k):O==="string"&&(M?k=l.decode(k):S&&T!==!0&&(k=(function(z){return p(z,o.uint8array?new Uint8Array(z.length):new Array(z.length))})(k))),k):h.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(i,s,a){var o=i("./reader/readerFor"),l=i("./utils"),u=i("./signature"),h=i("./zipEntry"),d=i("./support");function p(m){this.files=[],this.loadOptions=m}p.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(v)+", expected "+l.pretty(m)+")")}},isSignature:function(m,v){var b=this.reader.index;this.reader.setIndex(m);var A=this.reader.readString(4)===v;return this.reader.setIndex(b),A},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),v=d.uint8array?"uint8array":"array",b=l.transformTo(v,m);this.zipComment=this.loadOptions.decodeFileName(b)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,v,b,A=this.zip64EndOfCentralSize-44;0<A;)m=this.reader.readInt(2),v=this.reader.readInt(4),b=this.reader.readData(v),this.zip64ExtensibleData[m]={id:m,length:v,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,v;for(m=0;m<this.files.length;m++)v=this.files[m],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(m=new h({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var v=m;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var b=this.centralDirOffset+this.centralDirSize;this.zip64&&(b+=20,b+=12+this.zip64EndOfCentralSize);var A=v-b;if(0<A)this.isSignature(v,u.CENTRAL_FILE_HEADER)||(this.reader.zero=A);else if(A<0)throw new Error("Corrupted zip: missing "+Math.abs(A)+" bytes.")},prepareReader:function(m){this.reader=o(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(i,s,a){var o=i("./reader/readerFor"),l=i("./utils"),u=i("./compressedObject"),h=i("./crc32"),d=i("./utf8"),p=i("./compressions"),m=i("./support");function v(b,A){this.options=b,this.loadOptions=A}v.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(b){var A,_;if(b.skip(22),this.fileNameLength=b.readInt(2),_=b.readInt(2),this.fileName=b.readData(this.fileNameLength),b.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((A=(function(w){for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)&&p[S].magic===w)return p[S];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,A,b.readData(this.compressedSize))},readCentralPart:function(b){this.versionMadeBy=b.readInt(2),b.skip(2),this.bitFlag=b.readInt(2),this.compressionMethod=b.readString(2),this.date=b.readDate(),this.crc32=b.readInt(4),this.compressedSize=b.readInt(4),this.uncompressedSize=b.readInt(4);var A=b.readInt(2);if(this.extraFieldsLength=b.readInt(2),this.fileCommentLength=b.readInt(2),this.diskNumberStart=b.readInt(2),this.internalFileAttributes=b.readInt(2),this.externalFileAttributes=b.readInt(4),this.localHeaderOffset=b.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");b.skip(A),this.readExtraFields(b),this.parseZIP64ExtraField(b),this.fileComment=b.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var b=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),b==0&&(this.dosPermissions=63&this.externalFileAttributes),b==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var b=o(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=b.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=b.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=b.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=b.readInt(4))}},readExtraFields:function(b){var A,_,w,S=b.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});b.index+4<S;)A=b.readInt(2),_=b.readInt(2),w=b.readData(_),this.extraFields[A]={id:A,length:_,value:w};b.setIndex(S)},handleUTF8:function(){var b=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var A=this.findExtraFieldUnicodePath();if(A!==null)this.fileNameStr=A;else{var _=l.transformTo(b,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var S=l.transformTo(b,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var b=this.extraFields[28789];if(b){var A=o(b.value);return A.readInt(1)!==1||h(this.fileName)!==A.readInt(4)?null:d.utf8decode(A.readData(b.length-5))}return null},findExtraFieldUnicodeComment:function(){var b=this.extraFields[25461];if(b){var A=o(b.value);return A.readInt(1)!==1||h(this.fileComment)!==A.readInt(4)?null:d.utf8decode(A.readData(b.length-5))}return null}},s.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(i,s,a){function o(A,_,w){this.name=A,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=_,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var l=i("./stream/StreamHelper"),u=i("./stream/DataWorker"),h=i("./utf8"),d=i("./compressedObject"),p=i("./stream/GenericWorker");o.prototype={internalStream:function(A){var _=null,w="string";try{if(!A)throw new Error("No output type specified.");var S=(w=A.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),_=this._decompressWorker();var T=!this._dataBinary;T&&!S&&(_=_.pipe(new h.Utf8EncodeWorker)),!T&&S&&(_=_.pipe(new h.Utf8DecodeWorker))}catch(M){(_=new p("error")).error(M)}return new l(_,w,"")},async:function(A,_){return this.internalStream(A).accumulate(_)},nodeStream:function(A,_){return this.internalStream(A||"nodebuffer").toNodejsStream(_)},_compressWorker:function(A,_){if(this._data instanceof d&&this._data.compression.magic===A.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new h.Utf8EncodeWorker)),d.createWorkerFrom(w,A,_)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof p?this._data:new u(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},b=0;b<m.length;b++)o.prototype[m[b]]=v;s.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(i,s,a){(function(o){var l,u,h=o.MutationObserver||o.WebKitMutationObserver;if(h){var d=0,p=new h(A),m=o.document.createTextNode("");p.observe(m,{characterData:!0}),l=function(){m.data=d=++d%2}}else if(o.setImmediate||o.MessageChannel===void 0)l="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var _=o.document.createElement("script");_.onreadystatechange=function(){A(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},o.document.documentElement.appendChild(_)}:function(){setTimeout(A,0)};else{var v=new o.MessageChannel;v.port1.onmessage=A,l=function(){v.port2.postMessage(0)}}var b=[];function A(){var _,w;u=!0;for(var S=b.length;S;){for(w=b,b=[],_=-1;++_<S;)w[_]();S=b.length}u=!1}s.exports=function(_){b.push(_)!==1||u||l()}}).call(this,typeof Jo<"u"?Jo:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(i,s,a){var o=i("immediate");function l(){}var u={},h=["REJECTED"],d=["FULFILLED"],p=["PENDING"];function m(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,S!==l&&_(this,S)}function v(S,T,M){this.promise=S,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof M=="function"&&(this.onRejected=M,this.callRejected=this.otherCallRejected)}function b(S,T,M){o(function(){var k;try{k=T(M)}catch(O){return u.reject(S,O)}k===S?u.reject(S,new TypeError("Cannot resolve promise with itself")):u.resolve(S,k)})}function A(S){var T=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof T=="function")return function(){T.apply(S,arguments)}}function _(S,T){var M=!1;function k(L){M||(M=!0,u.reject(S,L))}function O(L){M||(M=!0,u.resolve(S,L))}var z=w(function(){T(O,k)});z.status==="error"&&k(z.value)}function w(S,T){var M={};try{M.value=S(T),M.status="success"}catch(k){M.status="error",M.value=k}return M}(s.exports=m).prototype.finally=function(S){if(typeof S!="function")return this;var T=this.constructor;return this.then(function(M){return T.resolve(S()).then(function(){return M})},function(M){return T.resolve(S()).then(function(){throw M})})},m.prototype.catch=function(S){return this.then(null,S)},m.prototype.then=function(S,T){if(typeof S!="function"&&this.state===d||typeof T!="function"&&this.state===h)return this;var M=new this.constructor(l);return this.state!==p?b(M,this.state===d?S:T,this.outcome):this.queue.push(new v(M,S,T)),M},v.prototype.callFulfilled=function(S){u.resolve(this.promise,S)},v.prototype.otherCallFulfilled=function(S){b(this.promise,this.onFulfilled,S)},v.prototype.callRejected=function(S){u.reject(this.promise,S)},v.prototype.otherCallRejected=function(S){b(this.promise,this.onRejected,S)},u.resolve=function(S,T){var M=w(A,T);if(M.status==="error")return u.reject(S,M.value);var k=M.value;if(k)_(S,k);else{S.state=d,S.outcome=T;for(var O=-1,z=S.queue.length;++O<z;)S.queue[O].callFulfilled(T)}return S},u.reject=function(S,T){S.state=h,S.outcome=T;for(var M=-1,k=S.queue.length;++M<k;)S.queue[M].callRejected(T);return S},m.resolve=function(S){return S instanceof this?S:u.resolve(new this(l),S)},m.reject=function(S){var T=new this(l);return u.reject(T,S)},m.all=function(S){var T=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=S.length,k=!1;if(!M)return this.resolve([]);for(var O=new Array(M),z=0,L=-1,G=new this(l);++L<M;)j(S[L],L);return G;function j(Z,ot){T.resolve(Z).then(function(I){O[ot]=I,++z!==M||k||(k=!0,u.resolve(G,O))},function(I){k||(k=!0,u.reject(G,I))})}},m.race=function(S){var T=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=S.length,k=!1;if(!M)return this.resolve([]);for(var O=-1,z=new this(l);++O<M;)L=S[O],T.resolve(L).then(function(G){k||(k=!0,u.resolve(z,G))},function(G){k||(k=!0,u.reject(z,G))});var L;return z}},{immediate:36}],38:[function(i,s,a){var o={};(0,i("./lib/utils/common").assign)(o,i("./lib/deflate"),i("./lib/inflate"),i("./lib/zlib/constants")),s.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(i,s,a){var o=i("./zlib/deflate"),l=i("./utils/common"),u=i("./utils/strings"),h=i("./zlib/messages"),d=i("./zlib/zstream"),p=Object.prototype.toString,m=0,v=-1,b=0,A=8;function _(S){if(!(this instanceof _))return new _(S);this.options=l.assign({level:v,method:A,chunkSize:16384,windowBits:15,memLevel:8,strategy:b,to:""},S||{});var T=this.options;T.raw&&0<T.windowBits?T.windowBits=-T.windowBits:T.gzip&&0<T.windowBits&&T.windowBits<16&&(T.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var M=o.deflateInit2(this.strm,T.level,T.method,T.windowBits,T.memLevel,T.strategy);if(M!==m)throw new Error(h[M]);if(T.header&&o.deflateSetHeader(this.strm,T.header),T.dictionary){var k;if(k=typeof T.dictionary=="string"?u.string2buf(T.dictionary):p.call(T.dictionary)==="[object ArrayBuffer]"?new Uint8Array(T.dictionary):T.dictionary,(M=o.deflateSetDictionary(this.strm,k))!==m)throw new Error(h[M]);this._dict_set=!0}}function w(S,T){var M=new _(T);if(M.push(S,!0),M.err)throw M.msg||h[M.err];return M.result}_.prototype.push=function(S,T){var M,k,O=this.strm,z=this.options.chunkSize;if(this.ended)return!1;k=T===~~T?T:T===!0?4:0,typeof S=="string"?O.input=u.string2buf(S):p.call(S)==="[object ArrayBuffer]"?O.input=new Uint8Array(S):O.input=S,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new l.Buf8(z),O.next_out=0,O.avail_out=z),(M=o.deflate(O,k))!==1&&M!==m)return this.onEnd(M),!(this.ended=!0);O.avail_out!==0&&(O.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(l.shrinkBuf(O.output,O.next_out))):this.onData(l.shrinkBuf(O.output,O.next_out)))}while((0<O.avail_in||O.avail_out===0)&&M!==1);return k===4?(M=o.deflateEnd(this.strm),this.onEnd(M),this.ended=!0,M===m):k!==2||(this.onEnd(m),!(O.avail_out=0))},_.prototype.onData=function(S){this.chunks.push(S)},_.prototype.onEnd=function(S){S===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},a.Deflate=_,a.deflate=w,a.deflateRaw=function(S,T){return(T=T||{}).raw=!0,w(S,T)},a.gzip=function(S,T){return(T=T||{}).gzip=!0,w(S,T)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(i,s,a){var o=i("./zlib/inflate"),l=i("./utils/common"),u=i("./utils/strings"),h=i("./zlib/constants"),d=i("./zlib/messages"),p=i("./zlib/zstream"),m=i("./zlib/gzheader"),v=Object.prototype.toString;function b(_){if(!(this instanceof b))return new b(_);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},_||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||_&&_.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var S=o.inflateInit2(this.strm,w.windowBits);if(S!==h.Z_OK)throw new Error(d[S]);this.header=new m,o.inflateGetHeader(this.strm,this.header)}function A(_,w){var S=new b(w);if(S.push(_,!0),S.err)throw S.msg||d[S.err];return S.result}b.prototype.push=function(_,w){var S,T,M,k,O,z,L=this.strm,G=this.options.chunkSize,j=this.options.dictionary,Z=!1;if(this.ended)return!1;T=w===~~w?w:w===!0?h.Z_FINISH:h.Z_NO_FLUSH,typeof _=="string"?L.input=u.binstring2buf(_):v.call(_)==="[object ArrayBuffer]"?L.input=new Uint8Array(_):L.input=_,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new l.Buf8(G),L.next_out=0,L.avail_out=G),(S=o.inflate(L,h.Z_NO_FLUSH))===h.Z_NEED_DICT&&j&&(z=typeof j=="string"?u.string2buf(j):v.call(j)==="[object ArrayBuffer]"?new Uint8Array(j):j,S=o.inflateSetDictionary(this.strm,z)),S===h.Z_BUF_ERROR&&Z===!0&&(S=h.Z_OK,Z=!1),S!==h.Z_STREAM_END&&S!==h.Z_OK)return this.onEnd(S),!(this.ended=!0);L.next_out&&(L.avail_out!==0&&S!==h.Z_STREAM_END&&(L.avail_in!==0||T!==h.Z_FINISH&&T!==h.Z_SYNC_FLUSH)||(this.options.to==="string"?(M=u.utf8border(L.output,L.next_out),k=L.next_out-M,O=u.buf2string(L.output,M),L.next_out=k,L.avail_out=G-k,k&&l.arraySet(L.output,L.output,M,k,0),this.onData(O)):this.onData(l.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(Z=!0)}while((0<L.avail_in||L.avail_out===0)&&S!==h.Z_STREAM_END);return S===h.Z_STREAM_END&&(T=h.Z_FINISH),T===h.Z_FINISH?(S=o.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===h.Z_OK):T!==h.Z_SYNC_FLUSH||(this.onEnd(h.Z_OK),!(L.avail_out=0))},b.prototype.onData=function(_){this.chunks.push(_)},b.prototype.onEnd=function(_){_===h.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},a.Inflate=b,a.inflate=A,a.inflateRaw=function(_,w){return(w=w||{}).raw=!0,A(_,w)},a.ungzip=A},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(i,s,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(h){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var p=d.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var m in p)p.hasOwnProperty(m)&&(h[m]=p[m])}}return h},a.shrinkBuf=function(h,d){return h.length===d?h:h.subarray?h.subarray(0,d):(h.length=d,h)};var l={arraySet:function(h,d,p,m,v){if(d.subarray&&h.subarray)h.set(d.subarray(p,p+m),v);else for(var b=0;b<m;b++)h[v+b]=d[p+b]},flattenChunks:function(h){var d,p,m,v,b,A;for(d=m=0,p=h.length;d<p;d++)m+=h[d].length;for(A=new Uint8Array(m),d=v=0,p=h.length;d<p;d++)b=h[d],A.set(b,v),v+=b.length;return A}},u={arraySet:function(h,d,p,m,v){for(var b=0;b<m;b++)h[v+b]=d[p+b]},flattenChunks:function(h){return[].concat.apply([],h)}};a.setTyped=function(h){h?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,l)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,u))},a.setTyped(o)},{}],42:[function(i,s,a){var o=i("./common"),l=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var h=new o.Buf8(256),d=0;d<256;d++)h[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function p(m,v){if(v<65537&&(m.subarray&&u||!m.subarray&&l))return String.fromCharCode.apply(null,o.shrinkBuf(m,v));for(var b="",A=0;A<v;A++)b+=String.fromCharCode(m[A]);return b}h[254]=h[254]=1,a.string2buf=function(m){var v,b,A,_,w,S=m.length,T=0;for(_=0;_<S;_++)(64512&(b=m.charCodeAt(_)))==55296&&_+1<S&&(64512&(A=m.charCodeAt(_+1)))==56320&&(b=65536+(b-55296<<10)+(A-56320),_++),T+=b<128?1:b<2048?2:b<65536?3:4;for(v=new o.Buf8(T),_=w=0;w<T;_++)(64512&(b=m.charCodeAt(_)))==55296&&_+1<S&&(64512&(A=m.charCodeAt(_+1)))==56320&&(b=65536+(b-55296<<10)+(A-56320),_++),b<128?v[w++]=b:(b<2048?v[w++]=192|b>>>6:(b<65536?v[w++]=224|b>>>12:(v[w++]=240|b>>>18,v[w++]=128|b>>>12&63),v[w++]=128|b>>>6&63),v[w++]=128|63&b);return v},a.buf2binstring=function(m){return p(m,m.length)},a.binstring2buf=function(m){for(var v=new o.Buf8(m.length),b=0,A=v.length;b<A;b++)v[b]=m.charCodeAt(b);return v},a.buf2string=function(m,v){var b,A,_,w,S=v||m.length,T=new Array(2*S);for(b=A=0;b<S;)if((_=m[b++])<128)T[A++]=_;else if(4<(w=h[_]))T[A++]=65533,b+=w-1;else{for(_&=w===2?31:w===3?15:7;1<w&&b<S;)_=_<<6|63&m[b++],w--;1<w?T[A++]=65533:_<65536?T[A++]=_:(_-=65536,T[A++]=55296|_>>10&1023,T[A++]=56320|1023&_)}return p(T,A)},a.utf8border=function(m,v){var b;for((v=v||m.length)>m.length&&(v=m.length),b=v-1;0<=b&&(192&m[b])==128;)b--;return b<0||b===0?v:b+h[m[b]]>v?b:v}},{"./common":41}],43:[function(i,s,a){s.exports=function(o,l,u,h){for(var d=65535&o|0,p=o>>>16&65535|0,m=0;u!==0;){for(u-=m=2e3<u?2e3:u;p=p+(d=d+l[h++]|0)|0,--m;);d%=65521,p%=65521}return d|p<<16|0}},{}],44:[function(i,s,a){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(i,s,a){var o=(function(){for(var l,u=[],h=0;h<256;h++){l=h;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;u[h]=l}return u})();s.exports=function(l,u,h,d){var p=o,m=d+h;l^=-1;for(var v=d;v<m;v++)l=l>>>8^p[255&(l^u[v])];return-1^l}},{}],46:[function(i,s,a){var o,l=i("../utils/common"),u=i("./trees"),h=i("./adler32"),d=i("./crc32"),p=i("./messages"),m=0,v=4,b=0,A=-2,_=-1,w=4,S=2,T=8,M=9,k=286,O=30,z=19,L=2*k+1,G=15,j=3,Z=258,ot=Z+j+1,I=42,X=113,x=1,tt=2,U=3,H=4;function ct(C,rt){return C.msg=p[rt],rt}function st(C){return(C<<1)-(4<C?9:0)}function mt(C){for(var rt=C.length;0<=--rt;)C[rt]=0}function D(C){var rt=C.state,et=rt.pending;et>C.avail_out&&(et=C.avail_out),et!==0&&(l.arraySet(C.output,rt.pending_buf,rt.pending_out,et,C.next_out),C.next_out+=et,rt.pending_out+=et,C.total_out+=et,C.avail_out-=et,rt.pending-=et,rt.pending===0&&(rt.pending_out=0))}function B(C,rt){u._tr_flush_block(C,0<=C.block_start?C.block_start:-1,C.strstart-C.block_start,rt),C.block_start=C.strstart,D(C.strm)}function J(C,rt){C.pending_buf[C.pending++]=rt}function it(C,rt){C.pending_buf[C.pending++]=rt>>>8&255,C.pending_buf[C.pending++]=255&rt}function at(C,rt){var et,F,N=C.max_chain_length,V=C.strstart,dt=C.prev_length,ft=C.nice_match,W=C.strstart>C.w_size-ot?C.strstart-(C.w_size-ot):0,gt=C.window,bt=C.w_mask,yt=C.prev,Rt=C.strstart+Z,Jt=gt[V+dt-1],jt=gt[V+dt];C.prev_length>=C.good_match&&(N>>=2),ft>C.lookahead&&(ft=C.lookahead);do if(gt[(et=rt)+dt]===jt&&gt[et+dt-1]===Jt&&gt[et]===gt[V]&&gt[++et]===gt[V+1]){V+=2,et++;do;while(gt[++V]===gt[++et]&&gt[++V]===gt[++et]&&gt[++V]===gt[++et]&&gt[++V]===gt[++et]&&gt[++V]===gt[++et]&&gt[++V]===gt[++et]&&gt[++V]===gt[++et]&&gt[++V]===gt[++et]&&V<Rt);if(F=Z-(Rt-V),V=Rt-Z,dt<F){if(C.match_start=rt,ft<=(dt=F))break;Jt=gt[V+dt-1],jt=gt[V+dt]}}while((rt=yt[rt&bt])>W&&--N!=0);return dt<=C.lookahead?dt:C.lookahead}function At(C){var rt,et,F,N,V,dt,ft,W,gt,bt,yt=C.w_size;do{if(N=C.window_size-C.lookahead-C.strstart,C.strstart>=yt+(yt-ot)){for(l.arraySet(C.window,C.window,yt,yt,0),C.match_start-=yt,C.strstart-=yt,C.block_start-=yt,rt=et=C.hash_size;F=C.head[--rt],C.head[rt]=yt<=F?F-yt:0,--et;);for(rt=et=yt;F=C.prev[--rt],C.prev[rt]=yt<=F?F-yt:0,--et;);N+=yt}if(C.strm.avail_in===0)break;if(dt=C.strm,ft=C.window,W=C.strstart+C.lookahead,gt=N,bt=void 0,bt=dt.avail_in,gt<bt&&(bt=gt),et=bt===0?0:(dt.avail_in-=bt,l.arraySet(ft,dt.input,dt.next_in,bt,W),dt.state.wrap===1?dt.adler=h(dt.adler,ft,bt,W):dt.state.wrap===2&&(dt.adler=d(dt.adler,ft,bt,W)),dt.next_in+=bt,dt.total_in+=bt,bt),C.lookahead+=et,C.lookahead+C.insert>=j)for(V=C.strstart-C.insert,C.ins_h=C.window[V],C.ins_h=(C.ins_h<<C.hash_shift^C.window[V+1])&C.hash_mask;C.insert&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[V+j-1])&C.hash_mask,C.prev[V&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=V,V++,C.insert--,!(C.lookahead+C.insert<j)););}while(C.lookahead<ot&&C.strm.avail_in!==0)}function St(C,rt){for(var et,F;;){if(C.lookahead<ot){if(At(C),C.lookahead<ot&&rt===m)return x;if(C.lookahead===0)break}if(et=0,C.lookahead>=j&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+j-1])&C.hash_mask,et=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),et!==0&&C.strstart-et<=C.w_size-ot&&(C.match_length=at(C,et)),C.match_length>=j)if(F=u._tr_tally(C,C.strstart-C.match_start,C.match_length-j),C.lookahead-=C.match_length,C.match_length<=C.max_lazy_match&&C.lookahead>=j){for(C.match_length--;C.strstart++,C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+j-1])&C.hash_mask,et=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart,--C.match_length!=0;);C.strstart++}else C.strstart+=C.match_length,C.match_length=0,C.ins_h=C.window[C.strstart],C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+1])&C.hash_mask;else F=u._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++;if(F&&(B(C,!1),C.strm.avail_out===0))return x}return C.insert=C.strstart<j-1?C.strstart:j-1,rt===v?(B(C,!0),C.strm.avail_out===0?U:H):C.last_lit&&(B(C,!1),C.strm.avail_out===0)?x:tt}function Mt(C,rt){for(var et,F,N;;){if(C.lookahead<ot){if(At(C),C.lookahead<ot&&rt===m)return x;if(C.lookahead===0)break}if(et=0,C.lookahead>=j&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+j-1])&C.hash_mask,et=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),C.prev_length=C.match_length,C.prev_match=C.match_start,C.match_length=j-1,et!==0&&C.prev_length<C.max_lazy_match&&C.strstart-et<=C.w_size-ot&&(C.match_length=at(C,et),C.match_length<=5&&(C.strategy===1||C.match_length===j&&4096<C.strstart-C.match_start)&&(C.match_length=j-1)),C.prev_length>=j&&C.match_length<=C.prev_length){for(N=C.strstart+C.lookahead-j,F=u._tr_tally(C,C.strstart-1-C.prev_match,C.prev_length-j),C.lookahead-=C.prev_length-1,C.prev_length-=2;++C.strstart<=N&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+j-1])&C.hash_mask,et=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),--C.prev_length!=0;);if(C.match_available=0,C.match_length=j-1,C.strstart++,F&&(B(C,!1),C.strm.avail_out===0))return x}else if(C.match_available){if((F=u._tr_tally(C,0,C.window[C.strstart-1]))&&B(C,!1),C.strstart++,C.lookahead--,C.strm.avail_out===0)return x}else C.match_available=1,C.strstart++,C.lookahead--}return C.match_available&&(F=u._tr_tally(C,0,C.window[C.strstart-1]),C.match_available=0),C.insert=C.strstart<j-1?C.strstart:j-1,rt===v?(B(C,!0),C.strm.avail_out===0?U:H):C.last_lit&&(B(C,!1),C.strm.avail_out===0)?x:tt}function xt(C,rt,et,F,N){this.good_length=C,this.max_lazy=rt,this.nice_length=et,this.max_chain=F,this.func=N}function pt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*L),this.dyn_dtree=new l.Buf16(2*(2*O+1)),this.bl_tree=new l.Buf16(2*(2*z+1)),mt(this.dyn_ltree),mt(this.dyn_dtree),mt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(G+1),this.heap=new l.Buf16(2*k+1),mt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*k+1),mt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _t(C){var rt;return C&&C.state?(C.total_in=C.total_out=0,C.data_type=S,(rt=C.state).pending=0,rt.pending_out=0,rt.wrap<0&&(rt.wrap=-rt.wrap),rt.status=rt.wrap?I:X,C.adler=rt.wrap===2?0:1,rt.last_flush=m,u._tr_init(rt),b):ct(C,A)}function Ut(C){var rt=_t(C);return rt===b&&(function(et){et.window_size=2*et.w_size,mt(et.head),et.max_lazy_match=o[et.level].max_lazy,et.good_match=o[et.level].good_length,et.nice_match=o[et.level].nice_length,et.max_chain_length=o[et.level].max_chain,et.strstart=0,et.block_start=0,et.lookahead=0,et.insert=0,et.match_length=et.prev_length=j-1,et.match_available=0,et.ins_h=0})(C.state),rt}function Lt(C,rt,et,F,N,V){if(!C)return A;var dt=1;if(rt===_&&(rt=6),F<0?(dt=0,F=-F):15<F&&(dt=2,F-=16),N<1||M<N||et!==T||F<8||15<F||rt<0||9<rt||V<0||w<V)return ct(C,A);F===8&&(F=9);var ft=new pt;return(C.state=ft).strm=C,ft.wrap=dt,ft.gzhead=null,ft.w_bits=F,ft.w_size=1<<ft.w_bits,ft.w_mask=ft.w_size-1,ft.hash_bits=N+7,ft.hash_size=1<<ft.hash_bits,ft.hash_mask=ft.hash_size-1,ft.hash_shift=~~((ft.hash_bits+j-1)/j),ft.window=new l.Buf8(2*ft.w_size),ft.head=new l.Buf16(ft.hash_size),ft.prev=new l.Buf16(ft.w_size),ft.lit_bufsize=1<<N+6,ft.pending_buf_size=4*ft.lit_bufsize,ft.pending_buf=new l.Buf8(ft.pending_buf_size),ft.d_buf=1*ft.lit_bufsize,ft.l_buf=3*ft.lit_bufsize,ft.level=rt,ft.strategy=V,ft.method=et,Ut(C)}o=[new xt(0,0,0,0,function(C,rt){var et=65535;for(et>C.pending_buf_size-5&&(et=C.pending_buf_size-5);;){if(C.lookahead<=1){if(At(C),C.lookahead===0&&rt===m)return x;if(C.lookahead===0)break}C.strstart+=C.lookahead,C.lookahead=0;var F=C.block_start+et;if((C.strstart===0||C.strstart>=F)&&(C.lookahead=C.strstart-F,C.strstart=F,B(C,!1),C.strm.avail_out===0)||C.strstart-C.block_start>=C.w_size-ot&&(B(C,!1),C.strm.avail_out===0))return x}return C.insert=0,rt===v?(B(C,!0),C.strm.avail_out===0?U:H):(C.strstart>C.block_start&&(B(C,!1),C.strm.avail_out),x)}),new xt(4,4,8,4,St),new xt(4,5,16,8,St),new xt(4,6,32,32,St),new xt(4,4,16,16,Mt),new xt(8,16,32,32,Mt),new xt(8,16,128,128,Mt),new xt(8,32,128,256,Mt),new xt(32,128,258,1024,Mt),new xt(32,258,258,4096,Mt)],a.deflateInit=function(C,rt){return Lt(C,rt,T,15,8,0)},a.deflateInit2=Lt,a.deflateReset=Ut,a.deflateResetKeep=_t,a.deflateSetHeader=function(C,rt){return C&&C.state?C.state.wrap!==2?A:(C.state.gzhead=rt,b):A},a.deflate=function(C,rt){var et,F,N,V;if(!C||!C.state||5<rt||rt<0)return C?ct(C,A):A;if(F=C.state,!C.output||!C.input&&C.avail_in!==0||F.status===666&&rt!==v)return ct(C,C.avail_out===0?-5:A);if(F.strm=C,et=F.last_flush,F.last_flush=rt,F.status===I)if(F.wrap===2)C.adler=0,J(F,31),J(F,139),J(F,8),F.gzhead?(J(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),J(F,255&F.gzhead.time),J(F,F.gzhead.time>>8&255),J(F,F.gzhead.time>>16&255),J(F,F.gzhead.time>>24&255),J(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),J(F,255&F.gzhead.os),F.gzhead.extra&&F.gzhead.extra.length&&(J(F,255&F.gzhead.extra.length),J(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(C.adler=d(C.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=69):(J(F,0),J(F,0),J(F,0),J(F,0),J(F,0),J(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),J(F,3),F.status=X);else{var dt=T+(F.w_bits-8<<4)<<8;dt|=(2<=F.strategy||F.level<2?0:F.level<6?1:F.level===6?2:3)<<6,F.strstart!==0&&(dt|=32),dt+=31-dt%31,F.status=X,it(F,dt),F.strstart!==0&&(it(F,C.adler>>>16),it(F,65535&C.adler)),C.adler=1}if(F.status===69)if(F.gzhead.extra){for(N=F.pending;F.gzindex<(65535&F.gzhead.extra.length)&&(F.pending!==F.pending_buf_size||(F.gzhead.hcrc&&F.pending>N&&(C.adler=d(C.adler,F.pending_buf,F.pending-N,N)),D(C),N=F.pending,F.pending!==F.pending_buf_size));)J(F,255&F.gzhead.extra[F.gzindex]),F.gzindex++;F.gzhead.hcrc&&F.pending>N&&(C.adler=d(C.adler,F.pending_buf,F.pending-N,N)),F.gzindex===F.gzhead.extra.length&&(F.gzindex=0,F.status=73)}else F.status=73;if(F.status===73)if(F.gzhead.name){N=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>N&&(C.adler=d(C.adler,F.pending_buf,F.pending-N,N)),D(C),N=F.pending,F.pending===F.pending_buf_size)){V=1;break}V=F.gzindex<F.gzhead.name.length?255&F.gzhead.name.charCodeAt(F.gzindex++):0,J(F,V)}while(V!==0);F.gzhead.hcrc&&F.pending>N&&(C.adler=d(C.adler,F.pending_buf,F.pending-N,N)),V===0&&(F.gzindex=0,F.status=91)}else F.status=91;if(F.status===91)if(F.gzhead.comment){N=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>N&&(C.adler=d(C.adler,F.pending_buf,F.pending-N,N)),D(C),N=F.pending,F.pending===F.pending_buf_size)){V=1;break}V=F.gzindex<F.gzhead.comment.length?255&F.gzhead.comment.charCodeAt(F.gzindex++):0,J(F,V)}while(V!==0);F.gzhead.hcrc&&F.pending>N&&(C.adler=d(C.adler,F.pending_buf,F.pending-N,N)),V===0&&(F.status=103)}else F.status=103;if(F.status===103&&(F.gzhead.hcrc?(F.pending+2>F.pending_buf_size&&D(C),F.pending+2<=F.pending_buf_size&&(J(F,255&C.adler),J(F,C.adler>>8&255),C.adler=0,F.status=X)):F.status=X),F.pending!==0){if(D(C),C.avail_out===0)return F.last_flush=-1,b}else if(C.avail_in===0&&st(rt)<=st(et)&&rt!==v)return ct(C,-5);if(F.status===666&&C.avail_in!==0)return ct(C,-5);if(C.avail_in!==0||F.lookahead!==0||rt!==m&&F.status!==666){var ft=F.strategy===2?(function(W,gt){for(var bt;;){if(W.lookahead===0&&(At(W),W.lookahead===0)){if(gt===m)return x;break}if(W.match_length=0,bt=u._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++,bt&&(B(W,!1),W.strm.avail_out===0))return x}return W.insert=0,gt===v?(B(W,!0),W.strm.avail_out===0?U:H):W.last_lit&&(B(W,!1),W.strm.avail_out===0)?x:tt})(F,rt):F.strategy===3?(function(W,gt){for(var bt,yt,Rt,Jt,jt=W.window;;){if(W.lookahead<=Z){if(At(W),W.lookahead<=Z&&gt===m)return x;if(W.lookahead===0)break}if(W.match_length=0,W.lookahead>=j&&0<W.strstart&&(yt=jt[Rt=W.strstart-1])===jt[++Rt]&&yt===jt[++Rt]&&yt===jt[++Rt]){Jt=W.strstart+Z;do;while(yt===jt[++Rt]&&yt===jt[++Rt]&&yt===jt[++Rt]&&yt===jt[++Rt]&&yt===jt[++Rt]&&yt===jt[++Rt]&&yt===jt[++Rt]&&yt===jt[++Rt]&&Rt<Jt);W.match_length=Z-(Jt-Rt),W.match_length>W.lookahead&&(W.match_length=W.lookahead)}if(W.match_length>=j?(bt=u._tr_tally(W,1,W.match_length-j),W.lookahead-=W.match_length,W.strstart+=W.match_length,W.match_length=0):(bt=u._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++),bt&&(B(W,!1),W.strm.avail_out===0))return x}return W.insert=0,gt===v?(B(W,!0),W.strm.avail_out===0?U:H):W.last_lit&&(B(W,!1),W.strm.avail_out===0)?x:tt})(F,rt):o[F.level].func(F,rt);if(ft!==U&&ft!==H||(F.status=666),ft===x||ft===U)return C.avail_out===0&&(F.last_flush=-1),b;if(ft===tt&&(rt===1?u._tr_align(F):rt!==5&&(u._tr_stored_block(F,0,0,!1),rt===3&&(mt(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),D(C),C.avail_out===0))return F.last_flush=-1,b}return rt!==v?b:F.wrap<=0?1:(F.wrap===2?(J(F,255&C.adler),J(F,C.adler>>8&255),J(F,C.adler>>16&255),J(F,C.adler>>24&255),J(F,255&C.total_in),J(F,C.total_in>>8&255),J(F,C.total_in>>16&255),J(F,C.total_in>>24&255)):(it(F,C.adler>>>16),it(F,65535&C.adler)),D(C),0<F.wrap&&(F.wrap=-F.wrap),F.pending!==0?b:1)},a.deflateEnd=function(C){var rt;return C&&C.state?(rt=C.state.status)!==I&&rt!==69&&rt!==73&&rt!==91&&rt!==103&&rt!==X&&rt!==666?ct(C,A):(C.state=null,rt===X?ct(C,-3):b):A},a.deflateSetDictionary=function(C,rt){var et,F,N,V,dt,ft,W,gt,bt=rt.length;if(!C||!C.state||(V=(et=C.state).wrap)===2||V===1&&et.status!==I||et.lookahead)return A;for(V===1&&(C.adler=h(C.adler,rt,bt,0)),et.wrap=0,bt>=et.w_size&&(V===0&&(mt(et.head),et.strstart=0,et.block_start=0,et.insert=0),gt=new l.Buf8(et.w_size),l.arraySet(gt,rt,bt-et.w_size,et.w_size,0),rt=gt,bt=et.w_size),dt=C.avail_in,ft=C.next_in,W=C.input,C.avail_in=bt,C.next_in=0,C.input=rt,At(et);et.lookahead>=j;){for(F=et.strstart,N=et.lookahead-(j-1);et.ins_h=(et.ins_h<<et.hash_shift^et.window[F+j-1])&et.hash_mask,et.prev[F&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=F,F++,--N;);et.strstart=F,et.lookahead=j-1,At(et)}return et.strstart+=et.lookahead,et.block_start=et.strstart,et.insert=et.lookahead,et.lookahead=0,et.match_length=et.prev_length=j-1,et.match_available=0,C.next_in=ft,C.input=W,C.avail_in=dt,et.wrap=V,b},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(i,s,a){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(i,s,a){s.exports=function(o,l){var u,h,d,p,m,v,b,A,_,w,S,T,M,k,O,z,L,G,j,Z,ot,I,X,x,tt;u=o.state,h=o.next_in,x=o.input,d=h+(o.avail_in-5),p=o.next_out,tt=o.output,m=p-(l-o.avail_out),v=p+(o.avail_out-257),b=u.dmax,A=u.wsize,_=u.whave,w=u.wnext,S=u.window,T=u.hold,M=u.bits,k=u.lencode,O=u.distcode,z=(1<<u.lenbits)-1,L=(1<<u.distbits)-1;t:do{M<15&&(T+=x[h++]<<M,M+=8,T+=x[h++]<<M,M+=8),G=k[T&z];e:for(;;){if(T>>>=j=G>>>24,M-=j,(j=G>>>16&255)===0)tt[p++]=65535&G;else{if(!(16&j)){if((64&j)==0){G=k[(65535&G)+(T&(1<<j)-1)];continue e}if(32&j){u.mode=12;break t}o.msg="invalid literal/length code",u.mode=30;break t}Z=65535&G,(j&=15)&&(M<j&&(T+=x[h++]<<M,M+=8),Z+=T&(1<<j)-1,T>>>=j,M-=j),M<15&&(T+=x[h++]<<M,M+=8,T+=x[h++]<<M,M+=8),G=O[T&L];i:for(;;){if(T>>>=j=G>>>24,M-=j,!(16&(j=G>>>16&255))){if((64&j)==0){G=O[(65535&G)+(T&(1<<j)-1)];continue i}o.msg="invalid distance code",u.mode=30;break t}if(ot=65535&G,M<(j&=15)&&(T+=x[h++]<<M,(M+=8)<j&&(T+=x[h++]<<M,M+=8)),b<(ot+=T&(1<<j)-1)){o.msg="invalid distance too far back",u.mode=30;break t}if(T>>>=j,M-=j,(j=p-m)<ot){if(_<(j=ot-j)&&u.sane){o.msg="invalid distance too far back",u.mode=30;break t}if(X=S,(I=0)===w){if(I+=A-j,j<Z){for(Z-=j;tt[p++]=S[I++],--j;);I=p-ot,X=tt}}else if(w<j){if(I+=A+w-j,(j-=w)<Z){for(Z-=j;tt[p++]=S[I++],--j;);if(I=0,w<Z){for(Z-=j=w;tt[p++]=S[I++],--j;);I=p-ot,X=tt}}}else if(I+=w-j,j<Z){for(Z-=j;tt[p++]=S[I++],--j;);I=p-ot,X=tt}for(;2<Z;)tt[p++]=X[I++],tt[p++]=X[I++],tt[p++]=X[I++],Z-=3;Z&&(tt[p++]=X[I++],1<Z&&(tt[p++]=X[I++]))}else{for(I=p-ot;tt[p++]=tt[I++],tt[p++]=tt[I++],tt[p++]=tt[I++],2<(Z-=3););Z&&(tt[p++]=tt[I++],1<Z&&(tt[p++]=tt[I++]))}break}}break}}while(h<d&&p<v);h-=Z=M>>3,T&=(1<<(M-=Z<<3))-1,o.next_in=h,o.next_out=p,o.avail_in=h<d?d-h+5:5-(h-d),o.avail_out=p<v?v-p+257:257-(p-v),u.hold=T,u.bits=M}},{}],49:[function(i,s,a){var o=i("../utils/common"),l=i("./adler32"),u=i("./crc32"),h=i("./inffast"),d=i("./inftrees"),p=1,m=2,v=0,b=-2,A=1,_=852,w=592;function S(I){return(I>>>24&255)+(I>>>8&65280)+((65280&I)<<8)+((255&I)<<24)}function T(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function M(I){var X;return I&&I.state?(X=I.state,I.total_in=I.total_out=X.total=0,I.msg="",X.wrap&&(I.adler=1&X.wrap),X.mode=A,X.last=0,X.havedict=0,X.dmax=32768,X.head=null,X.hold=0,X.bits=0,X.lencode=X.lendyn=new o.Buf32(_),X.distcode=X.distdyn=new o.Buf32(w),X.sane=1,X.back=-1,v):b}function k(I){var X;return I&&I.state?((X=I.state).wsize=0,X.whave=0,X.wnext=0,M(I)):b}function O(I,X){var x,tt;return I&&I.state?(tt=I.state,X<0?(x=0,X=-X):(x=1+(X>>4),X<48&&(X&=15)),X&&(X<8||15<X)?b:(tt.window!==null&&tt.wbits!==X&&(tt.window=null),tt.wrap=x,tt.wbits=X,k(I))):b}function z(I,X){var x,tt;return I?(tt=new T,(I.state=tt).window=null,(x=O(I,X))!==v&&(I.state=null),x):b}var L,G,j=!0;function Z(I){if(j){var X;for(L=new o.Buf32(512),G=new o.Buf32(32),X=0;X<144;)I.lens[X++]=8;for(;X<256;)I.lens[X++]=9;for(;X<280;)I.lens[X++]=7;for(;X<288;)I.lens[X++]=8;for(d(p,I.lens,0,288,L,0,I.work,{bits:9}),X=0;X<32;)I.lens[X++]=5;d(m,I.lens,0,32,G,0,I.work,{bits:5}),j=!1}I.lencode=L,I.lenbits=9,I.distcode=G,I.distbits=5}function ot(I,X,x,tt){var U,H=I.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new o.Buf8(H.wsize)),tt>=H.wsize?(o.arraySet(H.window,X,x-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(tt<(U=H.wsize-H.wnext)&&(U=tt),o.arraySet(H.window,X,x-tt,U,H.wnext),(tt-=U)?(o.arraySet(H.window,X,x-tt,tt,0),H.wnext=tt,H.whave=H.wsize):(H.wnext+=U,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=U))),0}a.inflateReset=k,a.inflateReset2=O,a.inflateResetKeep=M,a.inflateInit=function(I){return z(I,15)},a.inflateInit2=z,a.inflate=function(I,X){var x,tt,U,H,ct,st,mt,D,B,J,it,at,At,St,Mt,xt,pt,_t,Ut,Lt,C,rt,et,F,N=0,V=new o.Buf8(4),dt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!I||!I.state||!I.output||!I.input&&I.avail_in!==0)return b;(x=I.state).mode===12&&(x.mode=13),ct=I.next_out,U=I.output,mt=I.avail_out,H=I.next_in,tt=I.input,st=I.avail_in,D=x.hold,B=x.bits,J=st,it=mt,rt=v;t:for(;;)switch(x.mode){case A:if(x.wrap===0){x.mode=13;break}for(;B<16;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if(2&x.wrap&&D===35615){V[x.check=0]=255&D,V[1]=D>>>8&255,x.check=u(x.check,V,2,0),B=D=0,x.mode=2;break}if(x.flags=0,x.head&&(x.head.done=!1),!(1&x.wrap)||(((255&D)<<8)+(D>>8))%31){I.msg="incorrect header check",x.mode=30;break}if((15&D)!=8){I.msg="unknown compression method",x.mode=30;break}if(B-=4,C=8+(15&(D>>>=4)),x.wbits===0)x.wbits=C;else if(C>x.wbits){I.msg="invalid window size",x.mode=30;break}x.dmax=1<<C,I.adler=x.check=1,x.mode=512&D?10:12,B=D=0;break;case 2:for(;B<16;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if(x.flags=D,(255&x.flags)!=8){I.msg="unknown compression method",x.mode=30;break}if(57344&x.flags){I.msg="unknown header flags set",x.mode=30;break}x.head&&(x.head.text=D>>8&1),512&x.flags&&(V[0]=255&D,V[1]=D>>>8&255,x.check=u(x.check,V,2,0)),B=D=0,x.mode=3;case 3:for(;B<32;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}x.head&&(x.head.time=D),512&x.flags&&(V[0]=255&D,V[1]=D>>>8&255,V[2]=D>>>16&255,V[3]=D>>>24&255,x.check=u(x.check,V,4,0)),B=D=0,x.mode=4;case 4:for(;B<16;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}x.head&&(x.head.xflags=255&D,x.head.os=D>>8),512&x.flags&&(V[0]=255&D,V[1]=D>>>8&255,x.check=u(x.check,V,2,0)),B=D=0,x.mode=5;case 5:if(1024&x.flags){for(;B<16;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}x.length=D,x.head&&(x.head.extra_len=D),512&x.flags&&(V[0]=255&D,V[1]=D>>>8&255,x.check=u(x.check,V,2,0)),B=D=0}else x.head&&(x.head.extra=null);x.mode=6;case 6:if(1024&x.flags&&(st<(at=x.length)&&(at=st),at&&(x.head&&(C=x.head.extra_len-x.length,x.head.extra||(x.head.extra=new Array(x.head.extra_len)),o.arraySet(x.head.extra,tt,H,at,C)),512&x.flags&&(x.check=u(x.check,tt,at,H)),st-=at,H+=at,x.length-=at),x.length))break t;x.length=0,x.mode=7;case 7:if(2048&x.flags){if(st===0)break t;for(at=0;C=tt[H+at++],x.head&&C&&x.length<65536&&(x.head.name+=String.fromCharCode(C)),C&&at<st;);if(512&x.flags&&(x.check=u(x.check,tt,at,H)),st-=at,H+=at,C)break t}else x.head&&(x.head.name=null);x.length=0,x.mode=8;case 8:if(4096&x.flags){if(st===0)break t;for(at=0;C=tt[H+at++],x.head&&C&&x.length<65536&&(x.head.comment+=String.fromCharCode(C)),C&&at<st;);if(512&x.flags&&(x.check=u(x.check,tt,at,H)),st-=at,H+=at,C)break t}else x.head&&(x.head.comment=null);x.mode=9;case 9:if(512&x.flags){for(;B<16;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if(D!==(65535&x.check)){I.msg="header crc mismatch",x.mode=30;break}B=D=0}x.head&&(x.head.hcrc=x.flags>>9&1,x.head.done=!0),I.adler=x.check=0,x.mode=12;break;case 10:for(;B<32;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}I.adler=x.check=S(D),B=D=0,x.mode=11;case 11:if(x.havedict===0)return I.next_out=ct,I.avail_out=mt,I.next_in=H,I.avail_in=st,x.hold=D,x.bits=B,2;I.adler=x.check=1,x.mode=12;case 12:if(X===5||X===6)break t;case 13:if(x.last){D>>>=7&B,B-=7&B,x.mode=27;break}for(;B<3;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}switch(x.last=1&D,B-=1,3&(D>>>=1)){case 0:x.mode=14;break;case 1:if(Z(x),x.mode=20,X!==6)break;D>>>=2,B-=2;break t;case 2:x.mode=17;break;case 3:I.msg="invalid block type",x.mode=30}D>>>=2,B-=2;break;case 14:for(D>>>=7&B,B-=7&B;B<32;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if((65535&D)!=(D>>>16^65535)){I.msg="invalid stored block lengths",x.mode=30;break}if(x.length=65535&D,B=D=0,x.mode=15,X===6)break t;case 15:x.mode=16;case 16:if(at=x.length){if(st<at&&(at=st),mt<at&&(at=mt),at===0)break t;o.arraySet(U,tt,H,at,ct),st-=at,H+=at,mt-=at,ct+=at,x.length-=at;break}x.mode=12;break;case 17:for(;B<14;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if(x.nlen=257+(31&D),D>>>=5,B-=5,x.ndist=1+(31&D),D>>>=5,B-=5,x.ncode=4+(15&D),D>>>=4,B-=4,286<x.nlen||30<x.ndist){I.msg="too many length or distance symbols",x.mode=30;break}x.have=0,x.mode=18;case 18:for(;x.have<x.ncode;){for(;B<3;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}x.lens[dt[x.have++]]=7&D,D>>>=3,B-=3}for(;x.have<19;)x.lens[dt[x.have++]]=0;if(x.lencode=x.lendyn,x.lenbits=7,et={bits:x.lenbits},rt=d(0,x.lens,0,19,x.lencode,0,x.work,et),x.lenbits=et.bits,rt){I.msg="invalid code lengths set",x.mode=30;break}x.have=0,x.mode=19;case 19:for(;x.have<x.nlen+x.ndist;){for(;xt=(N=x.lencode[D&(1<<x.lenbits)-1])>>>16&255,pt=65535&N,!((Mt=N>>>24)<=B);){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if(pt<16)D>>>=Mt,B-=Mt,x.lens[x.have++]=pt;else{if(pt===16){for(F=Mt+2;B<F;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if(D>>>=Mt,B-=Mt,x.have===0){I.msg="invalid bit length repeat",x.mode=30;break}C=x.lens[x.have-1],at=3+(3&D),D>>>=2,B-=2}else if(pt===17){for(F=Mt+3;B<F;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}B-=Mt,C=0,at=3+(7&(D>>>=Mt)),D>>>=3,B-=3}else{for(F=Mt+7;B<F;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}B-=Mt,C=0,at=11+(127&(D>>>=Mt)),D>>>=7,B-=7}if(x.have+at>x.nlen+x.ndist){I.msg="invalid bit length repeat",x.mode=30;break}for(;at--;)x.lens[x.have++]=C}}if(x.mode===30)break;if(x.lens[256]===0){I.msg="invalid code -- missing end-of-block",x.mode=30;break}if(x.lenbits=9,et={bits:x.lenbits},rt=d(p,x.lens,0,x.nlen,x.lencode,0,x.work,et),x.lenbits=et.bits,rt){I.msg="invalid literal/lengths set",x.mode=30;break}if(x.distbits=6,x.distcode=x.distdyn,et={bits:x.distbits},rt=d(m,x.lens,x.nlen,x.ndist,x.distcode,0,x.work,et),x.distbits=et.bits,rt){I.msg="invalid distances set",x.mode=30;break}if(x.mode=20,X===6)break t;case 20:x.mode=21;case 21:if(6<=st&&258<=mt){I.next_out=ct,I.avail_out=mt,I.next_in=H,I.avail_in=st,x.hold=D,x.bits=B,h(I,it),ct=I.next_out,U=I.output,mt=I.avail_out,H=I.next_in,tt=I.input,st=I.avail_in,D=x.hold,B=x.bits,x.mode===12&&(x.back=-1);break}for(x.back=0;xt=(N=x.lencode[D&(1<<x.lenbits)-1])>>>16&255,pt=65535&N,!((Mt=N>>>24)<=B);){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if(xt&&(240&xt)==0){for(_t=Mt,Ut=xt,Lt=pt;xt=(N=x.lencode[Lt+((D&(1<<_t+Ut)-1)>>_t)])>>>16&255,pt=65535&N,!(_t+(Mt=N>>>24)<=B);){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}D>>>=_t,B-=_t,x.back+=_t}if(D>>>=Mt,B-=Mt,x.back+=Mt,x.length=pt,xt===0){x.mode=26;break}if(32&xt){x.back=-1,x.mode=12;break}if(64&xt){I.msg="invalid literal/length code",x.mode=30;break}x.extra=15&xt,x.mode=22;case 22:if(x.extra){for(F=x.extra;B<F;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}x.length+=D&(1<<x.extra)-1,D>>>=x.extra,B-=x.extra,x.back+=x.extra}x.was=x.length,x.mode=23;case 23:for(;xt=(N=x.distcode[D&(1<<x.distbits)-1])>>>16&255,pt=65535&N,!((Mt=N>>>24)<=B);){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if((240&xt)==0){for(_t=Mt,Ut=xt,Lt=pt;xt=(N=x.distcode[Lt+((D&(1<<_t+Ut)-1)>>_t)])>>>16&255,pt=65535&N,!(_t+(Mt=N>>>24)<=B);){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}D>>>=_t,B-=_t,x.back+=_t}if(D>>>=Mt,B-=Mt,x.back+=Mt,64&xt){I.msg="invalid distance code",x.mode=30;break}x.offset=pt,x.extra=15&xt,x.mode=24;case 24:if(x.extra){for(F=x.extra;B<F;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}x.offset+=D&(1<<x.extra)-1,D>>>=x.extra,B-=x.extra,x.back+=x.extra}if(x.offset>x.dmax){I.msg="invalid distance too far back",x.mode=30;break}x.mode=25;case 25:if(mt===0)break t;if(at=it-mt,x.offset>at){if((at=x.offset-at)>x.whave&&x.sane){I.msg="invalid distance too far back",x.mode=30;break}At=at>x.wnext?(at-=x.wnext,x.wsize-at):x.wnext-at,at>x.length&&(at=x.length),St=x.window}else St=U,At=ct-x.offset,at=x.length;for(mt<at&&(at=mt),mt-=at,x.length-=at;U[ct++]=St[At++],--at;);x.length===0&&(x.mode=21);break;case 26:if(mt===0)break t;U[ct++]=x.length,mt--,x.mode=21;break;case 27:if(x.wrap){for(;B<32;){if(st===0)break t;st--,D|=tt[H++]<<B,B+=8}if(it-=mt,I.total_out+=it,x.total+=it,it&&(I.adler=x.check=x.flags?u(x.check,U,it,ct-it):l(x.check,U,it,ct-it)),it=mt,(x.flags?D:S(D))!==x.check){I.msg="incorrect data check",x.mode=30;break}B=D=0}x.mode=28;case 28:if(x.wrap&&x.flags){for(;B<32;){if(st===0)break t;st--,D+=tt[H++]<<B,B+=8}if(D!==(4294967295&x.total)){I.msg="incorrect length check",x.mode=30;break}B=D=0}x.mode=29;case 29:rt=1;break t;case 30:rt=-3;break t;case 31:return-4;case 32:default:return b}return I.next_out=ct,I.avail_out=mt,I.next_in=H,I.avail_in=st,x.hold=D,x.bits=B,(x.wsize||it!==I.avail_out&&x.mode<30&&(x.mode<27||X!==4))&&ot(I,I.output,I.next_out,it-I.avail_out)?(x.mode=31,-4):(J-=I.avail_in,it-=I.avail_out,I.total_in+=J,I.total_out+=it,x.total+=it,x.wrap&&it&&(I.adler=x.check=x.flags?u(x.check,U,it,I.next_out-it):l(x.check,U,it,I.next_out-it)),I.data_type=x.bits+(x.last?64:0)+(x.mode===12?128:0)+(x.mode===20||x.mode===15?256:0),(J==0&&it===0||X===4)&&rt===v&&(rt=-5),rt)},a.inflateEnd=function(I){if(!I||!I.state)return b;var X=I.state;return X.window&&(X.window=null),I.state=null,v},a.inflateGetHeader=function(I,X){var x;return I&&I.state?(2&(x=I.state).wrap)==0?b:((x.head=X).done=!1,v):b},a.inflateSetDictionary=function(I,X){var x,tt=X.length;return I&&I.state?(x=I.state).wrap!==0&&x.mode!==11?b:x.mode===11&&l(1,X,tt,0)!==x.check?-3:ot(I,X,tt,tt)?(x.mode=31,-4):(x.havedict=1,v):b},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(i,s,a){var o=i("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(p,m,v,b,A,_,w,S){var T,M,k,O,z,L,G,j,Z,ot=S.bits,I=0,X=0,x=0,tt=0,U=0,H=0,ct=0,st=0,mt=0,D=0,B=null,J=0,it=new o.Buf16(16),at=new o.Buf16(16),At=null,St=0;for(I=0;I<=15;I++)it[I]=0;for(X=0;X<b;X++)it[m[v+X]]++;for(U=ot,tt=15;1<=tt&&it[tt]===0;tt--);if(tt<U&&(U=tt),tt===0)return A[_++]=20971520,A[_++]=20971520,S.bits=1,0;for(x=1;x<tt&&it[x]===0;x++);for(U<x&&(U=x),I=st=1;I<=15;I++)if(st<<=1,(st-=it[I])<0)return-1;if(0<st&&(p===0||tt!==1))return-1;for(at[1]=0,I=1;I<15;I++)at[I+1]=at[I]+it[I];for(X=0;X<b;X++)m[v+X]!==0&&(w[at[m[v+X]]++]=X);if(L=p===0?(B=At=w,19):p===1?(B=l,J-=257,At=u,St-=257,256):(B=h,At=d,-1),I=x,z=_,ct=X=D=0,k=-1,O=(mt=1<<(H=U))-1,p===1&&852<mt||p===2&&592<mt)return 1;for(;;){for(G=I-ct,Z=w[X]<L?(j=0,w[X]):w[X]>L?(j=At[St+w[X]],B[J+w[X]]):(j=96,0),T=1<<I-ct,x=M=1<<H;A[z+(D>>ct)+(M-=T)]=G<<24|j<<16|Z|0,M!==0;);for(T=1<<I-1;D&T;)T>>=1;if(T!==0?(D&=T-1,D+=T):D=0,X++,--it[I]==0){if(I===tt)break;I=m[v+w[X]]}if(U<I&&(D&O)!==k){for(ct===0&&(ct=U),z+=x,st=1<<(H=I-ct);H+ct<tt&&!((st-=it[H+ct])<=0);)H++,st<<=1;if(mt+=1<<H,p===1&&852<mt||p===2&&592<mt)return 1;A[k=D&O]=U<<24|H<<16|z-_|0}}return D!==0&&(A[z+D]=I-ct<<24|64<<16|0),S.bits=U,0}},{"../utils/common":41}],51:[function(i,s,a){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(i,s,a){var o=i("../utils/common"),l=0,u=1;function h(N){for(var V=N.length;0<=--V;)N[V]=0}var d=0,p=29,m=256,v=m+1+p,b=30,A=19,_=2*v+1,w=15,S=16,T=7,M=256,k=16,O=17,z=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],G=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ot=new Array(2*(v+2));h(ot);var I=new Array(2*b);h(I);var X=new Array(512);h(X);var x=new Array(256);h(x);var tt=new Array(p);h(tt);var U,H,ct,st=new Array(b);function mt(N,V,dt,ft,W){this.static_tree=N,this.extra_bits=V,this.extra_base=dt,this.elems=ft,this.max_length=W,this.has_stree=N&&N.length}function D(N,V){this.dyn_tree=N,this.max_code=0,this.stat_desc=V}function B(N){return N<256?X[N]:X[256+(N>>>7)]}function J(N,V){N.pending_buf[N.pending++]=255&V,N.pending_buf[N.pending++]=V>>>8&255}function it(N,V,dt){N.bi_valid>S-dt?(N.bi_buf|=V<<N.bi_valid&65535,J(N,N.bi_buf),N.bi_buf=V>>S-N.bi_valid,N.bi_valid+=dt-S):(N.bi_buf|=V<<N.bi_valid&65535,N.bi_valid+=dt)}function at(N,V,dt){it(N,dt[2*V],dt[2*V+1])}function At(N,V){for(var dt=0;dt|=1&N,N>>>=1,dt<<=1,0<--V;);return dt>>>1}function St(N,V,dt){var ft,W,gt=new Array(w+1),bt=0;for(ft=1;ft<=w;ft++)gt[ft]=bt=bt+dt[ft-1]<<1;for(W=0;W<=V;W++){var yt=N[2*W+1];yt!==0&&(N[2*W]=At(gt[yt]++,yt))}}function Mt(N){var V;for(V=0;V<v;V++)N.dyn_ltree[2*V]=0;for(V=0;V<b;V++)N.dyn_dtree[2*V]=0;for(V=0;V<A;V++)N.bl_tree[2*V]=0;N.dyn_ltree[2*M]=1,N.opt_len=N.static_len=0,N.last_lit=N.matches=0}function xt(N){8<N.bi_valid?J(N,N.bi_buf):0<N.bi_valid&&(N.pending_buf[N.pending++]=N.bi_buf),N.bi_buf=0,N.bi_valid=0}function pt(N,V,dt,ft){var W=2*V,gt=2*dt;return N[W]<N[gt]||N[W]===N[gt]&&ft[V]<=ft[dt]}function _t(N,V,dt){for(var ft=N.heap[dt],W=dt<<1;W<=N.heap_len&&(W<N.heap_len&&pt(V,N.heap[W+1],N.heap[W],N.depth)&&W++,!pt(V,ft,N.heap[W],N.depth));)N.heap[dt]=N.heap[W],dt=W,W<<=1;N.heap[dt]=ft}function Ut(N,V,dt){var ft,W,gt,bt,yt=0;if(N.last_lit!==0)for(;ft=N.pending_buf[N.d_buf+2*yt]<<8|N.pending_buf[N.d_buf+2*yt+1],W=N.pending_buf[N.l_buf+yt],yt++,ft===0?at(N,W,V):(at(N,(gt=x[W])+m+1,V),(bt=L[gt])!==0&&it(N,W-=tt[gt],bt),at(N,gt=B(--ft),dt),(bt=G[gt])!==0&&it(N,ft-=st[gt],bt)),yt<N.last_lit;);at(N,M,V)}function Lt(N,V){var dt,ft,W,gt=V.dyn_tree,bt=V.stat_desc.static_tree,yt=V.stat_desc.has_stree,Rt=V.stat_desc.elems,Jt=-1;for(N.heap_len=0,N.heap_max=_,dt=0;dt<Rt;dt++)gt[2*dt]!==0?(N.heap[++N.heap_len]=Jt=dt,N.depth[dt]=0):gt[2*dt+1]=0;for(;N.heap_len<2;)gt[2*(W=N.heap[++N.heap_len]=Jt<2?++Jt:0)]=1,N.depth[W]=0,N.opt_len--,yt&&(N.static_len-=bt[2*W+1]);for(V.max_code=Jt,dt=N.heap_len>>1;1<=dt;dt--)_t(N,gt,dt);for(W=Rt;dt=N.heap[1],N.heap[1]=N.heap[N.heap_len--],_t(N,gt,1),ft=N.heap[1],N.heap[--N.heap_max]=dt,N.heap[--N.heap_max]=ft,gt[2*W]=gt[2*dt]+gt[2*ft],N.depth[W]=(N.depth[dt]>=N.depth[ft]?N.depth[dt]:N.depth[ft])+1,gt[2*dt+1]=gt[2*ft+1]=W,N.heap[1]=W++,_t(N,gt,1),2<=N.heap_len;);N.heap[--N.heap_max]=N.heap[1],(function(jt,We){var bn,yi,Kn,re,Oe,bi,pe=We.dyn_tree,Fr=We.max_code,xl=We.stat_desc.static_tree,Ml=We.stat_desc.has_stree,ws=We.stat_desc.extra_bits,Zn=We.stat_desc.extra_base,Fi=We.stat_desc.max_length,vi=0;for(re=0;re<=w;re++)jt.bl_count[re]=0;for(pe[2*jt.heap[jt.heap_max]+1]=0,bn=jt.heap_max+1;bn<_;bn++)Fi<(re=pe[2*pe[2*(yi=jt.heap[bn])+1]+1]+1)&&(re=Fi,vi++),pe[2*yi+1]=re,Fr<yi||(jt.bl_count[re]++,Oe=0,Zn<=yi&&(Oe=ws[yi-Zn]),bi=pe[2*yi],jt.opt_len+=bi*(re+Oe),Ml&&(jt.static_len+=bi*(xl[2*yi+1]+Oe)));if(vi!==0){do{for(re=Fi-1;jt.bl_count[re]===0;)re--;jt.bl_count[re]--,jt.bl_count[re+1]+=2,jt.bl_count[Fi]--,vi-=2}while(0<vi);for(re=Fi;re!==0;re--)for(yi=jt.bl_count[re];yi!==0;)Fr<(Kn=jt.heap[--bn])||(pe[2*Kn+1]!==re&&(jt.opt_len+=(re-pe[2*Kn+1])*pe[2*Kn],pe[2*Kn+1]=re),yi--)}})(N,V),St(gt,Jt,N.bl_count)}function C(N,V,dt){var ft,W,gt=-1,bt=V[1],yt=0,Rt=7,Jt=4;for(bt===0&&(Rt=138,Jt=3),V[2*(dt+1)+1]=65535,ft=0;ft<=dt;ft++)W=bt,bt=V[2*(ft+1)+1],++yt<Rt&&W===bt||(yt<Jt?N.bl_tree[2*W]+=yt:W!==0?(W!==gt&&N.bl_tree[2*W]++,N.bl_tree[2*k]++):yt<=10?N.bl_tree[2*O]++:N.bl_tree[2*z]++,gt=W,Jt=(yt=0)===bt?(Rt=138,3):W===bt?(Rt=6,3):(Rt=7,4))}function rt(N,V,dt){var ft,W,gt=-1,bt=V[1],yt=0,Rt=7,Jt=4;for(bt===0&&(Rt=138,Jt=3),ft=0;ft<=dt;ft++)if(W=bt,bt=V[2*(ft+1)+1],!(++yt<Rt&&W===bt)){if(yt<Jt)for(;at(N,W,N.bl_tree),--yt!=0;);else W!==0?(W!==gt&&(at(N,W,N.bl_tree),yt--),at(N,k,N.bl_tree),it(N,yt-3,2)):yt<=10?(at(N,O,N.bl_tree),it(N,yt-3,3)):(at(N,z,N.bl_tree),it(N,yt-11,7));gt=W,Jt=(yt=0)===bt?(Rt=138,3):W===bt?(Rt=6,3):(Rt=7,4)}}h(st);var et=!1;function F(N,V,dt,ft){it(N,(d<<1)+(ft?1:0),3),(function(W,gt,bt,yt){xt(W),J(W,bt),J(W,~bt),o.arraySet(W.pending_buf,W.window,gt,bt,W.pending),W.pending+=bt})(N,V,dt)}a._tr_init=function(N){et||((function(){var V,dt,ft,W,gt,bt=new Array(w+1);for(W=ft=0;W<p-1;W++)for(tt[W]=ft,V=0;V<1<<L[W];V++)x[ft++]=W;for(x[ft-1]=W,W=gt=0;W<16;W++)for(st[W]=gt,V=0;V<1<<G[W];V++)X[gt++]=W;for(gt>>=7;W<b;W++)for(st[W]=gt<<7,V=0;V<1<<G[W]-7;V++)X[256+gt++]=W;for(dt=0;dt<=w;dt++)bt[dt]=0;for(V=0;V<=143;)ot[2*V+1]=8,V++,bt[8]++;for(;V<=255;)ot[2*V+1]=9,V++,bt[9]++;for(;V<=279;)ot[2*V+1]=7,V++,bt[7]++;for(;V<=287;)ot[2*V+1]=8,V++,bt[8]++;for(St(ot,v+1,bt),V=0;V<b;V++)I[2*V+1]=5,I[2*V]=At(V,5);U=new mt(ot,L,m+1,v,w),H=new mt(I,G,0,b,w),ct=new mt(new Array(0),j,0,A,T)})(),et=!0),N.l_desc=new D(N.dyn_ltree,U),N.d_desc=new D(N.dyn_dtree,H),N.bl_desc=new D(N.bl_tree,ct),N.bi_buf=0,N.bi_valid=0,Mt(N)},a._tr_stored_block=F,a._tr_flush_block=function(N,V,dt,ft){var W,gt,bt=0;0<N.level?(N.strm.data_type===2&&(N.strm.data_type=(function(yt){var Rt,Jt=4093624447;for(Rt=0;Rt<=31;Rt++,Jt>>>=1)if(1&Jt&&yt.dyn_ltree[2*Rt]!==0)return l;if(yt.dyn_ltree[18]!==0||yt.dyn_ltree[20]!==0||yt.dyn_ltree[26]!==0)return u;for(Rt=32;Rt<m;Rt++)if(yt.dyn_ltree[2*Rt]!==0)return u;return l})(N)),Lt(N,N.l_desc),Lt(N,N.d_desc),bt=(function(yt){var Rt;for(C(yt,yt.dyn_ltree,yt.l_desc.max_code),C(yt,yt.dyn_dtree,yt.d_desc.max_code),Lt(yt,yt.bl_desc),Rt=A-1;3<=Rt&&yt.bl_tree[2*Z[Rt]+1]===0;Rt--);return yt.opt_len+=3*(Rt+1)+5+5+4,Rt})(N),W=N.opt_len+3+7>>>3,(gt=N.static_len+3+7>>>3)<=W&&(W=gt)):W=gt=dt+5,dt+4<=W&&V!==-1?F(N,V,dt,ft):N.strategy===4||gt===W?(it(N,2+(ft?1:0),3),Ut(N,ot,I)):(it(N,4+(ft?1:0),3),(function(yt,Rt,Jt,jt){var We;for(it(yt,Rt-257,5),it(yt,Jt-1,5),it(yt,jt-4,4),We=0;We<jt;We++)it(yt,yt.bl_tree[2*Z[We]+1],3);rt(yt,yt.dyn_ltree,Rt-1),rt(yt,yt.dyn_dtree,Jt-1)})(N,N.l_desc.max_code+1,N.d_desc.max_code+1,bt+1),Ut(N,N.dyn_ltree,N.dyn_dtree)),Mt(N),ft&&xt(N)},a._tr_tally=function(N,V,dt){return N.pending_buf[N.d_buf+2*N.last_lit]=V>>>8&255,N.pending_buf[N.d_buf+2*N.last_lit+1]=255&V,N.pending_buf[N.l_buf+N.last_lit]=255&dt,N.last_lit++,V===0?N.dyn_ltree[2*dt]++:(N.matches++,V--,N.dyn_ltree[2*(x[dt]+m+1)]++,N.dyn_dtree[2*B(V)]++),N.last_lit===N.lit_bufsize-1},a._tr_align=function(N){it(N,2,3),at(N,M,ot),(function(V){V.bi_valid===16?(J(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):8<=V.bi_valid&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)})(N)}},{"../utils/common":41}],53:[function(i,s,a){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(i,s,a){(function(o){(function(l,u){if(!l.setImmediate){var h,d,p,m,v=1,b={},A=!1,_=l.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(l);w=w&&w.setTimeout?w:l,h={}.toString.call(l.process)==="[object process]"?function(k){process.nextTick(function(){T(k)})}:(function(){if(l.postMessage&&!l.importScripts){var k=!0,O=l.onmessage;return l.onmessage=function(){k=!1},l.postMessage("","*"),l.onmessage=O,k}})()?(m="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",M,!1):l.attachEvent("onmessage",M),function(k){l.postMessage(m+k,"*")}):l.MessageChannel?((p=new MessageChannel).port1.onmessage=function(k){T(k.data)},function(k){p.port2.postMessage(k)}):_&&"onreadystatechange"in _.createElement("script")?(d=_.documentElement,function(k){var O=_.createElement("script");O.onreadystatechange=function(){T(k),O.onreadystatechange=null,d.removeChild(O),O=null},d.appendChild(O)}):function(k){setTimeout(T,0,k)},w.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var O=new Array(arguments.length-1),z=0;z<O.length;z++)O[z]=arguments[z+1];var L={callback:k,args:O};return b[v]=L,h(v),v++},w.clearImmediate=S}function S(k){delete b[k]}function T(k){if(A)setTimeout(T,0,k);else{var O=b[k];if(O){A=!0;try{(function(z){var L=z.callback,G=z.args;switch(G.length){case 0:L();break;case 1:L(G[0]);break;case 2:L(G[0],G[1]);break;case 3:L(G[0],G[1],G[2]);break;default:L.apply(u,G)}})(O)}finally{S(k),A=!1}}}}function M(k){k.source===l&&typeof k.data=="string"&&k.data.indexOf(m)===0&&T(+k.data.slice(m.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Jo<"u"?Jo:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ih)),ih.exports}var y1=m1();const b1=kb(y1);ba.workerSrc=new URL("/ai-slide-generater/assets/pdf.worker.min-qwK7q_zL.mjs",import.meta.url).toString();const v1=()=>vt.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-400 hover:text-white transition-colors",children:[vt.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),vt.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),_1=()=>vt.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-400",children:[vt.jsx("path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"}),vt.jsx("path",{d:"M12 12v9"}),vt.jsx("path",{d:"m16 16-4-4-4 4"})]}),A1=()=>vt.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white",children:[vt.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),vt.jsx("path",{d:"M22 2 11 13"})]}),S1=({onSettingsClick:g})=>vt.jsxs("header",{className:"flex-shrink-0 h-14 bg-black/25 flex items-center px-6 justify-between border-b border-white/10 z-10",children:[vt.jsx("h1",{className:"text-lg font-semibold",children:"スライド作成ジェネレーター"}),vt.jsx("button",{onClick:g,className:"p-2 rounded-full hover:bg-white/10 transition-colors",children:vt.jsx(v1,{})})]}),w1=({isProcessing:g,processingStatus:t,fileName:i,handleDragOver:s,handleDrop:a,onFileSelect:o,appStatus:l})=>vt.jsx("div",{className:`w-1/3 bg-white/5 rounded-xl flex flex-col items-center justify-center p-6 border-2 border-dashed ${g?"border-indigo-500":"border-white/20 hover:border-indigo-500"} transition-colors`,onDragOver:s,onDrop:a,children:g?vt.jsxs("div",{className:"text-center",children:[vt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto"}),vt.jsx("p",{className:"mt-4 text-lg font-semibold",children:t}),vt.jsx("p",{className:"mt-1 text-sm text-gray-400",children:i})]}):l!=="initial"?vt.jsxs("div",{className:"text-center",children:[vt.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-green-400 mx-auto",children:[vt.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),vt.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),vt.jsx("p",{className:"mt-4 text-lg font-semibold",children:"処理進行中"}),vt.jsx("p",{className:"mt-1 text-sm text-gray-400",children:i}),vt.jsx("p",{className:"mt-4 text-xs text-gray-500",children:"コントロールパネルで操作を続けてください。"})]}):vt.jsxs("div",{className:"text-center",children:[vt.jsx(_1,{}),vt.jsx("p",{className:"mt-4 text-lg font-semibold",children:"ドキュメントをドラッグ＆ドロップ"}),vt.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"または"}),vt.jsx("button",{className:"mt-4 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-md text-sm font-medium transition-colors",onClick:()=>document.getElementById("file-upload").click(),children:"ファイルを選択"}),vt.jsx("input",{type:"file",id:"file-upload",className:"hidden",accept:".pdf,.txt,.md",onChange:u=>o(u.target.files[0])}),vt.jsx("p",{className:"mt-4 text-xs text-gray-500",children:"対応形式: PDF, TXT, MD"})]})}),E1=({messages:g,userInput:t,setUserInput:i,handleSendMessage:s,chatEndRef:a,appStatus:o,structuredMarkdown:l,setStructuredMarkdown:u,onApproval:h,onAgendaChoice:d,onStartGeneration:p,onPreview:m,onApproveAndNext:v,onDownloadZip:b})=>vt.jsxs("div",{className:"w-2/3 bg-white/5 rounded-xl flex flex-col border border-white/10 overflow-hidden",children:[vt.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-4",children:[g.map((A,_)=>vt.jsx("div",{className:`flex ${A.type==="user"?"justify-end":"justify-start"}`,children:vt.jsx("div",{className:`px-4 py-2 rounded-lg max-w-2xl ${A.type==="user"?"bg-indigo-600":"bg-gray-700"}`,children:vt.jsx("p",{className:"text-sm whitespace-pre-wrap",children:A.text})})},_)),o==="structured"&&vt.jsxs("div",{className:"bg-black/20 p-4 rounded-lg",children:[vt.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"以下に構造化されたテキスト案を表示します。内容を確認し、必要であれば直接編集してください。"}),vt.jsx("textarea",{value:l,onChange:A=>u(A.target.value),className:"w-full h-64 bg-gray-900/50 border border-white/20 rounded-md p-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-shadow font-mono"}),vt.jsx("div",{className:"flex justify-end mt-4",children:vt.jsx("button",{onClick:h,className:"px-6 py-2 bg-green-600 hover:bg-green-500 text-sm font-medium rounded-md transition-colors",children:"内容を承認して次へ進む"})})]}),o==="creating_outline"&&vt.jsxs("div",{className:"bg-black/20 p-4 rounded-lg flex justify-center items-center space-x-4",children:[vt.jsx("p",{className:"text-sm text-gray-300",children:"アジェンダページを挿入しますか？"}),vt.jsx("button",{onClick:()=>d(!0),className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-sm font-medium rounded-md transition-colors",children:"はい"}),vt.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-sm font-medium rounded-md transition-colors",children:"いいえ"})]}),o==="outline_created"&&vt.jsx("div",{className:"bg-black/20 p-4 rounded-lg flex justify-center",children:vt.jsx("button",{onClick:p,className:"px-6 py-2 bg-green-600 hover:bg-green-500 text-sm font-medium rounded-md transition-colors",children:"構成案を承認し、スライド生成を開始する"})}),o==="all_slides_generated"&&vt.jsx("div",{className:"bg-black/20 p-4 rounded-lg flex justify-center",children:vt.jsx("button",{onClick:b,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-sm font-medium rounded-md transition-colors",children:"ZIPファイルをダウンロード"})}),vt.jsx("div",{ref:a})]}),vt.jsxs("div",{className:"flex-shrink-0 p-4 border-t border-white/10 bg-black/20",children:[vt.jsxs("div",{className:"relative",children:[vt.jsx("input",{type:"text",value:t,onChange:A=>i(A.target.value),onKeyPress:A=>A.key==="Enter"&&s(),placeholder:"修正指示などを入力...",className:"w-full bg-gray-900/50 border border-white/20 rounded-lg py-3 pl-4 pr-14 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-shadow",disabled:o!=="slide_generated"}),vt.jsx("button",{onClick:s,className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 bg-indigo-600 hover:bg-indigo-500 rounded-full transition-colors disabled:opacity-50",disabled:o!=="slide_generated"||!t.trim(),children:vt.jsx(A1,{})})]}),vt.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[vt.jsx("button",{className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-sm font-medium rounded-md transition-colors disabled:opacity-50",disabled:o!=="slide_generated",onClick:m,children:"プレビュー"}),vt.jsx("button",{className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-sm font-medium rounded-md transition-colors disabled:opacity-50",disabled:o!=="slide_generated",onClick:v,children:"承認して次へ"})]})]})]}),C1=({isOpen:g,tempApiKey:t,setTempApiKey:i,handleSave:s,handleClose:a})=>g?vt.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:vt.jsxs("div",{className:"bg-[#2a2a2e] border border-white/10 rounded-lg shadow-xl p-8 w-full max-w-md",children:[vt.jsx("h2",{className:"text-xl font-bold mb-4",children:"Gemini APIキーを入力"}),vt.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Google AI StudioでAPIキーを取得し、以下に貼り付けてください。キーはあなたのブラウザのローカルストレージにのみ保存されます。"}),vt.jsx("input",{type:"password",value:t,onChange:o=>i(o.target.value),placeholder:"APIキーを入力...",className:"w-full bg-gray-900/50 border border-white/20 rounded-md p-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}),vt.jsx("div",{className:"flex justify-end mt-6",children:vt.jsx("button",{onClick:s,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-md font-medium transition-colors",children:"保存"})})]})}):null;function T1(){const[g,t]=De.useState(""),[i,s]=De.useState(!1),[a,o]=De.useState(""),[l,u]=De.useState("initial"),[h,d]=De.useState([]),[p,m]=De.useState(""),[v,b]=De.useState(""),[A,_]=De.useState(""),[w,S]=De.useState(""),[T,M]=De.useState([]),[k,O]=De.useState(!1),[z,L]=De.useState(""),[G,j]=De.useState(0),[Z,ot]=De.useState([]),[I,X]=De.useState(""),x=De.useRef(null);De.useEffect(()=>{const pt=localStorage.getItem("gemini_api_key");pt?(t(pt),d([{type:"system",text:"ようこそ！スライドの元になるドキュメントをアップロードしてください。"}])):(s(!0),d([{type:"system",text:"まず、Gemini APIキーを設定してください。"}]))},[]),De.useEffect(()=>{x.current?.scrollIntoView({behavior:"smooth"})},[h]);const tt=()=>{a&&(localStorage.setItem("gemini_api_key",a),t(a),s(!1),d([{type:"system",text:"APIキーが保存されました。スライドの元になるドキュメントをアップロードしてください。"}]))},U=pt=>pt.preventDefault(),H=pt=>{pt.preventDefault();const _t=pt.dataTransfer.files;_t.length>0&&ct(_t[0])},ct=async pt=>{if(!pt)return;if(!["application/pdf","text/plain","text/markdown"].includes(pt.type)){console.error("[ERROR] Step 1.1: Unsupported file format.",{type:pt.type}),d(Lt=>[...Lt,{type:"system",text:`サポートされていないファイル形式です: ${pt.type}
(PDF, TXT, MDのみ)`}]);return}console.log("[INFO] Step 1.1: File selected.",{name:pt.name,size:pt.size,type:pt.type}),b(pt.name),O(!0),L("ファイルのテキストを抽出中..."),d(Lt=>[...Lt,{type:"system",text:`${pt.name} をアップロードしました。`}]),console.log("[INFO] Step 1.2: Starting text extraction from file.");let Ut="";try{if(pt.type==="application/pdf"){const Lt=new FileReader;Lt.onload=async C=>{const rt=new Uint8Array(C.target.result),et=await n0({data:rt}).promise;let F="";for(let N=1;N<=et.numPages;N++){const dt=await(await et.getPage(N)).getTextContent();F+=dt.items.map(ft=>ft.str).join(" ")}Ut=F,st(Ut)},Lt.readAsArrayBuffer(pt)}else{const Lt=new FileReader;Lt.onload=C=>{Ut=C.target.result,st(Ut)},Lt.readAsText(pt)}}catch(Lt){console.error("[ERROR] Step 1.2: Failed to extract text.",Lt),d(C=>[...C,{type:"system",text:"テキストの抽出中にエラーが発生しました。"}]),O(!1),b("")}},st=pt=>{console.log("[INFO] Step 1.2: Text extraction completed.",{length:pt.length}),d(_t=>[..._t,{type:"system",text:`テキストの抽出が完了しました。（${pt.length}文字）
次に、内容を構造化します。`}]),_(pt),mt(pt)},mt=async pt=>{if(u("structuring"),O(!0),L("Gemini APIでテキストを構造化中..."),!g){d(_t=>[..._t,{type:"system",text:"APIキーが設定されていません。設定画面からAPIキーを入力してください。"}]),O(!1);return}try{const Ut=new ul(g).getGenerativeModel({model:"gemini-2.5-flash-lite"}),Lt=`### 指示
あなたは、与えられたテキストをクリーンアップし、論理構造を解析する専門家です。以下のテキストに含まれる、PDF抽出時に発生しがちな単語間の不自然なスペース（例：「ドキュメント」が「ドキュ メント」となっている箇所）を修正し、自然な文章にしてください。
その上で、内容を論理的に整理し、見出し、リスト、段落が明確に分かるMarkdown形式に再構成してください。元のテキストに含まれる重要な情報は一切省略しないでください。

### テキスト
${pt}`;console.log("[INFO] Step 1.3: Sending text to Gemini API for structuring."),console.debug("[DEBUG] Step 1.3: Prompt for structuring text:",Lt);const et=await(await(await Ut.generateContent(Lt)).response).text();console.log("[INFO] Step 1.3: Received structured markdown from API."),S(et),u("structured"),d(F=>[...F,{type:"system",text:"テキストの構造化が完了しました。"}])}catch(_t){console.error("[FATAL] API Error:",_t),d(Ut=>[...Ut,{type:"system",text:`APIエラーが発生しました: ${_t.message}`}])}finally{O(!1)}},D=()=>{console.log("[INFO] Step 1.5: User approved the structured markdown."),u("creating_outline"),d(pt=>[...pt,{type:"system",text:"内容が承認されました。スライドにアジェンダ（目次）ページを挿入しますか？"}])},B=async pt=>{if(console.log("[INFO] Step 1.7: User selection for agenda slide:",pt),d(_t=>[..._t,{type:"user",text:pt?"はい":"いいえ"}]),u("generating_outline"),O(!0),L("Gemini APIで構成案を生成中..."),!g){d(_t=>[..._t,{type:"system",text:"APIキーが設定されていません。"}]),O(!1);return}try{const Ut=new ul(g).getGenerativeModel({model:"gemini-2.5-flash-lite"}),rt=`### 指示
あなたはプロのプレゼンテーション構成作家です。以下のMarkdownテキストを分析し、プレゼンテーションの構成案を作成してください。構成案は、各スライドの「タイトル」と「そのスライドで説明する内容の要約」をJSONのリスト形式で出力してください。

### 条件
- 1枚目は必ず「タイトルページ」とします。タイトルはMarkdownの内容から最も適切と思われるものを設定してください。
${pt?"- 2枚目は「アジェンダ」ページとし、3枚目以降の内容の目次を生成してください。":""}
- 3枚目以降は、Markdownの論理構造に従って内容を分割し、各スライドのタイトルと要約を作成してください。
- 全体で8〜12枚程度のスライド構成になるように調整してください。

### 出力形式(JSON)
${pt?`[
  {"title": "(ここにタイトルページのタイトル)", "summary": "(ここにタイトルページの簡単な説明や発表者名など)"},
  {"title": "アジェンダ", "summary": "(3枚目以降のタイトルリスト)"},
  {"title": "(3枚目のタイトル)", "summary": "(3枚目の内容の要約)"}
]`:`[
  {"title": "(ここにタイトルページのタイトル)", "summary": "(ここにタイトルページの簡単な説明や発表者名など)"},
  {"title": "(2枚目のタイトル)", "summary": "(2枚目の内容の要約)"},
  {"title": "(3枚目のタイトル)", "summary": "(3枚目の内容の要約)"}
]`}

### Markdownテキスト
${w}`;console.log("[INFO] Step 1.8: Sending markdown to Gemini API for slide outline generation."),console.debug("[DEBUG] Step 1.8: Prompt for outline generation:",rt);let N=(await(await Ut.generateContent(rt)).response).text();N=N.replace(/^```json\s*|```\s*$/g,"");const V=JSON.parse(N);console.log("[INFO] Step 1.8: Received slide outline from API."),M(V),u("outline_created");const dt=`構成案が生成されました。

`+V.map((ft,W)=>`${W+1}. ${ft.title}`).join(`
`);d(ft=>[...ft,{type:"system",text:dt}])}catch(_t){console.error("[FATAL] API Error:",_t),d(Ut=>[...Ut,{type:"system",text:`構成案の生成中にAPIエラーが発生しました: ${_t.message}`}])}finally{O(!1)}},J=()=>{const pt=T[0];console.log(`[INFO] Step 2.1: Starting generation for slide 1: ${pt.title}`),u("generating_slides"),d(_t=>[..._t,{type:"system",text:`構成案が承認されました。

**ステップ2: スライド生成**
1枚目「${pt.title}」の生成を開始します。`}]),it(G)},it=async pt=>{O(!0);const _t=T[pt];if(L(`${pt+1}枚目のスライド「${_t.title}」を生成中...`),!g){d(C=>[...C,{type:"system",text:"APIキーが設定されていません。"}]),O(!1);return}const Lt=`### あなたの役割
あなたは、モダンで視覚的に分かりやすいプレゼンテーションスライドを作成するプロのデザイナー兼HTMLコーダーです。

### 指示
以下の情報に基づき、プレゼンテーションの**${pt+1}枚目**のスライドを**単一のHTMLファイル**として生成してください。

### 思考プロセス
1. 以下の「今回生成するスライドの情報」を深く理解します。
2. 内容を最も効果的に伝えるための視覚的なレイアウト（インフォグラフィック、図、グラフ、アイコンなどを含む）を考案します。
3. 考案したレイアウトを、以下の「HTML生成の厳格なルール」に従って、単一のHTMLファイルとしてコーディングします。

### プレゼンテーション全体の構成案
${JSON.stringify(T,null,2)}

### 今回生成するスライドの情報
- スライド番号: ${pt+1}
- スライドタイトル: ${_t.title}
- スライドの内容(要約): ${_t.summary}

### 視覚的表現のヒント
内容に応じて、インフォグラフィック、図、グラフ、アイコンなどを効果的に使用してください。

### HTML生成の厳格なルール
- **最重要:** 生成するコンテンツはHTMLコードのみです。解説や前置きは一切不要です。\`<!DOCTYPE html>\`から\`</html>\`までを出力してください。
- CSSは\`<style>\`タグ内に、JSは\`<script>\`タグ内に記述してください。ただし、**アニメーション、ページ遷移、ホバーエフェクトなどの動的要素は一切含めないでください。**
- スライドのサイズは厳密に幅1280px、高さ720pxとします。\`<body>\`タグに直接スタイルを適用するか、全体をラップする\`<div style="width: 1280px; height: 720px; overflow: hidden;">\`を作成してください。
- 全ての要素(テキスト、図、画像など)はこの1280×720pxの領域内に完全に収めてください。
- テキストは単語の途中で不自然に改行されないように、CSSの\`word-break: keep-all;\`や\`overflow-wrap: break-word;\`を適切に使用してください。
- 使用するフォントは、\`@import\`で読み込めるWebフォント（例: Google Fontsの'Inter'や'Noto Sans JP'）を指定してください。
- アイコンを使用する場合は、\`<svg>\`タグを直接HTMLに埋め込んでください。外部画像ファイル(\`<img>\`タグ)は使用しないでください。
`;try{const rt=new ul(g).getGenerativeModel({model:"gemini-2.5-pro"});console.log(`[INFO] Step 2.1: Starting generation for slide ${pt+1}: ${_t.title}`),console.debug("[DEBUG] Step 2.1: Prompt for HTML generation:",Lt);let N=(await(await rt.generateContent(Lt)).response).text();N=N.replace(/^```html\s*|```\s*$/g,"").trim(),console.log(`[INFO] Step 2.1: Received HTML for slide ${pt+1}.`),X(N),u("slide_generated"),d(V=>[...V,{type:"system",text:`スライド「${_t.title}」が生成されました。
プレビューで確認し、問題なければ承認して次のスライドに進んでください。`}])}catch(C){console.error("[FATAL] API Error:",C),d(rt=>[...rt,{type:"system",text:`スライド生成中にAPIエラーが発生しました: ${C.message}`}]),u("outline_created")}finally{O(!1)}},at=async pt=>{O(!0),L(`スライド ${G+1} を修正中...`),console.log(`[INFO] Step 2.2: User requested modification for slide ${G+1}.`),console.debug("[DEBUG] Step 2.2: User modification request:",pt);const _t=`### あなたの役割
あなたは、既存のHTMLコードをユーザーの指示に基づいて精密に修正するHTMLコーダーです。

### 指示
添付されたHTMLコードを、以下の「ユーザーからの修正指示」に基づいて修正してください。

### 厳格なルール
- **最重要:** 指示された箇所以外のデザイン、レイアウト、テキストは**絶対に、いかなる理由があっても変更しないでください。**
- 変更は最小限に留めてください。
- 出力は修正後の完全なHTMLコードのみとし、解説などは一切含めないでください。

### ユーザーからの修正指示
${pt}

### 修正対象のHTMLコード
\`\`\`html
${I}
\`\`\`
`;try{const Lt=new ul(g).getGenerativeModel({model:"gemini-2.5-flash-lite"});console.log("[INFO] Step 2.2: Sending request to Gemini API for HTML modification."),console.debug("[DEBUG] Step 2.2: Prompt for HTML modification:",_t);let et=(await(await Lt.generateContent(_t)).response).text();et=et.replace(/^```html\s*|```\s*$/g,"").trim(),console.log(`[INFO] Step 2.2: Received modified HTML for slide ${G+1}.`),X(et),d(F=>[...F,{type:"system",text:"スライドが修正されました。再度プレビューで確認してください。"}])}catch(Ut){console.error("[FATAL] API Error:",Ut),d(Lt=>[...Lt,{type:"system",text:`スライドの修正中にAPIエラーが発生しました: ${Ut.message}`}])}finally{O(!1)}},At=()=>{if(!I)return;const pt=new Blob([I],{type:"text/html"}),_t=URL.createObjectURL(pt);window.open(_t,"_blank")},St=()=>{console.log(`[INFO] Step 2.7: User approved slide ${G+1}. HTML saved.`),ot(_t=>[..._t,I]),X("");const pt=G+1;if(pt<T.length){j(pt);const _t=T[pt];d(Ut=>[...Ut,{type:"system",text:`スライド ${G} を承認しました。

次のスライド「${_t.title}」の生成を開始します。`}]),it(pt)}else u("all_slides_generated"),console.log("[INFO] Step 3: All slides validated and stored."),d(_t=>[..._t,{type:"system",text:`全てのステップが完了しました！

下のボタンから、生成された全スライドをZIPファイルとしてダウンロードできます。`}])},Mt=async()=>{console.log("[INFO] Step 4: Starting ZIP file generation."),O(!0),L("ZIPファイルを生成中...");try{const pt=new b1,_t=[...Z];l==="all_slides_generated"&&T.length-1,_t.forEach((C,rt)=>{pt.file(`s${rt+1}.html`,C)});const Ut=await pt.generateAsync({type:"blob"}),Lt=document.createElement("a");Lt.href=URL.createObjectURL(Ut),Lt.download="slides.zip",document.body.appendChild(Lt),Lt.click(),document.body.removeChild(Lt),URL.revokeObjectURL(Lt.href),console.log("[INFO] Step 4: slides.zip has been successfully created and downloaded.")}catch(pt){console.error("[ERROR] Step 4: Failed to generate ZIP file.",pt),d(_t=>[..._t,{type:"system",text:`ZIPファイルの生成中にエラーが発生しました: ${pt.message}`}])}finally{O(!1)}},xt=()=>{!p.trim()||l!=="slide_generated"||(d(pt=>[...pt,{type:"user",text:p}]),at(p),m(""))};return vt.jsxs("div",{className:"bg-[#1e1e1e] h-screen w-screen flex flex-col font-sans text-white",children:[vt.jsx(S1,{onSettingsClick:()=>s(!0)}),vt.jsxs("main",{className:"flex-grow flex p-6 gap-6 overflow-hidden",children:[vt.jsx(w1,{isProcessing:k,processingStatus:z,fileName:v,handleDragOver:U,handleDrop:H,onFileSelect:ct,appStatus:l}),vt.jsx(E1,{messages:h,userInput:p,setUserInput:m,handleSendMessage:xt,chatEndRef:x,appStatus:l,structuredMarkdown:w,setStructuredMarkdown:S,onApproval:D,onAgendaChoice:B,onStartGeneration:J,onPreview:At,onApproveAndNext:St,onDownloadZip:Mt})]}),vt.jsx(C1,{isOpen:i,tempApiKey:a,setTempApiKey:o,handleSave:tt,handleClose:()=>s(!1)})]})}jb.createRoot(document.getElementById("root")).render(vt.jsx(De.StrictMode,{children:vt.jsx(T1,{})}));
